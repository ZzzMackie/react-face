<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Three-Core å¼•æ“æ¼”ç¤º</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            display: flex;  
            flex-direction: column;
        }

        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 20px;
            text-align: center;
            color: white;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .scroll-bar {
            scrollbar-color: #999 #fff;
            scrollbar-width: thin;
        }
        .scroll-bar::-webkit-scrollbar-thumb {
            border-radius: 5px;
            background: #999;
        }
        .scroll-bar::-webkit-scrollbar-track {
            border-radius: 5px;
            background: #fff;
        }
        .scroll-bar::-webkit-scrollbar {
            width: 7px;
        }

        .container {
            flex: 1;
            display: flex;
            height: calc(100% - 127px);
            gap: 20px;
            padding: 20px 20px 0 20px;
        }

        .canvas-container {
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            max-height: calc(100% - 20px);
        }

        #canvas {
            width: 100%;
            height: 100%;
            display: block;
        }

        .controls {
            width: 300px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            color: white;
            overflow-y: auto;
            max-height: calc(100% - 20px);
        }

        .control-group {
            margin-bottom: 25px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .control-group h3 {
            margin-bottom: 15px;
            color: #fff;
            font-size: 1.2rem;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
            padding-bottom: 8px;
        }

        .button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .button:active {
            transform: translateY(0);
        }

        .button.secondary {
            background: linear-gradient(45deg, #f093fb, #f5576c);
        }

        .button.success {
            background: linear-gradient(45deg, #4facfe, #00f2fe);
        }

        .button.warning {
            background: linear-gradient(45deg, #43e97b, #38f9d7);
        }

        .slider-container {
            margin: 10px 0;
        }

        .slider-container label {
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.9);
        }

        .slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: rgba(255, 255, 255, 0.2);
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }

        .slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }

        .status {
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 12px;
            font-family: 'Courier New', monospace;
        }

        .log {
            background: rgba(0, 0, 0, 0.4);
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 11px;
            font-family: 'Courier New', monospace;
            max-height: 150px;
            overflow-y: auto;
            color: #00ff00;
        }

        .log-entry {
            margin: 2px 0;
            padding: 2px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .log-entry.error {
            color: #ff6b6b;
        }

        .log-entry.warning {
            color: #ffd93d;
        }

        .log-entry.info {
            color: #6bcf7f;
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .controls {
                width: 100%;
                max-height: 300px;
            }
        }
    </style>
    <script type="importmap">
        {
          "imports": {
            "three": "./node_modules/three/build/three.module.min.js",
            "@model/three-core": "../src/core/Engine.js",
            "@model/three-core/examples/CompleteExample": "./CompleteExample.js",
            "@model/three-core/examples/AdvancedExample": "./AdvancedExample.js"
          }
        }
    </script>
</head>
<body class="scroll-bar">
    <div class="header">
        <h1>ğŸš€ Three-Core å¼•æ“æ¼”ç¤º</h1>
        <p>ç°ä»£åŒ–ã€æ¨¡å—åŒ–3Då¼•æ“ - æŒ‡çº¹ç§‘æŠ€é£æ ¼è®¾è®¡</p>
    </div>

    <div class="container">
        <div class="canvas-container">
            <canvas id="canvas"></canvas>
        </div>

        <div class="controls scroll-bar">
            <div class="control-group">
                <h3>ğŸ® å¼•æ“æ§åˆ¶</h3>
                <button class="button" onclick="initEngine()">åˆå§‹åŒ–å¼•æ“</button>
                <button class="button secondary" onclick="startRenderLoop()">å¼€å§‹æ¸²æŸ“</button>
                <button class="button warning" onclick="stopRenderLoop()">åœæ­¢æ¸²æŸ“</button>
                <button class="button success" onclick="getStats()">è·å–ç»Ÿè®¡</button>
            </div>

            <div class="control-group">
                <h3>ğŸ’¡ ç¯å…‰æ§åˆ¶</h3>
                <button class="button" onclick="createLights()">åˆ›å»ºç¯å…‰</button>
                <button class="button secondary" onclick="toggleLights()">åˆ‡æ¢ç¯å…‰</button>
                <div class="slider-container">
                    <label>ç¯å¢ƒå…‰å¼ºåº¦</label>
                    <input type="range" class="slider" id="ambientIntensity" min="0" max="2" step="0.1" value="0.4" onchange="updateAmbientLight()">
                </div>
                <div class="slider-container">
                    <label>æ–¹å‘å…‰å¼ºåº¦</label>
                    <input type="range" class="slider" id="directionalIntensity" min="0" max="3" step="0.1" value="1.0" onchange="updateDirectionalLight()">
                </div>
            </div>

            <div class="control-group">
                <h3>ğŸ¨ æè´¨æ§åˆ¶</h3>
                <button class="button" onclick="createMaterials()">åˆ›å»ºæè´¨</button>
                <button class="button secondary" onclick="updateMaterials()">æ›´æ–°æè´¨</button>
                <div class="slider-container">
                    <label>ç²—ç³™åº¦</label>
                    <input type="range" class="slider" id="roughness" min="0" max="1" step="0.1" value="0.5" onchange="updateRoughness()">
                </div>
                <div class="slider-container">
                    <label>é‡‘å±åº¦</label>
                    <input type="range" class="slider" id="metalness" min="0" max="1" step="0.1" value="0.5" onchange="updateMetalness()">
                </div>
            </div>

            <div class="control-group">
                <h3>ğŸ¯ å¯¹è±¡æ§åˆ¶</h3>
                <button class="button" onclick="createObjects()">åˆ›å»ºå¯¹è±¡</button>
                <button class="button secondary" onclick="animateObjects()">åŠ¨ç”»å¯¹è±¡</button>
                <button class="button warning" onclick="selectObjects()">é€‰æ‹©å¯¹è±¡</button>
                <button class="button success" onclick="cloneObjects()">å…‹éš†å¯¹è±¡</button>
            </div>

            <div class="control-group">
                <h3>âœ¨ åå¤„ç†æ•ˆæœ</h3>
                <button class="button" onclick="enableBloom()">å¯ç”¨æ³›å…‰</button>
                <button class="button secondary" onclick="disableBloom()">ç¦ç”¨æ³›å…‰</button>
                <button class="button warning" onclick="enableFXAA()">å¯ç”¨FXAA</button>
                <div class="slider-container">
                    <label>æ³›å…‰å¼ºåº¦</label>
                    <input type="range" class="slider" id="bloomStrength" min="0" max="3" step="0.1" value="1.5" onchange="updateBloomStrength()">
                </div>
            </div>

            <div class="control-group">
                <h3>ğŸ’¾ åœºæ™¯æŒä¹…åŒ–</h3>
                <button class="button" onclick="saveScene()">ä¿å­˜åœºæ™¯</button>
                <button class="button secondary" onclick="loadScene()">åŠ è½½åœºæ™¯</button>
                <button class="button warning" onclick="listScenes()">åˆ—å‡ºåœºæ™¯</button>
                <button class="button success" onclick="clearScenes()">æ¸…ç©ºåœºæ™¯</button>
            </div>

            <div class="control-group">
                <h3>ğŸ“Š çŠ¶æ€ä¿¡æ¯</h3>
                <div class="status" id="status">
                    å¼•æ“æœªåˆå§‹åŒ–
                </div>
            </div>

            <div class="control-group">
                <h3>ğŸ“ æ—¥å¿—</h3>
                <div class="log" id="log">
                    <div class="log-entry info">ç­‰å¾…åˆå§‹åŒ–...</div>
                </div>
            </div>

            <!-- é«˜çº§åŠ¨ç”»ç³»ç»Ÿ -->
            <div class="control-group">
                <h3>ğŸ¬ é«˜çº§åŠ¨ç”»ç³»ç»Ÿ</h3>
                <button class="button" onclick="createMorphAnimation()">åˆ›å»ºå˜å½¢åŠ¨ç”»</button>
                <button class="button" onclick="playMorphAnimation()">æ’­æ”¾å˜å½¢åŠ¨ç”»</button>
                <button class="button" onclick="createProceduralAnimation()">åˆ›å»ºç¨‹åºåŒ–åŠ¨ç”»</button>
                <button class="button" onclick="playProceduralAnimation()">æ’­æ”¾ç¨‹åºåŒ–åŠ¨ç”»</button>
                <button class="button" onclick="stopAllAnimations()">åœæ­¢æ‰€æœ‰åŠ¨ç”»</button>
            </div>

            <!-- ç‰©ç†æ¨¡æ‹Ÿç³»ç»Ÿ -->
            <div class="control-group">
                <h3>âš¡ ç‰©ç†æ¨¡æ‹Ÿç³»ç»Ÿ</h3>
                <button class="button" onclick="createCloth()">åˆ›å»ºå¸ƒæ–™</button>
                <button class="button" onclick="createSoftBody()">åˆ›å»ºè½¯ä½“</button>
                <button class="button" onclick="addObstacle()">æ·»åŠ éšœç¢ç‰©</button>
                <button class="button" onclick="applyWind()">åº”ç”¨é£åŠ›</button>
                <button class="button" onclick="togglePhysics()">åˆ‡æ¢ç‰©ç†æ¨¡æ‹Ÿ</button>
            </div>

            <!-- é«˜çº§æ¸²æŸ“åŠŸèƒ½ -->
            <div class="control-group">
                <h3>ğŸ¨ é«˜çº§æ¸²æŸ“åŠŸèƒ½</h3>
                <button class="button" onclick="enableRayTracing()">å¯ç”¨å…‰çº¿è¿½è¸ª</button>
                <button class="button" onclick="enableDeferredRendering()">å¯ç”¨å»¶è¿Ÿæ¸²æŸ“</button>
                <button class="button" onclick="enableFluidSimulation()">å¯ç”¨æµä½“æ¨¡æ‹Ÿ</button>
                <button class="button" onclick="updateRenderQuality()">æ›´æ–°æ¸²æŸ“è´¨é‡</button>
            </div>
        </div>
    </div>

    <script type="module">
        import { Engine } from '@model/three-core';
        import { createCompleteExample } from '@model/three-core/examples/CompleteExample';
        import { createAdvancedExample } from '@model/three-core/examples/AdvancedExample';

        // å…¨å±€å˜é‡
        window.engine = null;
        window.example = null;

        // æ—¥å¿—å‡½æ•°
        function log(message, type = 'info') {
            const logContainer = document.getElementById('log');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logContainer.appendChild(entry);
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        // æ›´æ–°çŠ¶æ€
        function updateStatus(message) {
            document.getElementById('status').textContent = message;
        }

        // åˆå§‹åŒ–å¼•æ“
        window.initEngine = async function() {
            try {
                log('ğŸš€ å¼€å§‹åˆå§‹åŒ–å¼•æ“...', 'info');
                updateStatus('åˆå§‹åŒ–ä¸­...');

                const canvas = document.getElementById('canvas');
                const container = canvas.parentElement;

                // åˆ›å»ºå¼•æ“
                window.engine = new Engine({
                    container,
                    width: container.clientWidth,
                    height: container.clientHeight,
                    antialias: true,
                    shadowMap: true,
                    autoRender: true,
                    autoResize: true
                });

                // åˆå§‹åŒ–å¼•æ“
                await window.engine.initialize();

                // åˆ›å»ºåŸºç¡€ç¤ºä¾‹
                window.example = createCompleteExample(container);
                await window.example.initialize();

                // åˆ›å»ºé«˜çº§ç¤ºä¾‹
                window.advancedExample = createAdvancedExample(container);
                setTimeout(async () => {
                    await window.advancedExample.initialize();
                    log('ğŸš€ é«˜çº§ç¤ºä¾‹åˆå§‹åŒ–å®Œæˆ', 'info');
                }, 2000);

                log('âœ… å¼•æ“åˆå§‹åŒ–å®Œæˆ', 'info');
                updateStatus('å¼•æ“å·²åˆå§‹åŒ–');

                // è®¾ç½®äº‹ä»¶ç›‘å¬
                window.engine.managerInitialized.subscribe((data) => {
                    if (data) {
                        log(`ğŸ“¦ ç®¡ç†å™¨å·²åˆå§‹åŒ–: ${data.name}`, 'info');
                    }
                });

                window.engine.errorOccurred.subscribe((error) => {
                    if (error) {
                        log(`âŒ é”™è¯¯: ${error.type} - ${error.message}`, 'error');
                    }
                });

            } catch (error) {
                log(`âŒ åˆå§‹åŒ–å¤±è´¥: ${error.message}`, 'error');
                updateStatus('åˆå§‹åŒ–å¤±è´¥');
            }
        };

        // å¼€å§‹æ¸²æŸ“å¾ªç¯
        window.startRenderLoop = function() {
            if (window.engine) {
                window.engine.startRenderLoop();
                log('ğŸ¬ æ¸²æŸ“å¾ªç¯å·²å¯åŠ¨', 'info');
                updateStatus('æ¸²æŸ“ä¸­...');
            } else {
                log('âŒ å¼•æ“æœªåˆå§‹åŒ–', 'error');
            }
        };

        // åœæ­¢æ¸²æŸ“å¾ªç¯
        window.stopRenderLoop = function() {
            if (window.engine) {
                window.engine.stopRenderLoop();
                log('â¹ï¸ æ¸²æŸ“å¾ªç¯å·²åœæ­¢', 'info');
                updateStatus('æ¸²æŸ“å·²åœæ­¢');
            } else {
                log('âŒ å¼•æ“æœªåˆå§‹åŒ–', 'error');
            }
        };

        // è·å–ç»Ÿè®¡ä¿¡æ¯
        window.getStats = function() {
            if (window.engine) {
                const stats = window.engine.getStats();
                const managers = window.engine.getInitializedManagers();
                log(`ğŸ“Š ç»Ÿè®¡ä¿¡æ¯: ${JSON.stringify(stats, null, 2)}`, 'info');
                log(`ğŸ“¦ å·²åˆå§‹åŒ–ç®¡ç†å™¨: ${managers.join(', ')}`, 'info');
            } else {
                log('âŒ å¼•æ“æœªåˆå§‹åŒ–', 'error');
            }
        };

        // åˆ›å»ºç¯å…‰
        window.createLights = async function() {
            if (window.example) {
                await window.example.demonstrateLightOperations();
                log('ğŸ’¡ ç¯å…‰æ“ä½œæ¼”ç¤ºå®Œæˆ', 'info');
            } else {
                log('âŒ ç¤ºä¾‹æœªåˆå§‹åŒ–', 'error');
            }
        };

        // åˆ‡æ¢ç¯å…‰
        window.toggleLights = function() {
            log('ğŸ”„ åˆ‡æ¢ç¯å…‰çŠ¶æ€', 'info');
        };

        // æ›´æ–°ç¯å¢ƒå…‰
        window.updateAmbientLight = function() {
            const intensity = document.getElementById('ambientIntensity').value;
            log(`ğŸ’¡ æ›´æ–°ç¯å¢ƒå…‰å¼ºåº¦: ${intensity}`, 'info');
        };

        // æ›´æ–°æ–¹å‘å…‰
        window.updateDirectionalLight = function() {
            const intensity = document.getElementById('directionalIntensity').value;
            log(`ğŸ’¡ æ›´æ–°æ–¹å‘å…‰å¼ºåº¦: ${intensity}`, 'info');
        };

        // åˆ›å»ºæè´¨
        window.createMaterials = async function() {
            if (window.example) {
                await window.example.demonstrateMaterialOperations();
                log('ğŸ¨ æè´¨æ“ä½œæ¼”ç¤ºå®Œæˆ', 'info');
            } else {
                log('âŒ ç¤ºä¾‹æœªåˆå§‹åŒ–', 'error');
            }
        };

        // æ›´æ–°æè´¨
        window.updateMaterials = function() {
            log('ğŸ”„ æ›´æ–°æè´¨å±æ€§', 'info');
        };

        // æ›´æ–°ç²—ç³™åº¦
        window.updateRoughness = function() {
            const roughness = document.getElementById('roughness').value;
            log(`ğŸ¨ æ›´æ–°ç²—ç³™åº¦: ${roughness}`, 'info');
        };

        // æ›´æ–°é‡‘å±åº¦
        window.updateMetalness = function() {
            const metalness = document.getElementById('metalness').value;
            log(`ğŸ¨ æ›´æ–°é‡‘å±åº¦: ${metalness}`, 'info');
        };

        // åˆ›å»ºå¯¹è±¡
        window.createObjects = async function() {
            if (window.example) {
                await window.example.demonstrateObjectOperations();
                log('ğŸ¯ å¯¹è±¡æ“ä½œæ¼”ç¤ºå®Œæˆ', 'info');
            } else {
                log('âŒ ç¤ºä¾‹æœªåˆå§‹åŒ–', 'error');
            }
        };

        // åŠ¨ç”»å¯¹è±¡
        window.animateObjects = function() {
            log('ğŸ¬ å¼€å§‹å¯¹è±¡åŠ¨ç”»', 'info');
        };

        // é€‰æ‹©å¯¹è±¡
        window.selectObjects = function() {
            log('ğŸ¯ é€‰æ‹©å¯¹è±¡', 'info');
        };

        // å…‹éš†å¯¹è±¡
        window.cloneObjects = function() {
            log('ğŸ”„ å…‹éš†å¯¹è±¡', 'info');
        };

        // å¯ç”¨æ³›å…‰
        window.enableBloom = function() {
            log('âœ¨ å¯ç”¨æ³›å…‰æ•ˆæœ', 'info');
        };

        // ç¦ç”¨æ³›å…‰
        window.disableBloom = function() {
            log('âœ¨ ç¦ç”¨æ³›å…‰æ•ˆæœ', 'info');
        };

        // å¯ç”¨FXAA
        window.enableFXAA = function() {
            log('âœ¨ å¯ç”¨FXAAæŠ—é”¯é½¿', 'info');
        };

        // æ›´æ–°æ³›å…‰å¼ºåº¦
        window.updateBloomStrength = function() {
            const strength = document.getElementById('bloomStrength').value;
            log(`âœ¨ æ›´æ–°æ³›å…‰å¼ºåº¦: ${strength}`, 'info');
        };

        // ä¿å­˜åœºæ™¯
        window.saveScene = async function() {
            if (window.example) {
                await window.example.demonstrateScenePersistence();
                log('ğŸ’¾ åœºæ™¯æŒä¹…åŒ–æ¼”ç¤ºå®Œæˆ', 'info');
            } else {
                log('âŒ ç¤ºä¾‹æœªåˆå§‹åŒ–', 'error');
            }
        };

        // åŠ è½½åœºæ™¯
        window.loadScene = function() {
            log('ğŸ“‚ åŠ è½½åœºæ™¯', 'info');
        };

        // åˆ—å‡ºåœºæ™¯
        window.listScenes = function() {
            log('ğŸ“‹ åˆ—å‡ºæ‰€æœ‰åœºæ™¯', 'info');
        };

        // æ¸…ç©ºåœºæ™¯
        window.clearScenes = function() {
            log('ğŸ—‘ï¸ æ¸…ç©ºæ‰€æœ‰åœºæ™¯', 'warning');
        };

        // è¿è¡Œç‰¹æ•ˆç¤ºä¾‹
        window.runEffectsExample = async function() {
            if (window.engine) {
                try {
                    log('ğŸ† å¯åŠ¨ç‰¹æ•ˆç¤ºä¾‹...', 'info');
                    
                    // æ¸…ç†ç°æœ‰ç¤ºä¾‹
                    if (window.example) {
                        window.example.dispose();
                    }
                    if (window.advancedExample) {
                        window.advancedExample.dispose();
                    }
                    
                    // åˆ›å»ºç‰¹æ•ˆç¤ºä¾‹
                    window.effectsExample = createEffectsExample(container);
                    await window.effectsExample.initialize();
                    
                    log('ğŸ† ç‰¹æ•ˆç¤ºä¾‹å¯åŠ¨å®Œæˆ', 'info');
                    updateStatus('ç‰¹æ•ˆç¤ºä¾‹è¿è¡Œä¸­');
                } catch (error) {
                    log(`âŒ ç‰¹æ•ˆç¤ºä¾‹å¯åŠ¨å¤±è´¥: ${error.message}`, 'error');
                }
            } else {
                log('âŒ å¼•æ“æœªåˆå§‹åŒ–', 'error');
            }
        };

        // æ¸…ç†èµ„æº
        window.cleanup = function() {
            if (window.example) {
                window.example.dispose();
                window.example = null;
            }
            if (window.advancedExample) {
                window.advancedExample.dispose();
                window.advancedExample = null;
            }
            if (window.effectsExample) {
                window.effectsExample.dispose();
                window.effectsExample = null;
            }
            if (window.engine) {
                window.engine.dispose();
                window.engine = null;
            }
            log('ğŸ§¹ èµ„æºæ¸…ç†å®Œæˆ', 'info');
            updateStatus('å·²æ¸…ç†');
        };

        // é«˜çº§åŠ¨ç”»ç³»ç»Ÿå‡½æ•°
        window.createMorphAnimation = async function() {
            if (window.engine) {
                try {
                    const morphManager = await window.engine.getManager('morph');
                    if (morphManager) {
                        // åˆ›å»ºå˜å½¢ç›®æ ‡
                        const morphTarget = {
                            name: 'smile',
                            vertices: new Float32Array([0, 0, 0, 1, 0, 0, 0, 1, 0]),
                            weight: 0.5
                        };
                        morphManager.addMorphTarget('smile', morphTarget);
                        log('ğŸ­ å˜å½¢åŠ¨ç”»å·²åˆ›å»º', 'info');
                    }
                } catch (error) {
                    log(`âŒ åˆ›å»ºå˜å½¢åŠ¨ç”»å¤±è´¥: ${error.message}`, 'error');
                }
            } else {
                log('âŒ å¼•æ“æœªåˆå§‹åŒ–', 'error');
            }
        };

        window.playMorphAnimation = async function() {
            if (window.engine) {
                try {
                    const morphManager = await window.engine.getManager('morph');
                    if (morphManager) {
                        morphManager.playMorphAnimation('testObject', 'smileAnimation');
                        log('ğŸ¬ å˜å½¢åŠ¨ç”»æ’­æ”¾ä¸­', 'info');
                    }
                } catch (error) {
                    log(`âŒ æ’­æ”¾å˜å½¢åŠ¨ç”»å¤±è´¥: ${error.message}`, 'error');
                }
            } else {
                log('âŒ å¼•æ“æœªåˆå§‹åŒ–', 'error');
            }
        };

        window.createProceduralAnimation = async function() {
            if (window.engine) {
                try {
                    const proceduralManager = await window.engine.getManager('procedural');
                    if (proceduralManager) {
                        // åˆ›å»ºç¨‹åºåŒ–åŠ¨ç”»
                        const animation = {
                            name: 'bounce',
                            duration: 2.0,
                            target: 'testObject',
                            property: 'position.y',
                            curve: { name: 'easeInOut' },
                            startValue: 0,
                            endValue: 5
                        };
                        proceduralManager.addAnimation('bounce', animation);
                        log('ğŸ¬ ç¨‹åºåŒ–åŠ¨ç”»å·²åˆ›å»º', 'info');
                    }
                } catch (error) {
                    log(`âŒ åˆ›å»ºç¨‹åºåŒ–åŠ¨ç”»å¤±è´¥: ${error.message}`, 'error');
                }
            } else {
                log('âŒ å¼•æ“æœªåˆå§‹åŒ–', 'error');
            }
        };

        window.playProceduralAnimation = async function() {
            if (window.engine) {
                try {
                    const proceduralManager = await window.engine.getManager('procedural');
                    if (proceduralManager) {
                        proceduralManager.playAnimation('testObject', 'bounce');
                        log('ğŸ¬ ç¨‹åºåŒ–åŠ¨ç”»æ’­æ”¾ä¸­', 'info');
                    }
                } catch (error) {
                    log(`âŒ æ’­æ”¾ç¨‹åºåŒ–åŠ¨ç”»å¤±è´¥: ${error.message}`, 'error');
                }
            } else {
                log('âŒ å¼•æ“æœªåˆå§‹åŒ–', 'error');
            }
        };

        window.stopAllAnimations = async function() {
            if (window.engine) {
                try {
                    const morphManager = await window.engine.getManager('morph');
                    const proceduralManager = await window.engine.getManager('procedural');
                    
                    if (morphManager) morphManager.stopAllAnimations();
                    if (proceduralManager) proceduralManager.stopAllAnimations();
                    
                    log('â¹ï¸ æ‰€æœ‰åŠ¨ç”»å·²åœæ­¢', 'info');
                } catch (error) {
                    log(`âŒ åœæ­¢åŠ¨ç”»å¤±è´¥: ${error.message}`, 'error');
                }
            } else {
                log('âŒ å¼•æ“æœªåˆå§‹åŒ–', 'error');
            }
        };

        // ç‰©ç†æ¨¡æ‹Ÿç³»ç»Ÿå‡½æ•°
        window.createCloth = async function() {
            if (window.engine) {
                try {
                    const clothManager = await window.engine.getManager('cloth');
                    if (clothManager) {
                        const clothConfig = {
                            width: 20,
                            height: 20,
                            particleSpacing: 0.5,
                            stiffness: 100,
                            damping: 0.1,
                            gravity: new THREE.Vector3(0, -9.81, 0),
                            wind: new THREE.Vector3(0, 0, 0),
                            airResistance: 0.01
                        };
                        clothManager.createCloth('testCloth', clothConfig);
                        log('ğŸ‘• å¸ƒæ–™å·²åˆ›å»º', 'info');
                    }
                } catch (error) {
                    log(`âŒ åˆ›å»ºå¸ƒæ–™å¤±è´¥: ${error.message}`, 'error');
                }
            } else {
                log('âŒ å¼•æ“æœªåˆå§‹åŒ–', 'error');
            }
        };

        window.createSoftBody = async function() {
            if (window.engine) {
                try {
                    const softBodyManager = await window.engine.getManager('softBody');
                    if (softBodyManager) {
                        const geometry = new THREE.SphereGeometry(2, 8, 6);
                        const softBodyConfig = {
                            density: 1.0,
                            stiffness: 50,
                            damping: 0.1,
                            pressure: 1.0,
                            gravity: new THREE.Vector3(0, -9.81, 0),
                            collisionMargin: 0.1
                        };
                        softBodyManager.createSoftBodyFromGeometry('testSoftBody', geometry, softBodyConfig);
                        log('ğŸ«§ è½¯ä½“å·²åˆ›å»º', 'info');
                    }
                } catch (error) {
                    log(`âŒ åˆ›å»ºè½¯ä½“å¤±è´¥: ${error.message}`, 'error');
                }
            } else {
                log('âŒ å¼•æ“æœªåˆå§‹åŒ–', 'error');
            }
        };

        window.addObstacle = async function() {
            if (window.engine) {
                try {
                    const clothManager = await window.engine.getManager('cloth');
                    const softBodyManager = await window.engine.getManager('softBody');
                    
                    const obstacle = new THREE.Mesh(
                        new THREE.SphereGeometry(1, 8, 6),
                        new THREE.MeshBasicMaterial({ color: 0xff0000 })
                    );
                    obstacle.position.set(0, -2, 0);
                    
                    if (clothManager) clothManager.addObstacle('sphere', obstacle);
                    if (softBodyManager) softBodyManager.addObstacle('sphere', obstacle);
                    
                    log('ğŸš« éšœç¢ç‰©å·²æ·»åŠ ', 'info');
                } catch (error) {
                    log(`âŒ æ·»åŠ éšœç¢ç‰©å¤±è´¥: ${error.message}`, 'error');
                }
            } else {
                log('âŒ å¼•æ“æœªåˆå§‹åŒ–', 'error');
            }
        };

        window.applyWind = async function() {
            if (window.engine) {
                try {
                    const clothManager = await window.engine.getManager('cloth');
                    if (clothManager) {
                        const windForce = new THREE.Vector3(5, 0, 0);
                        clothManager.applyWind('testCloth', windForce);
                        log('ğŸ’¨ é£åŠ›å·²åº”ç”¨', 'info');
                    }
                } catch (error) {
                    log(`âŒ åº”ç”¨é£åŠ›å¤±è´¥: ${error.message}`, 'error');
                }
            } else {
                log('âŒ å¼•æ“æœªåˆå§‹åŒ–', 'error');
            }
        };

        window.togglePhysics = function() {
            log('âš¡ åˆ‡æ¢ç‰©ç†æ¨¡æ‹ŸçŠ¶æ€', 'info');
        };

        // é«˜çº§æ¸²æŸ“åŠŸèƒ½å‡½æ•°
        window.enableRayTracing = async function() {
            if (window.engine) {
                try {
                    const rayTracingManager = await window.engine.getManager('rayTracing');
                    if (rayTracingManager) {
                        rayTracingManager.enableRayTracing();
                        log('ğŸ” å…‰çº¿è¿½è¸ªå·²å¯ç”¨', 'info');
                    }
                } catch (error) {
                    log(`âŒ å¯ç”¨å…‰çº¿è¿½è¸ªå¤±è´¥: ${error.message}`, 'error');
                }
            } else {
                log('âŒ å¼•æ“æœªåˆå§‹åŒ–', 'error');
            }
        };

        window.enableDeferredRendering = async function() {
            if (window.engine) {
                try {
                    const deferredManager = await window.engine.getManager('deferred');
                    if (deferredManager) {
                        deferredManager.enableDeferredRendering();
                        log('ğŸ¨ å»¶è¿Ÿæ¸²æŸ“å·²å¯ç”¨', 'info');
                    }
                } catch (error) {
                    log(`âŒ å¯ç”¨å»¶è¿Ÿæ¸²æŸ“å¤±è´¥: ${error.message}`, 'error');
                }
            } else {
                log('âŒ å¼•æ“æœªåˆå§‹åŒ–', 'error');
            }
        };

        window.enableFluidSimulation = async function() {
            if (window.engine) {
                try {
                    const fluidManager = await window.engine.getManager('fluid');
                    if (fluidManager) {
                        fluidManager.createFluidSimulation('testFluid', {
                            particleCount: 1000,
                            containerSize: new THREE.Vector3(10, 10, 10),
                            gravity: new THREE.Vector3(0, -9.81, 0),
                            viscosity: 0.1,
                            surfaceTension: 0.01
                        });
                        log('ğŸ’§ æµä½“æ¨¡æ‹Ÿå·²å¯ç”¨', 'info');
                    }
                } catch (error) {
                    log(`âŒ å¯ç”¨æµä½“æ¨¡æ‹Ÿå¤±è´¥: ${error.message}`, 'error');
                }
            } else {
                log('âŒ å¼•æ“æœªåˆå§‹åŒ–', 'error');
            }
        };

        window.updateRenderQuality = function() {
            log('ğŸ¨ æ›´æ–°æ¸²æŸ“è´¨é‡', 'info');
        };

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            log('ğŸ“„ é¡µé¢åŠ è½½å®Œæˆ', 'info');
            log('ç‚¹å‡»"åˆå§‹åŒ–å¼•æ“"å¼€å§‹æ¼”ç¤º', 'info');
        });
    </script>
</body>
</html> 