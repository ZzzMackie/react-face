{
  "version": 3,
  "sources": ["../src/index.ts", "../src/components/core/ThreeCanvas.vue", "../src/components/core/ThreeScene.vue", "../src/components/core/ThreeCamera.vue", "../src/components/core/ThreeMesh.vue", "../src/components/core/ThreeObject.vue", "../src/components/core/ThreeResourceManager.vue", "../src/components/core/ThreeWebGPURenderer.vue", "../src/components/physics/ThreePhysicsWorld.vue", "../src/components/physics/ThreeRigidBody.vue", "../src/components/physics/ThreeBoxCollider.vue", "../src/components/physics/ThreeSphereCollider.vue", "../src/components/physics/ThreeConstraint.vue", "../src/components/postprocessing/ThreePostProcessing.vue", "../src/components/postprocessing/ThreeBloomEffect.vue", "../src/components/postprocessing/ThreeFXAAEffect.vue", "../src/components/postprocessing/ThreeDepthOfFieldEffect.vue", "../src/components/debug/ThreeStats.vue", "../src/components/interaction/ThreeRaycaster.vue", "../src/components/interaction/ThreeInteractive.vue", "../src/utils/index.ts", "../src/composables/useThree.ts", "../src/constants.ts", "../src/composables/useFrame.ts", "../src/plugin.ts"],
  "sourcesContent": ["// \u6838\u5FC3\u7EC4\u4EF6\nexport * from './components/core/ThreeCanvas.vue';\nexport * from './components/core/ThreeScene.vue';\nexport * from './components/core/ThreeCamera.vue';\nexport * from './components/core/ThreeMesh.vue';\nexport * from './components/core/ThreeObject.vue';\nexport * from './components/core/ThreeResourceManager.vue';\nexport * from './components/core/ThreeWebGPURenderer.vue';\n\n// \u7269\u7406\u7EC4\u4EF6\nexport * from './components/physics/ThreePhysicsWorld.vue';\nexport * from './components/physics/ThreeRigidBody.vue';\nexport * from './components/physics/ThreeBoxCollider.vue';\nexport * from './components/physics/ThreeSphereCollider.vue';\nexport * from './components/physics/ThreeConstraint.vue';\n\n// \u540E\u5904\u7406\u7EC4\u4EF6\nexport * from './components/postprocessing/ThreePostProcessing.vue';\nexport * from './components/postprocessing/ThreeBloomEffect.vue';\nexport * from './components/postprocessing/ThreeFXAAEffect.vue';\nexport * from './components/postprocessing/ThreeDepthOfFieldEffect.vue';\n\n// \u8C03\u8BD5\u7EC4\u4EF6\nexport * from './components/debug/ThreeStats.vue';\n\n// \u4EA4\u4E92\u7EC4\u4EF6\nexport * from './components/interaction/ThreeRaycaster.vue';\nexport * from './components/interaction/ThreeInteractive.vue';\n\n// \u5DE5\u5177\u51FD\u6570\nexport * from './utils';\n\n// \u7EC4\u5408\u5F0FAPI\nexport * from './composables/useThree';\nexport * from './composables/useFrame';\n\n// \u63D2\u4EF6\nexport { default as ThreeRenderPlugin } from './plugin';\n\n// \u7C7B\u578B\u5B9A\u4E49\nexport * from './types'; ", "<template>\r\n  <div ref=\"containerRef\" class=\"three-canvas\" :style=\"containerStyle\">\r\n    <slot></slot>\r\n    <div v-if=\"stats\" class=\"three-stats\"></div>\r\n    <div v-if=\"showLoading && loading\" class=\"three-loading\">\r\n      <slot name=\"loading\">\r\n        <div class=\"three-loading-spinner\"></div>\r\n        <div class=\"three-loading-text\">{{ loadingText }}</div>\r\n      </slot>\r\n    </div>\r\n    <div v-if=\"showFps\" class=\"three-fps\">{{ fps }} FPS</div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, onMounted, onBeforeUnmount, provide, watch, computed, nextTick } from 'vue';\r\nimport * as THREE from 'three';\r\nimport { Engine } from 'three-core';\r\nimport { useThreeSize } from '../../composables/useThreeSize';\r\nimport { CANVAS_CONTEXT_KEY } from '../../constants';\r\n\r\nconst props = withDefaults(defineProps<{\r\n  /**\r\n   * \u662F\u5426\u542F\u7528\u6297\u952F\u9F7F\r\n   */\r\n  antialias?: boolean;\r\n  \r\n  /**\r\n   * \u662F\u5426\u81EA\u52A8\u8C03\u6574\u5927\u5C0F\r\n   */\r\n  autoResize?: boolean;\r\n  \r\n  /**\r\n   * \u662F\u5426\u81EA\u52A8\u6E32\u67D3\r\n   */\r\n  autoRender?: boolean;\r\n  \r\n  /**\r\n   * \u50CF\u7D20\u6BD4\r\n   */\r\n  pixelRatio?: number;\r\n  \r\n  /**\r\n   * \u662F\u5426\u663E\u793A\u6027\u80FD\u7EDF\u8BA1\r\n   */\r\n  stats?: boolean;\r\n  \r\n  /**\r\n   * \u80CC\u666F\u989C\u8272\r\n   */\r\n  backgroundColor?: string | number;\r\n  \r\n  /**\r\n   * \u5BBD\u5EA6\r\n   */\r\n  width?: string | number;\r\n  \r\n  /**\r\n   * \u9AD8\u5EA6\r\n   */\r\n  height?: string | number;\r\n  \r\n  /**\r\n   * \u662F\u5426\u542F\u7528\u9634\u5F71\r\n   */\r\n  shadows?: boolean;\r\n  \r\n  /**\r\n   * \u662F\u5426\u542F\u7528 alpha\r\n   */\r\n  alpha?: boolean;\r\n  \r\n  /**\r\n   * \u662F\u5426\u542F\u7528 WebXR\r\n   */\r\n  xr?: boolean;\r\n  \r\n  /**\r\n   * \u662F\u5426\u542F\u7528\u7269\u7406\u6B63\u786E\u6E32\u67D3\r\n   */\r\n  physicallyCorrectLights?: boolean;\r\n  \r\n  /**\r\n   * \u662F\u5426\u542F\u7528 HDR \u8F93\u51FA\r\n   */\r\n  outputEncoding?: 'sRGB' | 'Linear';\r\n  \r\n  /**\r\n   * \u8272\u8C03\u6620\u5C04\r\n   */\r\n  toneMapping?: 'None' | 'Linear' | 'Reinhard' | 'Cineon' | 'ACESFilmic';\r\n  \r\n  /**\r\n   * \u8272\u8C03\u6620\u5C04\u66DD\u5149\r\n   */\r\n  toneMappingExposure?: number;\r\n  \r\n  /**\r\n   * \u662F\u5426\u542F\u7528 MSAA\r\n   */\r\n  samples?: number;\r\n  \r\n  /**\r\n   * \u8981\u542F\u7528\u7684\u7BA1\u7406\u5668\r\n   */\r\n  enableManagers?: string[];\r\n\r\n  /**\r\n   * \u662F\u5426\u5C1D\u8BD5\u4F7F\u7528 WebGPU (\u5B9E\u9A8C\u6027)\r\n   */\r\n  webgpu?: boolean;\r\n\r\n  /**\r\n   * \u662F\u5426\u663E\u793A FPS\r\n   */\r\n  showFps?: boolean;\r\n\r\n  /**\r\n   * \u662F\u5426\u663E\u793A\u52A0\u8F7D\u4E2D\u72B6\u6001\r\n   */\r\n  showLoading?: boolean;\r\n\r\n  /**\r\n   * \u52A0\u8F7D\u4E2D\u6587\u672C\r\n   */\r\n  loadingText?: string;\r\n\r\n  /**\r\n   * \u662F\u5426\u542F\u7528\u540E\u5904\u7406\r\n   */\r\n  postProcessing?: boolean;\r\n\r\n  /**\r\n   * \u662F\u5426\u542F\u7528\u89C6\u9525\u4F53\u5254\u9664\r\n   */\r\n  frustumCulling?: boolean;\r\n\r\n  /**\r\n   * \u662F\u5426\u542F\u7528\u5B9E\u4F8B\u5316\u6E32\u67D3\u4F18\u5316\r\n   */\r\n  instancedRendering?: boolean;\r\n\r\n  /**\r\n   * \u662F\u5426\u542F\u7528\u573A\u666F\u4F18\u5316\r\n   */\r\n  sceneOptimization?: boolean;\r\n\r\n  /**\r\n   * \u662F\u5426\u542F\u7528\u5185\u5B58\u76D1\u63A7\r\n   */\r\n  memoryMonitor?: boolean;\r\n\r\n  /**\r\n   * \u6E32\u67D3\u8D28\u91CF (\u5F71\u54CD\u591A\u4E2A\u6E32\u67D3\u53C2\u6570)\r\n   */\r\n  quality?: 'low' | 'medium' | 'high' | 'ultra';\r\n\r\n  /**\r\n   * \u662F\u5426\u542F\u7528\u63CF\u8FB9\u6548\u679C\r\n   */\r\n  outline?: boolean;\r\n\r\n  /**\r\n   * \u964D\u4F4E\u79FB\u52A8\u8BBE\u5907\u4E0A\u7684\u6E32\u67D3\u8D28\u91CF\r\n   */\r\n  mobileOptimization?: boolean;\r\n}>(), {\r\n  antialias: true,\r\n  autoResize: true,\r\n  autoRender: true,\r\n  pixelRatio: undefined,\r\n  stats: false,\r\n  backgroundColor: 0x000000,\r\n  width: '100%',\r\n  height: '100%',\r\n  shadows: true,\r\n  alpha: false,\r\n  xr: false,\r\n  physicallyCorrectLights: false,\r\n  outputEncoding: 'sRGB',\r\n  toneMapping: 'ACESFilmic',\r\n  toneMappingExposure: 1,\r\n  samples: 0,\r\n  enableManagers: () => ['scene', 'camera', 'renderer', 'controls', 'lights'],\r\n  webgpu: false,\r\n  showFps: false,\r\n  showLoading: true,\r\n  loadingText: '\u52A0\u8F7D\u4E2D...',\r\n  postProcessing: false,\r\n  frustumCulling: true,\r\n  instancedRendering: false,\r\n  sceneOptimization: false,\r\n  memoryMonitor: false,\r\n  quality: 'medium',\r\n  outline: false,\r\n  mobileOptimization: true\r\n});\r\n\r\nconst emit = defineEmits<{\r\n  /**\r\n   * \u5F15\u64CE\u521D\u59CB\u5316\u5B8C\u6210\r\n   */\r\n  (e: 'initialized', engine: any): void;\r\n  \r\n  /**\r\n   * \u6BCF\u5E27\u6E32\u67D3\u524D\r\n   */\r\n  (e: 'beforeRender'): void;\r\n  \r\n  /**\r\n   * \u6BCF\u5E27\u6E32\u67D3\u540E\r\n   */\r\n  (e: 'afterRender'): void;\r\n  \r\n  /**\r\n   * \u7A97\u53E3\u5927\u5C0F\u6539\u53D8\r\n   */\r\n  (e: 'resize', size: { width: number, height: number }): void;\r\n\r\n  /**\r\n   * \u573A\u666F\u52A0\u8F7D\u8FDB\u5EA6\r\n   */\r\n  (e: 'loading-progress', progress: number): void;\r\n\r\n  /**\r\n   * \u6E32\u67D3\u9519\u8BEF\r\n   */\r\n  (e: 'error', error: Error): void;\r\n\r\n  /**\r\n   * \u5185\u5B58\u4F7F\u7528\u60C5\u51B5\r\n   */\r\n  (e: 'memory', stats: { geometries: number, textures: number, triangles: number, points: number, lines: number, calls: number, memory: { total: number, used: number } }): void;\r\n}>();\r\n\r\n// DOM \u5F15\u7528\r\nconst containerRef = ref<HTMLElement | null>(null);\r\n\r\n// \u5F15\u64CE\u5B9E\u4F8B\r\nconst engine = ref<any>(null);\r\n\r\n// \u52A0\u8F7D\u72B6\u6001\r\nconst loading = ref<boolean>(true);\r\n\r\n// \u5E27\u7387\r\nconst fps = ref<number>(0);\r\nlet fpsUpdateInterval: number | undefined;\r\nlet frameCount = 0;\r\nlet lastTime = performance.now();\r\n\r\n// \u662F\u5426\u4E3A\u79FB\u52A8\u8BBE\u5907\r\nconst isMobile = computed(() => {\r\n  if (typeof navigator === 'undefined') return false;\r\n  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\r\n});\r\n\r\n// \u6839\u636E\u8D28\u91CF\u548C\u8BBE\u5907\u7C7B\u578B\u8BA1\u7B97\u5B9E\u9645\u6E32\u67D3\u8D28\u91CF\r\nconst actualQuality = computed(() => {\r\n  if (props.mobileOptimization && isMobile.value) {\r\n    // \u79FB\u52A8\u8BBE\u5907\u964D\u4F4E\u4E00\u7EA7\u8D28\u91CF\r\n    if (props.quality === 'ultra') return 'high';\r\n    if (props.quality === 'high') return 'medium';\r\n    if (props.quality === 'medium') return 'low';\r\n    return 'low';\r\n  }\r\n  return props.quality;\r\n});\r\n\r\n// \u5BB9\u5668\u6837\u5F0F\r\nconst containerStyle = computed(() => ({\r\n  width: typeof props.width === 'number' ? `${props.width}px` : props.width,\r\n  height: typeof props.height === 'number' ? `${props.height}px` : props.height,\r\n  position: 'relative',\r\n  overflow: 'hidden'\r\n}));\r\n\r\n// \u76D1\u542C\u5BB9\u5668\u5927\u5C0F\u53D8\u5316\r\nconst { width, height } = useThreeSize(containerRef);\r\n\r\n// \u66F4\u65B0 FPS \u8BA1\u6570\r\nfunction updateFps() {\r\n  frameCount++;\r\n  const now = performance.now();\r\n  \r\n  if (now - lastTime >= 1000) { // \u6BCF\u79D2\u66F4\u65B0\u4E00\u6B21\r\n    fps.value = Math.round(frameCount * 1000 / (now - lastTime));\r\n    frameCount = 0;\r\n    lastTime = now;\r\n    \r\n    // \u5982\u679C\u542F\u7528\u5185\u5B58\u76D1\u63A7\uFF0C\u53D1\u51FA\u5185\u5B58\u4F7F\u7528\u60C5\u51B5\u4E8B\u4EF6\r\n    if (props.memoryMonitor && engine.value) {\r\n      const renderer = engine.value.getRenderer?.();\r\n      if (renderer && renderer.info) {\r\n        const info = renderer.info;\r\n        const memory = (performance as any).memory ? {\r\n          total: (performance as any).memory.totalJSHeapSize / (1024 * 1024),\r\n          used: (performance as any).memory.usedJSHeapSize / (1024 * 1024)\r\n        } : { total: 0, used: 0 };\r\n        \r\n        emit('memory', {\r\n          geometries: info.memory?.geometries || 0,\r\n          textures: info.memory?.textures || 0,\r\n          triangles: info.render?.triangles || 0,\r\n          points: info.render?.points || 0,\r\n          lines: info.render?.lines || 0,\r\n          calls: info.render?.calls || 0,\r\n          memory\r\n        });\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// \u521D\u59CB\u5316\u5F15\u64CE\r\nasync function initEngine() {\r\n  if (!containerRef.value) return;\r\n\r\n  try {\r\n    loading.value = true;\r\n    \r\n    // \u83B7\u53D6\u6E32\u67D3\u5668\u7C7B\u578B\r\n    const rendererType = props.webgpu && \r\n      typeof navigator !== 'undefined' && \r\n      navigator.gpu ? 'webgpu' : 'webgl';\r\n      \r\n    // \u6839\u636E\u8D28\u91CF\u7EA7\u522B\u8BBE\u7F6E\u6297\u952F\u9F7F\u548C\u9634\u5F71\u8D28\u91CF\r\n    const qualitySettings = {\r\n      low: { \r\n        antialias: false, \r\n        shadowMapType: THREE.BasicShadowMap,\r\n        pixelRatio: Math.min(window.devicePixelRatio, 1),\r\n        shadows: props.shadows\r\n      },\r\n      medium: { \r\n        antialias: props.antialias, \r\n        shadowMapType: THREE.PCFShadowMap,\r\n        pixelRatio: window.devicePixelRatio,\r\n        shadows: props.shadows\r\n      },\r\n      high: { \r\n        antialias: true, \r\n        shadowMapType: THREE.PCFSoftShadowMap,\r\n        pixelRatio: window.devicePixelRatio,\r\n        shadows: props.shadows\r\n      },\r\n      ultra: { \r\n        antialias: true, \r\n        shadowMapType: THREE.VSMShadowMap,\r\n        pixelRatio: window.devicePixelRatio,\r\n        shadows: props.shadows\r\n      }\r\n    };\r\n    \r\n    const quality = qualitySettings[actualQuality.value];\r\n    \r\n    // \u521B\u5EFA\u5F15\u64CE\u5B9E\u4F8B\r\n    engine.value = new Engine({\r\n      container: containerRef.value,\r\n      rendererType,\r\n      antialias: quality.antialias,\r\n      autoRender: props.autoRender,\r\n      autoResize: props.autoResize,\r\n      pixelRatio: props.pixelRatio || quality.pixelRatio,\r\n      alpha: props.alpha,\r\n      enableManagers: [\r\n        ...props.enableManagers,\r\n        // \u6839\u636E\u914D\u7F6E\u542F\u7528\u989D\u5916\u7684\u7BA1\u7406\u5668\r\n        ...(props.postProcessing ? ['composer'] : []),\r\n        ...(props.outline ? ['outline'] : []),\r\n        ...(props.stats || props.memoryMonitor || props.showFps ? ['performance'] : [])\r\n      ]\r\n    });\r\n    \r\n    // \u76D1\u542C\u52A0\u8F7D\u8FDB\u5EA6\r\n    engine.value.on('loading-progress', (progress) => {\r\n      emit('loading-progress', progress);\r\n      if (progress >= 100) {\r\n        loading.value = false;\r\n      }\r\n    });\r\n    \r\n    // \u6DFB\u52A0\u9519\u8BEF\u5904\u7406\r\n    engine.value.on('error', (error) => {\r\n      emit('error', error);\r\n      console.error('ThreeCanvas \u6E32\u67D3\u9519\u8BEF:', error);\r\n    });\r\n    \r\n    // \u521D\u59CB\u5316\u5F15\u64CE\r\n    await engine.value.initialize();\r\n    \r\n    // \u83B7\u53D6\u6E32\u67D3\u5668\u5E76\u914D\u7F6E\r\n    const renderer = await engine.value.getRenderer();\r\n    if (renderer) {\r\n      // \u914D\u7F6E\u9634\u5F71\r\n      renderer.shadowMap.enabled = quality.shadows;\r\n      renderer.shadowMap.type = quality.shadowMapType;\r\n      \r\n      // \u914D\u7F6E\u7269\u7406\u6B63\u786E\u5149\u7167\r\n      renderer.physicallyCorrectLights = props.physicallyCorrectLights;\r\n      \r\n      // \u914D\u7F6E\u8F93\u51FA\u7F16\u7801\r\n      if (props.outputEncoding === 'sRGB') {\r\n        renderer.outputEncoding = THREE.sRGBEncoding;\r\n      } else {\r\n        renderer.outputEncoding = THREE.LinearEncoding;\r\n      }\r\n      \r\n      // \u914D\u7F6E\u8272\u8C03\u6620\u5C04\r\n      const toneMappingOptions = {\r\n        'None': THREE.NoToneMapping,\r\n        'Linear': THREE.LinearToneMapping,\r\n        'Reinhard': THREE.ReinhardToneMapping,\r\n        'Cineon': THREE.CineonToneMapping,\r\n        'ACESFilmic': THREE.ACESFilmicToneMapping\r\n      };\r\n      renderer.toneMapping = toneMappingOptions[props.toneMapping];\r\n      renderer.toneMappingExposure = props.toneMappingExposure;\r\n      \r\n      // \u914D\u7F6E MSAA\r\n      if (props.samples > 0) {\r\n        renderer.samples = props.samples;\r\n      }\r\n      \r\n      // \u914D\u7F6E WebXR\r\n      if (props.xr) {\r\n        renderer.xr.enabled = true;\r\n      }\r\n      \r\n      // \u914D\u7F6E\u89C6\u9525\u4F53\u5254\u9664\r\n      if (props.frustumCulling === false) {\r\n        renderer.frustumCulled = false;\r\n      }\r\n\r\n      // \u914D\u7F6E\u4F18\u5316\u9009\u9879\r\n      if (props.sceneOptimization) {\r\n        const optimizationManager = await engine.value.getOrCreateManager('optimization');\r\n        if (optimizationManager) {\r\n          optimizationManager.enableSceneOptimization({\r\n            mergeGeometries: true,\r\n            batchMaterials: true,\r\n            occlusionCulling: true,\r\n            instancedMeshes: props.instancedRendering\r\n          });\r\n        }\r\n      }\r\n    }\r\n    \r\n    // \u83B7\u53D6\u573A\u666F\u5E76\u8BBE\u7F6E\u80CC\u666F\u8272\r\n    const scene = await engine.value.getScene();\r\n    if (scene) {\r\n      if (typeof props.backgroundColor === 'string') {\r\n        scene.background = new THREE.Color(props.backgroundColor);\r\n      } else {\r\n        scene.background = new THREE.Color(props.backgroundColor);\r\n      }\r\n    }\r\n    \r\n    // \u914D\u7F6E\u540E\u5904\u7406\r\n    if (props.postProcessing) {\r\n      const composerManager = await engine.value.getOrCreateManager('composer');\r\n      if (composerManager) {\r\n        await composerManager.initialize({\r\n          rendererInstance: renderer,\r\n          sceneInstance: scene,\r\n          cameraInstance: await engine.value.getCamera()\r\n        });\r\n      }\r\n    }\r\n    \r\n    // \u914D\u7F6E\u63CF\u8FB9\u6548\u679C\r\n    if (props.outline) {\r\n      const outlineManager = await engine.value.getOrCreateManager('outline');\r\n      if (outlineManager) {\r\n        outlineManager.initialize({\r\n          thickness: 2,\r\n          color: 0xffffff,\r\n          visibleEdgeColor: 0xffffff,\r\n          hiddenEdgeColor: 0x222222\r\n        });\r\n      }\r\n    }\r\n\r\n    // \u6DFB\u52A0\u6E32\u67D3\u94A9\u5B50\r\n    if (props.autoRender) {\r\n      engine.value.beforeRender.subscribe(() => {\r\n        emit('beforeRender');\r\n        if (props.showFps) {\r\n          updateFps();\r\n        }\r\n      });\r\n      \r\n      engine.value.afterRender.subscribe(() => {\r\n        emit('afterRender');\r\n      });\r\n    }\r\n    \r\n    // \u8BBE\u7F6E\u6027\u80FD\u76D1\u63A7\r\n    if (props.stats) {\r\n      const statsContainer = containerRef.value.querySelector('.three-stats');\r\n      if (statsContainer) {\r\n        const performanceManager = await engine.value.getOrCreateManager('performance');\r\n        performanceManager.enableStats(statsContainer);\r\n      }\r\n    }\r\n\r\n    // \u5982\u679C\u542F\u7528 FPS \u663E\u793A\uFF0C\u5F00\u59CB\u8BA1\u7B97\u5E27\u7387\r\n    if (props.showFps) {\r\n      fpsUpdateInterval = window.setInterval(updateFps, 1000);\r\n    }\r\n    \r\n    // \u53D1\u51FA\u521D\u59CB\u5316\u5B8C\u6210\u4E8B\u4EF6\r\n    emit('initialized', engine.value);\r\n    \r\n    // \u52A0\u8F7D\u5B8C\u6210\r\n    nextTick(() => {\r\n      loading.value = false;\r\n    });\r\n  } catch (error) {\r\n    console.error('ThreeCanvas \u521D\u59CB\u5316\u5931\u8D25:', error);\r\n    emit('error', error instanceof Error ? error : new Error(String(error)));\r\n    loading.value = false;\r\n  }\r\n}\r\n\r\n// \u76D1\u542C\u5927\u5C0F\u53D8\u5316\r\nwatch([width, height], ([newWidth, newHeight]) => {\r\n  if (engine.value && props.autoResize) {\r\n    engine.value.resize(newWidth, newHeight);\r\n    emit('resize', { width: newWidth, height: newHeight });\r\n  }\r\n});\r\n\r\n// \u751F\u547D\u5468\u671F\u94A9\u5B50\r\nonMounted(async () => {\r\n  await initEngine();\r\n});\r\n\r\nonBeforeUnmount(() => {\r\n  if (fpsUpdateInterval) {\r\n    clearInterval(fpsUpdateInterval);\r\n  }\r\n  \r\n  if (engine.value) {\r\n    engine.value.dispose();\r\n    engine.value = null;\r\n  }\r\n});\r\n\r\n// \u63D0\u4F9B\u4E0A\u4E0B\u6587\r\nprovide(CANVAS_CONTEXT_KEY, {\r\n  engine,\r\n  containerRef\r\n});\r\n\r\n// \u66B4\u9732\u7ED9\u7236\u7EC4\u4EF6\u7684\u5C5E\u6027\u548C\u65B9\u6CD5\r\ndefineExpose({\r\n  engine,\r\n  containerRef,\r\n  resize: (width: number, height: number) => {\r\n    if (engine.value) {\r\n      engine.value.resize(width, height);\r\n    }\r\n  },\r\n  render: () => {\r\n    if (engine.value) {\r\n      engine.value.render();\r\n    }\r\n  },\r\n  captureScreenshot: (options?: { width?: number, height?: number, format?: 'png' | 'jpg', quality?: number }) => {\r\n    if (engine.value) {\r\n      return engine.value.captureScreenshot(options);\r\n    }\r\n    return null;\r\n  },\r\n  enableOutline: (object: any, color?: number) => {\r\n    if (engine.value && props.outline) {\r\n      const outlineManager = engine.value.getManager('outline');\r\n      outlineManager?.addOutline(object, color);\r\n    }\r\n  },\r\n  disableOutline: (object: any) => {\r\n    if (engine.value && props.outline) {\r\n      const outlineManager = engine.value.getManager('outline');\r\n      outlineManager?.removeOutline(object);\r\n    }\r\n  }\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n.three-canvas {\r\n  position: relative;\r\n  overflow: hidden;\r\n  touch-action: none; /* \u9632\u6B62\u79FB\u52A8\u8BBE\u5907\u4E0A\u7684\u9ED8\u8BA4\u89E6\u6478\u884C\u4E3A */\r\n}\r\n\r\n.three-stats {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  z-index: 100;\r\n}\r\n\r\n.three-fps {\r\n  position: absolute;\r\n  top: 10px;\r\n  right: 10px;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  color: #fff;\r\n  font-family: monospace;\r\n  font-size: 12px;\r\n  padding: 4px 8px;\r\n  border-radius: 4px;\r\n  z-index: 100;\r\n}\r\n\r\n.three-loading {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  color: #fff;\r\n  z-index: 101;\r\n}\r\n\r\n.three-loading-spinner {\r\n  width: 40px;\r\n  height: 40px;\r\n  border: 4px solid rgba(255, 255, 255, 0.3);\r\n  border-radius: 50%;\r\n  border-top-color: #fff;\r\n  animation: spin 1s linear infinite;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.three-loading-text {\r\n  font-size: 16px;\r\n}\r\n\r\n@keyframes spin {\r\n  0% { transform: rotate(0deg); }\r\n  100% { transform: rotate(360deg); }\r\n}\r\n</style> ", "<template>\n  <slot></slot>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, provide, inject, onMounted, onBeforeUnmount, watch } from 'vue';\nimport * as THREE from 'three';\nimport { SCENE_CONTEXT_KEY, RENDER_CONTEXT_KEY } from '../../constants';\n\nconst props = withDefaults(defineProps<{\n  /**\n   * \u80CC\u666F\u8272\n   */\n  background?: string | number | THREE.Texture | THREE.Color | null;\n  \n  /**\n   * \u73AF\u5883\u8272\n   */\n  environment?: string | THREE.Texture | null;\n  \n  /**\n   * \u96FE\u6548\n   */\n  fog?: {\n    color?: string | number;\n    near?: number;\n    far?: number;\n    density?: number;\n    type?: 'normal' | 'exp2';\n  } | null;\n  \n  /**\n   * \u662F\u5426\u542F\u7528\u7269\u7406\u6B63\u786E\u7167\u660E\n   */\n  physicallyCorrectLights?: boolean;\n  \n  /**\n   * \u662F\u5426\u542F\u7528\u81EA\u52A8\u66F4\u65B0\n   */\n  autoUpdate?: boolean;\n  \n  /**\n   * \u573A\u666F\u540D\u79F0\n   */\n  name?: string;\n}>(), {\n  background: null,\n  environment: null,\n  fog: null,\n  physicallyCorrectLights: false,\n  autoUpdate: true,\n  name: 'Scene'\n});\n\nconst emit = defineEmits<{\n  /**\n   * \u573A\u666F\u521B\u5EFA\n   */\n  (e: 'created', scene: THREE.Scene): void;\n  \n  /**\n   * \u573A\u666F\u66F4\u65B0\n   */\n  (e: 'updated', scene: THREE.Scene): void;\n  \n  /**\n   * \u573A\u666F\u9500\u6BC1\n   */\n  (e: 'disposed'): void;\n}>();\n\n// \u83B7\u53D6\u6E32\u67D3\u4E0A\u4E0B\u6587\nconst renderContext = inject(RENDER_CONTEXT_KEY, null);\n\n// \u573A\u666F\u5BF9\u8C61\nconst scene = ref<THREE.Scene | null>(null);\n\n// \u7EB9\u7406\u52A0\u8F7D\u5668\nconst textureLoader = new THREE.TextureLoader();\n\n// \u8BBE\u7F6E\u80CC\u666F\nconst setBackground = async (value: string | number | THREE.Texture | THREE.Color | null) => {\n  if (!scene.value) return;\n  \n  // \u6E05\u9664\u80CC\u666F\n  if (value === null) {\n    scene.value.background = null;\n    return;\n  }\n  \n  // \u989C\u8272\n  if (typeof value === 'string' || typeof value === 'number') {\n    scene.value.background = new THREE.Color(value);\n    return;\n  }\n  \n  // \u7EB9\u7406\u6216\u989C\u8272\n  scene.value.background = value;\n};\n\n// \u8BBE\u7F6E\u73AF\u5883\u8D34\u56FE\nconst setEnvironment = async (value: string | THREE.Texture | null) => {\n  if (!scene.value) return;\n  \n  // \u6E05\u9664\u73AF\u5883\n  if (value === null) {\n    scene.value.environment = null;\n    return;\n  }\n  \n  // \u5982\u679C\u662F\u5B57\u7B26\u4E32\uFF0C\u52A0\u8F7D\u73AF\u5883\u8D34\u56FE\n  if (typeof value === 'string') {\n    try {\n      const texture = await new Promise<THREE.Texture>((resolve, reject) => {\n        textureLoader.load(value, resolve, undefined, reject);\n      });\n      \n      if (scene.value) {\n        scene.value.environment = texture;\n      }\n    } catch (error) {\n      console.error('\u52A0\u8F7D\u73AF\u5883\u8D34\u56FE\u5931\u8D25:', error);\n    }\n    return;\n  }\n  \n  // \u7EB9\u7406\n  scene.value.environment = value;\n};\n\n// \u8BBE\u7F6E\u96FE\u6548\nconst setFog = (fogConfig: typeof props.fog) => {\n  if (!scene.value) return;\n  \n  // \u6E05\u9664\u96FE\u6548\n  if (!fogConfig) {\n    scene.value.fog = null;\n    return;\n  }\n  \n  // \u83B7\u53D6\u96FE\u6548\u989C\u8272\n  const fogColor = fogConfig.color ? new THREE.Color(fogConfig.color) : new THREE.Color(0xcccccc);\n  \n  // \u521B\u5EFA\u96FE\u6548\n  if (fogConfig.type === 'exp2') {\n    // \u6307\u6570\u96FE\u6548\n    scene.value.fog = new THREE.FogExp2(\n      fogColor,\n      fogConfig.density ?? 0.005\n    );\n  } else {\n    // \u7EBF\u6027\u96FE\u6548\n    scene.value.fog = new THREE.Fog(\n      fogColor,\n      fogConfig.near ?? 1,\n      fogConfig.far ?? 1000\n    );\n  }\n};\n  \n// \u521B\u5EFA\u573A\u666F\nconst createScene = () => {\n  // \u521B\u5EFA\u573A\u666F\n  scene.value = new THREE.Scene();\n  \n  // \u8BBE\u7F6E\u573A\u666F\u5C5E\u6027\n  scene.value.name = props.name;\n  \n  // \u8BBE\u7F6E\u80CC\u666F\n  if (props.background !== null) {\n    setBackground(props.background);\n  }\n  \n  // \u8BBE\u7F6E\u73AF\u5883\u8D34\u56FE\n  if (props.environment !== null) {\n    setEnvironment(props.environment);\n  }\n  \n  // \u8BBE\u7F6E\u96FE\u6548\n  if (props.fog !== null) {\n    setFog(props.fog);\n  }\n  \n  // \u53D1\u51FA\u521B\u5EFA\u4E8B\u4EF6\n  emit('created', scene.value);\n  \n  return scene.value;\n};\n\n// \u66F4\u65B0\u573A\u666F\nconst updateScene = () => {\n  if (!scene.value) return;\n  \n  // \u66F4\u65B0\u573A\u666F\u5C5E\u6027\n  scene.value.name = props.name;\n  \n  // \u8BBE\u7F6E\u80CC\u666F\n  setBackground(props.background);\n  \n  // \u8BBE\u7F6E\u73AF\u5883\u8D34\u56FE\n  setEnvironment(props.environment);\n  \n  // \u8BBE\u7F6E\u96FE\u6548\n  setFog(props.fog);\n  \n  // \u66F4\u65B0\u7269\u7406\u6B63\u786E\u7167\u660E\u8BBE\u7F6E\n  if (renderContext?.renderer?.value) {\n    renderContext.renderer.value.physicallyCorrectLights = props.physicallyCorrectLights;\n  }\n  \n  // \u66F4\u65B0\u81EA\u52A8\u66F4\u65B0\u8BBE\u7F6E\n  if (renderContext?.renderer?.value) {\n    renderContext.renderer.value.autoUpdate = props.autoUpdate;\n  }\n  \n  // \u53D1\u51FA\u66F4\u65B0\u4E8B\u4EF6\n  emit('updated', scene.value);\n};\n\n// \u91CA\u653E\u8D44\u6E90\nconst dispose = () => {\n  if (scene.value) {\n    scene.value.clear();\n    scene.value = null;\n    \n    // \u53D1\u51FA\u9500\u6BC1\u4E8B\u4EF6\n    emit('disposed');\n  }\n};\n\n// \u76D1\u542C\u5C5E\u6027\u53D8\u5316\nwatch(\n  () => [\n    props.background,\n    props.environment,\n    props.fog,\n    props.physicallyCorrectLights,\n    props.autoUpdate,\n    props.name\n  ],\n  updateScene,\n  { deep: true }\n);\n\n// \u521B\u5EFA\u573A\u666F\u4E0A\u4E0B\u6587\nconst sceneContext = {\n  scene\n};\n\n// \u63D0\u4F9B\u573A\u666F\u4E0A\u4E0B\u6587\u7ED9\u5B50\u7EC4\u4EF6\nprovide(SCENE_CONTEXT_KEY, sceneContext);\n\n// \u751F\u547D\u5468\u671F\u94A9\u5B50\nonMounted(() => {\n  createScene();\n  \n  // \u66F4\u65B0\u6E32\u67D3\u5668\u4E2D\u7684\u573A\u666F\n  if (renderContext?.scene) {\n    renderContext.scene.value = scene.value;\n  }\n});\n\nonBeforeUnmount(() => {\n  dispose();\n  \n  // \u6E05\u9664\u6E32\u67D3\u5668\u4E2D\u7684\u573A\u666F\n  if (renderContext?.scene) {\n    renderContext.scene.value = null;\n  }\n});\n\n// \u66B4\u9732\u7ED9\u7236\u7EC4\u4EF6\u7684\u5C5E\u6027\u548C\u65B9\u6CD5\ndefineExpose({\n  scene,\n  createScene,\n  updateScene,\n  dispose\n});\n</script> ", "<template>\r\n  <three-object\r\n    v-if=\"camera\"\r\n    :object=\"camera\"\r\n    v-bind=\"objectProps\"\r\n    @mounted=\"onMounted\"\r\n    @unmounted=\"onUnmounted\"\r\n  >\r\n    <slot></slot>\r\n  </three-object>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, provide, inject, onMounted as vueOnMounted, onBeforeUnmount, watch, toRefs } from 'vue';\r\nimport * as THREE from 'three';\r\nimport ThreeObject from './ThreeObject.vue';\r\nimport { CAMERA_CONTEXT_KEY, RENDER_CONTEXT_KEY } from '../../constants';\r\n\r\nconst props = withDefaults(defineProps<{\r\n  /**\r\n   * \u76F8\u673A\u7C7B\u578B\r\n   */\r\n  type?: 'perspective' | 'orthographic';\r\n  \r\n  /**\r\n   * \u76F8\u673A\u89C6\u91CE(PerspectiveCamera only)\r\n   */\r\n  fov?: number;\r\n  \r\n  /**\r\n   * \u957F\u5BBD\u6BD4(PerspectiveCamera only)\r\n   */\r\n  aspect?: number;\r\n  \r\n  /**\r\n   * \u8FD1\u88C1\u526A\u9762\r\n   */\r\n  near?: number;\r\n  \r\n  /**\r\n   * \u8FDC\u88C1\u526A\u9762\r\n   */\r\n  far?: number;\r\n  \r\n  /**\r\n   * \u6B63\u4EA4\u76F8\u673A\u5C3A\u5BF8(OrthographicCamera only)\r\n   */\r\n  size?: number;\r\n  \r\n  /**\r\n   * \u76F8\u673A\u4F4D\u7F6E\r\n   */\r\n  position?: [number, number, number] | { x: number, y: number, z: number };\r\n  \r\n  /**\r\n   * \u76F8\u673A\u671D\u5411(\u76EE\u6807\u70B9)\r\n   */\r\n  lookAt?: [number, number, number] | { x: number, y: number, z: number };\r\n  \r\n  /**\r\n   * \u662F\u5426\u8BBE\u4E3A\u4E3B\u76F8\u673A\r\n   */\r\n  makeDefault?: boolean;\r\n  \r\n  /**\r\n   * \u76F8\u673A\u540D\u79F0\r\n   */\r\n  name?: string;\r\n  \r\n  /**\r\n   * \u662F\u5426\u624B\u52A8\u66F4\u65B0\r\n   */\r\n  manual?: boolean;\r\n  \r\n  /**\r\n   * \u76F8\u673A\u89C6\u56FE\u504F\u79FB\r\n   */\r\n  viewOffset?: {\r\n    fullWidth: number;\r\n    fullHeight: number;\r\n    x: number;\r\n    y: number;\r\n    width: number;\r\n    height: number;\r\n  };\r\n  \r\n  /**\r\n   * \u76F8\u673A\u5C42\u7EA7\r\n   */\r\n  layers?: number[];\r\n  \r\n  /**\r\n   * \u76F8\u673A\u65CB\u8F6C\r\n   */\r\n  rotation?: [number, number, number] | { x: number, y: number, z: number };\r\n  \r\n  /**\r\n   * \u7F29\u653E\r\n   */\r\n  scale?: [number, number, number] | { x: number, y: number, z: number } | number;\r\n  \r\n  /**\r\n   * \u662F\u5426\u53EF\u89C1\r\n   */\r\n  visible?: boolean;\r\n  \r\n  /**\r\n   * \u6E32\u67D3\u987A\u5E8F\r\n   */\r\n  renderOrder?: number;\r\n  \r\n  /**\r\n   * \u7528\u6237\u6570\u636E\r\n   */\r\n  userData?: Record<string, any>;\r\n  \r\n  /**\r\n   * \u77E9\u9635\u81EA\u52A8\u66F4\u65B0\r\n   */\r\n  matrixAutoUpdate?: boolean;\r\n}>(), {\r\n  type: 'perspective',\r\n  fov: 75,\r\n  aspect: 1,\r\n  near: 0.1,\r\n  far: 1000,\r\n  size: 5,\r\n  position: () => [0, 0, 5],\r\n  lookAt: () => [0, 0, 0],\r\n  makeDefault: false,\r\n  name: '',\r\n  manual: false,\r\n  viewOffset: undefined,\r\n  layers: () => [],\r\n  rotation: () => [0, 0, 0],\r\n  scale: 1,\r\n  visible: true,\r\n  renderOrder: 0,\r\n  userData: () => ({}),\r\n  matrixAutoUpdate: true\r\n});\r\n\r\nconst emit = defineEmits<{\r\n  /**\r\n   * \u76F8\u673A\u521B\u5EFA\r\n   */\r\n  (e: 'created', camera: THREE.Camera): void;\r\n  \r\n  /**\r\n   * \u76F8\u673A\u66F4\u65B0\r\n   */\r\n  (e: 'updated', camera: THREE.Camera): void;\r\n  \r\n  /**\r\n   * \u76F8\u673A\u9500\u6BC1\r\n   */\r\n  (e: 'disposed'): void;\r\n}>();\r\n\r\n// \u83B7\u53D6\u6E32\u67D3\u4E0A\u4E0B\u6587\r\nconst renderContext = inject(RENDER_CONTEXT_KEY, null);\r\n\r\n// \u76F8\u673A\u5BF9\u8C61\r\nconst camera = ref<THREE.Camera | null>(null);\r\n\r\n// \u8F6C\u53D1\u7ED9 ThreeObject \u7684\u5C5E\u6027\r\nconst objectProps = computed(() => {\r\n  const { position, rotation, scale, visible, renderOrder, userData, matrixAutoUpdate, name } = toRefs(props);\r\n  \r\n  return {\r\n    position: position.value,\r\n    rotation: rotation.value,\r\n    scale: scale.value,\r\n    visible: visible.value,\r\n    renderOrder: renderOrder.value,\r\n    userData: userData.value,\r\n    matrixAutoUpdate: matrixAutoUpdate.value,\r\n    name: name.value || `${props.type}Camera`\r\n  };\r\n});\r\n\r\n// \u521B\u5EFA\u76F8\u673A\r\nconst createCamera = () => {\r\n  // \u9500\u6BC1\u65E7\u76F8\u673A\r\n  if (camera.value) {\r\n    camera.value = null;\r\n  }\r\n  \r\n  // \u521B\u5EFA\u65B0\u76F8\u673A\r\n  if (props.type === 'orthographic') {\r\n    // \u8BA1\u7B97\u6B63\u4EA4\u76F8\u673A\u7684\u5C3A\u5BF8\r\n    const aspect = props.aspect;\r\n    const size = props.size;\r\n    const halfSize = size / 2;\r\n    const halfWidth = halfSize * aspect;\r\n    const halfHeight = halfSize;\r\n    \r\n    // \u521B\u5EFA\u6B63\u4EA4\u76F8\u673A\r\n    camera.value = new THREE.OrthographicCamera(\r\n      -halfWidth,\r\n      halfWidth,\r\n      halfHeight,\r\n      -halfHeight,\r\n      props.near,\r\n      props.far\r\n    );\r\n  } else {\r\n    // \u521B\u5EFA\u900F\u89C6\u76F8\u673A\r\n    camera.value = new THREE.PerspectiveCamera(\r\n      props.fov,\r\n      props.aspect,\r\n      props.near,\r\n      props.far\r\n    );\r\n  }\r\n  \r\n  // \u8BBE\u7F6E\u76F8\u673A\u540D\u79F0\r\n  camera.value.name = props.name || `${props.type}Camera`;\r\n  \r\n  // \u8BBE\u7F6E\u89C6\u56FE\u504F\u79FB\r\n  if (props.viewOffset && camera.value instanceof THREE.PerspectiveCamera) {\r\n    camera.value.setViewOffset(\r\n      props.viewOffset.fullWidth,\r\n      props.viewOffset.fullHeight,\r\n      props.viewOffset.x,\r\n      props.viewOffset.y,\r\n      props.viewOffset.width,\r\n      props.viewOffset.height\r\n    );\r\n  }\r\n  \r\n  // \u8BBE\u7F6E\u5C42\u7EA7\r\n  if (props.layers.length > 0) {\r\n    camera.value.layers.disableAll();\r\n    props.layers.forEach(layer => {\r\n      camera.value?.layers.enable(layer);\r\n    });\r\n  }\r\n  \r\n  // \u53D1\u51FA\u521B\u5EFA\u4E8B\u4EF6\r\n  emit('created', camera.value);\r\n  \r\n  return camera.value;\r\n};\r\n\r\n// \u66F4\u65B0\u76F8\u673A\u53C2\u6570\r\nconst updateCamera = () => {\r\n  if (!camera.value) return;\r\n  \r\n  // \u66F4\u65B0\u900F\u89C6\u76F8\u673A\u53C2\u6570\r\n  if (props.type === 'perspective' && camera.value instanceof THREE.PerspectiveCamera) {\r\n    camera.value.fov = props.fov;\r\n    camera.value.aspect = props.aspect;\r\n    camera.value.near = props.near;\r\n    camera.value.far = props.far;\r\n    camera.value.updateProjectionMatrix();\r\n  }\r\n  \r\n  // \u66F4\u65B0\u6B63\u4EA4\u76F8\u673A\u53C2\u6570\r\n  if (props.type === 'orthographic' && camera.value instanceof THREE.OrthographicCamera) {\r\n    const aspect = props.aspect;\r\n    const size = props.size;\r\n    const halfSize = size / 2;\r\n    const halfWidth = halfSize * aspect;\r\n    const halfHeight = halfSize;\r\n    \r\n    camera.value.left = -halfWidth;\r\n    camera.value.right = halfWidth;\r\n    camera.value.top = halfHeight;\r\n    camera.value.bottom = -halfHeight;\r\n    camera.value.near = props.near;\r\n    camera.value.far = props.far;\r\n    camera.value.updateProjectionMatrix();\r\n  }\r\n  \r\n  // \u8BBE\u7F6E\u5C42\u7EA7\r\n  if (props.layers.length > 0) {\r\n    camera.value.layers.disableAll();\r\n    props.layers.forEach(layer => {\r\n      camera.value?.layers.enable(layer);\r\n    });\r\n  }\r\n  \r\n  // \u66F4\u65B0\u89C6\u56FE\u504F\u79FB\r\n  if (props.viewOffset && camera.value instanceof THREE.PerspectiveCamera) {\r\n    camera.value.setViewOffset(\r\n      props.viewOffset.fullWidth,\r\n      props.viewOffset.fullHeight,\r\n      props.viewOffset.x,\r\n      props.viewOffset.y,\r\n      props.viewOffset.width,\r\n      props.viewOffset.height\r\n    );\r\n  }\r\n  \r\n  // \u66F4\u65B0\u76F8\u673A\u671D\u5411\r\n  if (props.lookAt) {\r\n    // \u83B7\u53D6\u76EE\u6807\u70B9\r\n    let target: THREE.Vector3;\r\n    if (Array.isArray(props.lookAt)) {\r\n      target = new THREE.Vector3(props.lookAt[0], props.lookAt[1], props.lookAt[2]);\r\n    } else {\r\n      target = new THREE.Vector3(props.lookAt.x, props.lookAt.y, props.lookAt.z);\r\n    }\r\n    \r\n    // \u66F4\u65B0\u76F8\u673A\u671D\u5411\r\n    camera.value.lookAt(target);\r\n  }\r\n  \r\n  // \u53D1\u51FA\u66F4\u65B0\u4E8B\u4EF6\r\n  emit('updated', camera.value);\r\n};\r\n\r\n// \u91CA\u653E\u8D44\u6E90\r\nconst dispose = () => {\r\n  if (camera.value) {\r\n    camera.value = null;\r\n    emit('disposed');\r\n  }\r\n};\r\n\r\n// \u7F51\u683C\u6302\u8F7D\u4E8B\u4EF6\r\nconst onMounted = (object: THREE.Object3D) => {\r\n  // \u8FD9\u4E2A\u51FD\u6570\u7531 ThreeObject \u7EC4\u4EF6\u8C03\u7528\r\n  // \u5982\u679C\u9700\u8981\u8BBE\u4E3A\u4E3B\u76F8\u673A\uFF0C\u5219\u66F4\u65B0\u6E32\u67D3\u4E0A\u4E0B\u6587\r\n  if (props.makeDefault && renderContext?.camera) {\r\n    renderContext.camera.value = camera.value;\r\n  }\r\n  \r\n  // \u66F4\u65B0\u76F8\u673A\u671D\u5411\r\n  if (camera.value && props.lookAt) {\r\n    // \u83B7\u53D6\u76EE\u6807\u70B9\r\n    let target: THREE.Vector3;\r\n    if (Array.isArray(props.lookAt)) {\r\n      target = new THREE.Vector3(props.lookAt[0], props.lookAt[1], props.lookAt[2]);\r\n    } else {\r\n      target = new THREE.Vector3(props.lookAt.x, props.lookAt.y, props.lookAt.z);\r\n    }\r\n    \r\n    // \u66F4\u65B0\u76F8\u673A\u671D\u5411\r\n    camera.value.lookAt(target);\r\n  }\r\n};\r\n\r\n// \u7F51\u683C\u5378\u8F7D\u4E8B\u4EF6\r\nconst onUnmounted = () => {\r\n  // \u5982\u679C\u662F\u4E3B\u76F8\u673A\uFF0C\u5219\u6E05\u9664\u6E32\u67D3\u4E0A\u4E0B\u6587\u4E2D\u7684\u76F8\u673A\r\n  if (props.makeDefault && renderContext?.camera?.value === camera.value) {\r\n    renderContext.camera.value = null;\r\n  }\r\n};\r\n\r\n// \u76D1\u542C\u5C5E\u6027\u53D8\u5316\r\nwatch(\r\n  () => [\r\n    props.type,\r\n    props.fov,\r\n    props.aspect,\r\n    props.near,\r\n    props.far,\r\n    props.size,\r\n    props.viewOffset,\r\n    props.layers\r\n  ],\r\n  updateCamera,\r\n  { deep: true }\r\n);\r\n\r\n// \u76D1\u542C lookAt \u5C5E\u6027\u53D8\u5316\r\nwatch(\r\n  () => props.lookAt,\r\n  () => {\r\n    if (camera.value && props.lookAt) {\r\n      // \u83B7\u53D6\u76EE\u6807\u70B9\r\n      let target: THREE.Vector3;\r\n      if (Array.isArray(props.lookAt)) {\r\n        target = new THREE.Vector3(props.lookAt[0], props.lookAt[1], props.lookAt[2]);\r\n      } else {\r\n        target = new THREE.Vector3(props.lookAt.x, props.lookAt.y, props.lookAt.z);\r\n      }\r\n      \r\n      // \u66F4\u65B0\u76F8\u673A\u671D\u5411\r\n      camera.value.lookAt(target);\r\n    }\r\n  },\r\n  { deep: true }\r\n);\r\n\r\n// \u76D1\u542C makeDefault \u5C5E\u6027\u53D8\u5316\r\nwatch(\r\n  () => props.makeDefault,\r\n  (value) => {\r\n    if (value && renderContext?.camera && camera.value) {\r\n      renderContext.camera.value = camera.value;\r\n    }\r\n  }\r\n);\r\n\r\n// \u521B\u5EFA\u76F8\u673A\u4E0A\u4E0B\u6587\r\nconst cameraContext = {\r\n  camera\r\n};\r\n\r\n// \u63D0\u4F9B\u76F8\u673A\u4E0A\u4E0B\u6587\u7ED9\u5B50\u7EC4\u4EF6\r\nprovide(CAMERA_CONTEXT_KEY, cameraContext);\r\n\r\n// \u751F\u547D\u5468\u671F\u94A9\u5B50\r\nvueOnMounted(() => {\r\n  createCamera();\r\n  \r\n  // \u5982\u679C\u8BBE\u4E3A\u4E3B\u76F8\u673A\uFF0C\u5219\u66F4\u65B0\u6E32\u67D3\u4E0A\u4E0B\u6587\r\n  if (props.makeDefault && renderContext?.camera && camera.value) {\r\n    renderContext.camera.value = camera.value;\r\n  }\r\n});\r\n\r\nonBeforeUnmount(() => {\r\n  // \u5982\u679C\u662F\u4E3B\u76F8\u673A\uFF0C\u5219\u6E05\u9664\u6E32\u67D3\u4E0A\u4E0B\u6587\u4E2D\u7684\u76F8\u673A\r\n  if (props.makeDefault && renderContext?.camera?.value === camera.value) {\r\n    renderContext.camera.value = null;\r\n  }\r\n  \r\n  // \u91CA\u653E\u8D44\u6E90\r\n  dispose();\r\n});\r\n\r\n// \u66B4\u9732\u7ED9\u7236\u7EC4\u4EF6\u7684\u5C5E\u6027\u548C\u65B9\u6CD5\r\ndefineExpose({\r\n  camera,\r\n  createCamera,\r\n  updateCamera,\r\n  dispose\r\n});\r\n</script> ", "<template>\r\n  <three-object\r\n    ref=\"objectRef\"\r\n    :object=\"mesh\"\r\n    v-bind=\"objectProps\"\r\n    @mounted=\"onMounted\"\r\n    @unmounted=\"onUnmounted\"\r\n  >\r\n    <slot></slot>\r\n  </three-object>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, provide, onMounted as vueOnMounted, onBeforeUnmount, watch, toRefs } from 'vue';\r\nimport * as THREE from 'three';\r\nimport ThreeObject from './ThreeObject.vue';\r\nimport { GEOMETRY_CONTEXT_KEY, MATERIAL_CONTEXT_KEY, MESH_CONTEXT_KEY } from '../../constants';\r\n\r\nconst props = withDefaults(defineProps<{\r\n  /**\r\n   * \u51E0\u4F55\u4F53\u5BF9\u8C61\r\n   */\r\n  geometry?: THREE.BufferGeometry | null;\r\n  \r\n  /**\r\n   * \u6750\u8D28\u5BF9\u8C61\r\n   */\r\n  material?: THREE.Material | THREE.Material[] | null;\r\n  \r\n  /**\r\n   * \u4F4D\u7F6E\r\n   */\r\n  position?: [number, number, number] | { x: number, y: number, z: number };\r\n  \r\n  /**\r\n   * \u65CB\u8F6C\r\n   */\r\n  rotation?: [number, number, number] | { x: number, y: number, z: number };\r\n  \r\n  /**\r\n   * \u7F29\u653E\r\n   */\r\n  scale?: [number, number, number] | { x: number, y: number, z: number } | number;\r\n  \r\n  /**\r\n   * \u662F\u5426\u53EF\u89C1\r\n   */\r\n  visible?: boolean;\r\n  \r\n  /**\r\n   * \u662F\u5426\u6295\u5C04\u9634\u5F71\r\n   */\r\n  castShadow?: boolean;\r\n  \r\n  /**\r\n   * \u662F\u5426\u63A5\u6536\u9634\u5F71\r\n   */\r\n  receiveShadow?: boolean;\r\n  \r\n  /**\r\n   * \u662F\u5426\u542F\u7528\u89C6\u9525\u4F53\u5254\u9664\r\n   */\r\n  frustumCulled?: boolean;\r\n  \r\n  /**\r\n   * \u6E32\u67D3\u987A\u5E8F\r\n   */\r\n  renderOrder?: number;\r\n  \r\n  /**\r\n   * \u7528\u6237\u6570\u636E\r\n   */\r\n  userData?: Record<string, any>;\r\n  \r\n  /**\r\n   * \u77E9\u9635\u81EA\u52A8\u66F4\u65B0\r\n   */\r\n  matrixAutoUpdate?: boolean;\r\n  \r\n  /**\r\n   * \u540D\u79F0\r\n   */\r\n  name?: string;\r\n}>(), {\r\n  geometry: null,\r\n  material: null,\r\n  position: () => [0, 0, 0],\r\n  rotation: () => [0, 0, 0],\r\n  scale: 1,\r\n  visible: true,\r\n  castShadow: false,\r\n  receiveShadow: false,\r\n  frustumCulled: true,\r\n  renderOrder: 0,\r\n  userData: () => ({}),\r\n  matrixAutoUpdate: true,\r\n  name: ''\r\n});\r\n\r\nconst emit = defineEmits<{\r\n  /**\r\n   * \u7F51\u683C\u5BF9\u8C61\u521B\u5EFA\r\n   */\r\n  (e: 'created', mesh: THREE.Mesh): void;\r\n  \r\n  /**\r\n   * \u7F51\u683C\u5BF9\u8C61\u66F4\u65B0\r\n   */\r\n  (e: 'updated', mesh: THREE.Mesh): void;\r\n  \r\n  /**\r\n   * \u7F51\u683C\u5BF9\u8C61\u9500\u6BC1\r\n   */\r\n  (e: 'disposed'): void;\r\n  \r\n  /**\r\n   * \u70B9\u51FB\u4E8B\u4EF6\r\n   */\r\n  (e: 'click', event: THREE.Event): void;\r\n  \r\n  /**\r\n   * \u6307\u9488\u79FB\u5165\u4E8B\u4EF6\r\n   */\r\n  (e: 'pointerenter', event: THREE.Event): void;\r\n  \r\n  /**\r\n   * \u6307\u9488\u79FB\u51FA\u4E8B\u4EF6\r\n   */\r\n  (e: 'pointerleave', event: THREE.Event): void;\r\n}>();\r\n\r\n// \u5BF9\u8C61\u5F15\u7528\r\nconst objectRef = ref<any>(null);\r\n\r\n// \u7F51\u683C\u5BF9\u8C61\r\nconst mesh = ref<THREE.Mesh | null>(null);\r\n\r\n// \u8F6C\u53D1\u7ED9 ThreeObject \u7684\u5C5E\u6027\r\nconst objectProps = computed(() => {\r\n  const { position, rotation, scale, visible, castShadow, receiveShadow, frustumCulled, renderOrder, userData, matrixAutoUpdate, name } = toRefs(props);\r\n  \r\n  return {\r\n    position: position.value,\r\n    rotation: rotation.value,\r\n    scale: scale.value,\r\n    visible: visible.value,\r\n    castShadow: castShadow.value,\r\n    receiveShadow: receiveShadow.value,\r\n    frustumCulled: frustumCulled.value,\r\n    renderOrder: renderOrder.value,\r\n    userData: userData.value,\r\n    matrixAutoUpdate: matrixAutoUpdate.value,\r\n    name: name.value\r\n  };\r\n});\r\n\r\n// \u83B7\u53D6\u51E0\u4F55\u4F53\u4E0A\u4E0B\u6587\r\nconst geometryContext = inject(GEOMETRY_CONTEXT_KEY, null);\r\n\r\n// \u83B7\u53D6\u6750\u8D28\u4E0A\u4E0B\u6587\r\nconst materialContext = inject(MATERIAL_CONTEXT_KEY, null);\r\n\r\n// \u521B\u5EFA\u7F51\u683C\u5BF9\u8C61\r\nconst createMesh = () => {\r\n  // \u9500\u6BC1\u65E7\u5BF9\u8C61\r\n  if (mesh.value) {\r\n    mesh.value = null;\r\n  }\r\n  \r\n  // \u83B7\u53D6\u51E0\u4F55\u4F53\r\n  let geometry: THREE.BufferGeometry;\r\n  if (props.geometry) {\r\n    // \u4F7F\u7528\u4F20\u5165\u7684\u51E0\u4F55\u4F53\r\n    geometry = props.geometry;\r\n  } else if (geometryContext?.geometry?.value) {\r\n    // \u4F7F\u7528\u4E0A\u4E0B\u6587\u4E2D\u7684\u51E0\u4F55\u4F53\r\n    geometry = geometryContext.geometry.value;\r\n  } else {\r\n    // \u521B\u5EFA\u9ED8\u8BA4\u51E0\u4F55\u4F53\r\n    geometry = new THREE.BoxGeometry(1, 1, 1);\r\n  }\r\n  \r\n  // \u83B7\u53D6\u6750\u8D28\r\n  let material: THREE.Material | THREE.Material[];\r\n  if (props.material) {\r\n    // \u4F7F\u7528\u4F20\u5165\u7684\u6750\u8D28\r\n    material = props.material;\r\n  } else if (materialContext?.material?.value) {\r\n    // \u4F7F\u7528\u4E0A\u4E0B\u6587\u4E2D\u7684\u6750\u8D28\r\n    material = materialContext.material.value;\r\n  } else {\r\n    // \u521B\u5EFA\u9ED8\u8BA4\u6750\u8D28\r\n    material = new THREE.MeshStandardMaterial({ color: 0xcccccc });\r\n  }\r\n  \r\n  // \u521B\u5EFA\u7F51\u683C\r\n  mesh.value = new THREE.Mesh(geometry, material);\r\n  \r\n  // \u8BBE\u7F6E\u5C5E\u6027\r\n  mesh.value.castShadow = props.castShadow;\r\n  mesh.value.receiveShadow = props.receiveShadow;\r\n  \r\n  // \u53D1\u51FA\u521B\u5EFA\u4E8B\u4EF6\r\n  emit('created', mesh.value);\r\n  \r\n  return mesh.value;\r\n};\r\n\r\n// \u76D1\u542C\u51E0\u4F55\u4F53\u548C\u6750\u8D28\u53D8\u5316\r\nwatch(\r\n  [\r\n    () => props.geometry,\r\n    () => geometryContext?.geometry?.value,\r\n    () => props.material,\r\n    () => materialContext?.material?.value\r\n  ],\r\n  () => {\r\n    // \u91CD\u65B0\u521B\u5EFA\u7F51\u683C\r\n    if (mesh.value) {\r\n      const oldMesh = mesh.value;\r\n      \r\n      // \u521B\u5EFA\u65B0\u7684\u7F51\u683C\u5BF9\u8C61\r\n      createMesh();\r\n      \r\n      // \u5982\u679C\u6709\u65E7\u7F51\u683C\uFF0C\u590D\u5236\u4F4D\u7F6E\u3001\u65CB\u8F6C\u548C\u7F29\u653E\r\n      if (oldMesh) {\r\n        mesh.value.position.copy(oldMesh.position);\r\n        mesh.value.rotation.copy(oldMesh.rotation);\r\n        mesh.value.scale.copy(oldMesh.scale);\r\n      }\r\n      \r\n      // \u66F4\u65B0 ThreeObject \u7EC4\u4EF6\u4E2D\u7684\u5BF9\u8C61\r\n      if (objectRef.value) {\r\n        objectRef.value.object = mesh.value;\r\n      }\r\n      \r\n      // \u53D1\u51FA\u66F4\u65B0\u4E8B\u4EF6\r\n      emit('updated', mesh.value);\r\n    }\r\n  },\r\n  { deep: true }\r\n);\r\n\r\n// \u7F51\u683C\u6302\u8F7D\u4E8B\u4EF6\r\nconst onMounted = (object: THREE.Object3D) => {\r\n  // \u8FD9\u4E2A\u51FD\u6570\u7531 ThreeObject \u7EC4\u4EF6\u8C03\u7528\r\n};\r\n\r\n// \u7F51\u683C\u5378\u8F7D\u4E8B\u4EF6\r\nconst onUnmounted = () => {\r\n  // \u53D1\u51FA\u9500\u6BC1\u4E8B\u4EF6\r\n  emit('disposed');\r\n};\r\n\r\n// \u521B\u5EFA\u7F51\u683C\u4E0A\u4E0B\u6587\r\nconst meshContext = {\r\n  mesh\r\n};\r\n\r\n// \u63D0\u4F9B\u7F51\u683C\u4E0A\u4E0B\u6587\u7ED9\u5B50\u7EC4\u4EF6\r\nprovide(MESH_CONTEXT_KEY, meshContext);\r\n\r\n// \u751F\u547D\u5468\u671F\u94A9\u5B50\r\nvueOnMounted(() => {\r\n  createMesh();\r\n});\r\n\r\nonBeforeUnmount(() => {\r\n  // \u7F51\u683C\u5BF9\u8C61\u7531 ThreeObject \u7EC4\u4EF6\u8D1F\u8D23\u4ECE\u573A\u666F\u4E2D\u79FB\u9664\r\n  mesh.value = null;\r\n});\r\n\r\n// \u66B4\u9732\u7ED9\u7236\u7EC4\u4EF6\u7684\u5C5E\u6027\u548C\u65B9\u6CD5\r\ndefineExpose({\r\n  mesh,\r\n  object: mesh, // \u517C\u5BB9 ThreeObject \u63A5\u53E3\r\n  createMesh\r\n});\r\n</script> ", "<template>\r\n  <slot></slot>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, inject, onMounted, onBeforeUnmount, watch, toRefs } from 'vue';\r\nimport * as THREE from 'three';\r\nimport { SCENE_CONTEXT_KEY, OBJECT_CONTEXT_KEY, OBJECT_EVENTS } from '../../constants';\r\n\r\nconst props = withDefaults(defineProps<{\r\n  /**\r\n   * Three.js \u5BF9\u8C61\u6216\u5BF9\u8C61\u53C2\u8003\r\n   */\r\n  object?: THREE.Object3D | null;\r\n\r\n  /**\r\n   * \u4F4D\u7F6E\r\n   */\r\n  position?: [number, number, number] | { x: number, y: number, z: number };\r\n\r\n  /**\r\n   * \u65CB\u8F6C\r\n   */\r\n  rotation?: [number, number, number] | { x: number, y: number, z: number };\r\n\r\n  /**\r\n   * \u7F29\u653E\r\n   */\r\n  scale?: [number, number, number] | { x: number, y: number, z: number } | number;\r\n\r\n  /**\r\n   * \u662F\u5426\u53EF\u89C1\r\n   */\r\n  visible?: boolean;\r\n\r\n  /**\r\n   * \u662F\u5426\u6295\u5C04\u9634\u5F71\r\n   */\r\n  castShadow?: boolean;\r\n\r\n  /**\r\n   * \u662F\u5426\u63A5\u6536\u9634\u5F71\r\n   */\r\n  receiveShadow?: boolean;\r\n\r\n  /**\r\n   * \u662F\u5426\u542F\u7528\u89C6\u9525\u4F53\u5254\u9664\r\n   */\r\n  frustumCulled?: boolean;\r\n\r\n  /**\r\n   * \u6E32\u67D3\u987A\u5E8F\r\n   */\r\n  renderOrder?: number;\r\n\r\n  /**\r\n   * \u7528\u6237\u6570\u636E\r\n   */\r\n  userData?: Record<string, any>;\r\n\r\n  /**\r\n   * \u77E9\u9635\u81EA\u52A8\u66F4\u65B0\r\n   */\r\n  matrixAutoUpdate?: boolean;\r\n\r\n  /**\r\n   * \u540D\u79F0\r\n   */\r\n  name?: string;\r\n}>(), {\r\n  object: null,\r\n  position: () => [0, 0, 0],\r\n  rotation: () => [0, 0, 0],\r\n  scale: 1,\r\n  visible: true,\r\n  castShadow: false,\r\n  receiveShadow: false,\r\n  frustumCulled: true,\r\n  renderOrder: 0,\r\n  userData: () => ({}),\r\n  matrixAutoUpdate: true,\r\n  name: ''\r\n});\r\n\r\n// \u4FEE\u6539defineEmits\u90E8\u5206\uFF0C\u907F\u514D\u4F7F\u7528\u6620\u5C04\u7C7B\u578B\r\nconst emit = defineEmits([\r\n  // \u57FA\u7840\u4E8B\u4EF6\r\n  'created',\r\n  'mounted',\r\n  'beforeUnmount',\r\n  'unmounted',\r\n  'updated',\r\n  \r\n  // Three.js\u5BF9\u8C61\u4E8B\u4EF6\r\n  'click',\r\n  'dblclick',\r\n  'contextmenu',\r\n  'pointerdown',\r\n  'pointerup',\r\n  'pointermove',\r\n  'pointerenter',\r\n  'pointerleave',\r\n  'pointerover',\r\n  'pointerout',\r\n  'wheel',\r\n  'keydown',\r\n  'keyup',\r\n  'focus',\r\n  'blur',\r\n  'drag',\r\n  'dragstart',\r\n  'dragend',\r\n  'drop'\r\n]);\r\n\r\n// \u83B7\u53D6\u573A\u666F\u4E0A\u4E0B\u6587\r\nconst sceneContext = inject(SCENE_CONTEXT_KEY);\r\nif (!sceneContext) {\r\n  console.error('ThreeObject \u5FC5\u987B\u5728 ThreeScene \u7EC4\u4EF6\u5185\u90E8\u4F7F\u7528');\r\n}\r\n\r\n// \u83B7\u53D6\u7236\u5BF9\u8C61\u4E0A\u4E0B\u6587\r\nconst parentContext = inject(OBJECT_CONTEXT_KEY, null);\r\n\r\n// \u5BF9\u8C61\u5F15\u7528\r\nconst objectRef = ref<THREE.Object3D | null>(null);\r\n\r\n// \u63D0\u4F9B\u7ED9\u5B50\u7EC4\u4EF6\u7684\u4E0A\u4E0B\u6587\r\nconst objectContext = {\r\n  object: objectRef\r\n};\r\n\r\n// \u54CD\u5E94\u5F0F\u5C5E\u6027\r\nconst {\r\n  object,\r\n  position,\r\n  rotation,\r\n  scale,\r\n  visible,\r\n  castShadow,\r\n  receiveShadow,\r\n  frustumCulled,\r\n  renderOrder,\r\n  userData,\r\n  matrixAutoUpdate,\r\n  name\r\n} = toRefs(props);\r\n\r\n// \u5904\u7406\u4F4D\u7F6E\u5C5E\u6027\r\nconst setPosition = (obj: THREE.Object3D, pos: typeof props.position) => {\r\n  if (Array.isArray(pos)) {\r\n    obj.position.set(pos[0], pos[1], pos[2]);\r\n  } else if (typeof pos === 'object') {\r\n    obj.position.set(pos.x, pos.y, pos.z);\r\n  }\r\n};\r\n\r\n// \u5904\u7406\u65CB\u8F6C\u5C5E\u6027\r\nconst setRotation = (obj: THREE.Object3D, rot: typeof props.rotation) => {\r\n  if (Array.isArray(rot)) {\r\n    obj.rotation.set(rot[0], rot[1], rot[2]);\r\n  } else if (typeof rot === 'object') {\r\n    obj.rotation.set(rot.x, rot.y, rot.z);\r\n  }\r\n};\r\n\r\n// \u5904\u7406\u7F29\u653E\u5C5E\u6027\r\nconst setScale = (obj: THREE.Object3D, sc: typeof props.scale) => {\r\n  if (Array.isArray(sc)) {\r\n    obj.scale.set(sc[0], sc[1], sc[2]);\r\n  } else if (typeof sc === 'object') {\r\n    obj.scale.set(sc.x, sc.y, sc.z);\r\n  } else if (typeof sc === 'number') {\r\n    obj.scale.set(sc, sc, sc);\r\n  }\r\n};\r\n\r\n// \u66F4\u65B0\u5BF9\u8C61\u5C5E\u6027\r\nconst updateObjectProps = (obj: THREE.Object3D) => {\r\n  if (!obj) return;\r\n\r\n  // \u8BBE\u7F6E\u57FA\u672C\u5C5E\u6027\r\n  obj.visible = visible.value;\r\n  obj.castShadow = castShadow.value;\r\n  obj.receiveShadow = receiveShadow.value;\r\n  obj.frustumCulled = frustumCulled.value;\r\n  obj.renderOrder = renderOrder.value;\r\n  obj.matrixAutoUpdate = matrixAutoUpdate.value;\r\n  obj.name = name.value;\r\n\r\n  // \u8BBE\u7F6E\u4F4D\u7F6E\u3001\u65CB\u8F6C\u548C\u7F29\u653E\r\n  setPosition(obj, position.value);\r\n  setRotation(obj, rotation.value);\r\n  setScale(obj, scale.value);\r\n\r\n  // \u66F4\u65B0\u7528\u6237\u6570\u636E\r\n  Object.assign(obj.userData, userData.value);\r\n\r\n  // \u66F4\u65B0\u77E9\u9635\r\n  if (matrixAutoUpdate.value) {\r\n    obj.updateMatrix();\r\n  }\r\n};\r\n\r\n// \u6DFB\u52A0\u5BF9\u8C61\u5230\u573A\u666F\u6216\u7236\u5BF9\u8C61\r\nconst addObject = () => {\r\n  const obj = props.object || objectRef.value;\r\n  if (!obj) return;\r\n\r\n  // \u66F4\u65B0\u5BF9\u8C61\u5C5E\u6027\r\n  updateObjectProps(obj);\r\n\r\n  // \u6DFB\u52A0\u5230\u7236\u5BF9\u8C61\u6216\u573A\u666F\r\n  if (parentContext?.object?.value) {\r\n    parentContext.object.value.add(obj);\r\n  } else if (sceneContext?.scene?.value) {\r\n    sceneContext.scene.value.add(obj);\r\n  }\r\n\r\n  // \u4FDD\u5B58\u5BF9\u8C61\u5F15\u7528\r\n  objectRef.value = obj;\r\n\r\n  // \u53D1\u51FA\u6DFB\u52A0\u4E8B\u4EF6\r\n  emit('mounted', obj);\r\n};\r\n\r\n// \u4ECE\u573A\u666F\u6216\u7236\u5BF9\u8C61\u79FB\u9664\u5BF9\u8C61\r\nconst removeObject = () => {\r\n  const obj = objectRef.value;\r\n  if (!obj) return;\r\n\r\n  // \u4ECE\u7236\u5BF9\u8C61\u6216\u573A\u666F\u79FB\u9664\r\n  if (obj.parent) {\r\n    obj.parent.remove(obj);\r\n  }\r\n\r\n  // \u53D1\u51FA\u79FB\u9664\u4E8B\u4EF6\r\n  emit('unmounted', obj);\r\n};\r\n\r\n// \u6DFB\u52A0\u4E8B\u4EF6\u76D1\u542C\r\nconst addEventListeners = (obj: THREE.Object3D) => {\r\n  if (!obj) return;\r\n\r\n  // \u904D\u5386\u6240\u6709\u4E8B\u4EF6\r\n  Object.entries(OBJECT_EVENTS).forEach(([key, eventName]) => {\r\n    // \u6DFB\u52A0\u4E8B\u4EF6\u76D1\u542C\r\n    obj.addEventListener(eventName, (event) => {\r\n      emit(eventName as any, event);\r\n    });\r\n  });\r\n};\r\n\r\n// \u79FB\u9664\u4E8B\u4EF6\u76D1\u542C\r\nconst removeEventListeners = (obj: THREE.Object3D) => {\r\n  if (!obj) return;\r\n\r\n  // \u904D\u5386\u6240\u6709\u4E8B\u4EF6\r\n  Object.entries(OBJECT_EVENTS).forEach(([key, eventName]) => {\r\n    // \u79FB\u9664\u4E8B\u4EF6\u76D1\u542C\r\n    obj.removeEventListener(eventName, (event) => {\r\n      emit(eventName as any, event);\r\n    });\r\n  });\r\n};\r\n\r\n// \u76D1\u542C\u5BF9\u8C61\u5C5E\u6027\u53D8\u5316\r\nwatch(\r\n  [\r\n    position,\r\n    rotation,\r\n    scale,\r\n    visible,\r\n    castShadow,\r\n    receiveShadow,\r\n    frustumCulled,\r\n    renderOrder,\r\n    userData,\r\n    matrixAutoUpdate,\r\n    name\r\n  ],\r\n  () => {\r\n    const obj = props.object || objectRef.value;\r\n    if (!obj) return;\r\n\r\n    // \u66F4\u65B0\u5BF9\u8C61\u5C5E\u6027\r\n    updateObjectProps(obj);\r\n\r\n    // \u53D1\u51FA\u66F4\u65B0\u4E8B\u4EF6\r\n    emit('update', obj);\r\n  },\r\n  { deep: true }\r\n);\r\n\r\n// \u76D1\u542C\u5BF9\u8C61\u53D8\u5316\r\nwatch(object, (newObject, oldObject) => {\r\n  // \u5982\u679C\u6709\u65E7\u5BF9\u8C61\uFF0C\u79FB\u9664\u5B83\r\n  if (oldObject) {\r\n    removeEventListeners(oldObject);\r\n    removeObject();\r\n  }\r\n\r\n  // \u5982\u679C\u6709\u65B0\u5BF9\u8C61\uFF0C\u6DFB\u52A0\u5B83\r\n  if (newObject) {\r\n    objectRef.value = newObject;\r\n    addEventListeners(newObject);\r\n    addObject();\r\n  }\r\n});\r\n\r\n// \u751F\u547D\u5468\u671F\u94A9\u5B50\r\nonMounted(() => {\r\n  // \u5982\u679C\u6709\u5BF9\u8C61\uFF0C\u6DFB\u52A0\u5B83\r\n  if (props.object) {\r\n    objectRef.value = props.object;\r\n    addEventListeners(props.object);\r\n    addObject();\r\n  }\r\n});\r\n\r\nonBeforeUnmount(() => {\r\n  // \u79FB\u9664\u5BF9\u8C61\r\n  if (objectRef.value) {\r\n    removeEventListeners(objectRef.value);\r\n    removeObject();\r\n  }\r\n});\r\n\r\n// \u63D0\u4F9B\u4E0A\u4E0B\u6587\u7ED9\u5B50\u7EC4\u4EF6\r\nprovide(OBJECT_CONTEXT_KEY, objectContext);\r\n\r\n// \u66B4\u9732\u7ED9\u7236\u7EC4\u4EF6\u7684\u5C5E\u6027\u548C\u65B9\u6CD5\r\ndefineExpose({\r\n  object: objectRef,\r\n  addObject,\r\n  removeObject,\r\n  updateObjectProps\r\n});\r\n</script> ", "<script>\r\nimport { ref, onMounted, onBeforeUnmount, provide, InjectionKey } from 'vue';\r\nimport {\r\n  Texture,\r\n  Material,\r\n  BufferGeometry,\r\n  Object3D,\r\n  Scene\r\n} from 'three';\r\nimport { useThree } from '../../composables/useThree';\r\nimport { disposeObject, disposeMaterial } from '../../utils';\r\n\r\n// \u8D44\u6E90\u7BA1\u7406\u5668\u6CE8\u5165\u952E\r\nexport const RESOURCE_MANAGER_INJECTION_KEY = Symbol('resource-manager');\r\n\r\nexport default {\r\n  props: {\r\n    autoDispose: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    disposeInterval: {\r\n      type: Number,\r\n      default: 60000\r\n    },\r\n    debug: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  setup(props) {\r\n    // \u8D44\u6E90\u96C6\u5408\r\n    const textures = ref(new Map());\r\n    const materials = ref(new Map());\r\n    const geometries = ref(new Map());\r\n    const objects = ref(new Map());\r\n\r\n    // \u83B7\u53D6Three.js\u6838\u5FC3\u5BF9\u8C61\r\n    const { scene } = useThree();\r\n\r\n    // \u6CE8\u518C\u7EB9\u7406\r\n    const registerTexture = (id, texture) => {\r\n      textures.value.set(id, { resource: texture, lastUsed: Date.now() });\r\n      if (props.debug) {\r\n        console.log(`[ResourceManager] Registered texture: ${id}`);\r\n      }\r\n    };\r\n\r\n    // \u6CE8\u9500\u7EB9\u7406\r\n    const unregisterTexture = (id) => {\r\n      const textureEntry = textures.value.get(id);\r\n      if (textureEntry) {\r\n        textureEntry.resource.dispose();\r\n        textures.value.delete(id);\r\n        if (props.debug) {\r\n          console.log(`[ResourceManager] Unregistered texture: ${id}`);\r\n        }\r\n      }\r\n    };\r\n\r\n    // \u83B7\u53D6\u7EB9\u7406\r\n    const getTexture = (id) => {\r\n      const textureEntry = textures.value.get(id);\r\n      if (textureEntry) {\r\n        textureEntry.lastUsed = Date.now();\r\n        return textureEntry.resource;\r\n      }\r\n      return undefined;\r\n    };\r\n\r\n    // \u6CE8\u518C\u6750\u8D28\r\n    const registerMaterial = (id, material) => {\r\n      materials.value.set(id, { resource: material, lastUsed: Date.now() });\r\n      if (props.debug) {\r\n        console.log(`[ResourceManager] Registered material: ${id}`);\r\n      }\r\n    };\r\n\r\n    // \u6CE8\u9500\u6750\u8D28\r\n    const unregisterMaterial = (id) => {\r\n      const materialEntry = materials.value.get(id);\r\n      if (materialEntry) {\r\n        disposeMaterial(materialEntry.resource);\r\n        materials.value.delete(id);\r\n        if (props.debug) {\r\n          console.log(`[ResourceManager] Unregistered material: ${id}`);\r\n        }\r\n      }\r\n    };\r\n\r\n    // \u83B7\u53D6\u6750\u8D28\r\n    const getMaterial = (id) => {\r\n      const materialEntry = materials.value.get(id);\r\n      if (materialEntry) {\r\n        materialEntry.lastUsed = Date.now();\r\n        return materialEntry.resource;\r\n      }\r\n      return undefined;\r\n    };\r\n\r\n    // \u6CE8\u518C\u51E0\u4F55\u4F53\r\n    const registerGeometry = (id, geometry) => {\r\n      geometries.value.set(id, { resource: geometry, lastUsed: Date.now() });\r\n      if (props.debug) {\r\n        console.log(`[ResourceManager] Registered geometry: ${id}`);\r\n      }\r\n    };\r\n\r\n    // \u6CE8\u9500\u51E0\u4F55\u4F53\r\n    const unregisterGeometry = (id) => {\r\n      const geometryEntry = geometries.value.get(id);\r\n      if (geometryEntry) {\r\n        geometryEntry.resource.dispose();\r\n        geometries.value.delete(id);\r\n        if (props.debug) {\r\n          console.log(`[ResourceManager] Unregistered geometry: ${id}`);\r\n        }\r\n      }\r\n    };\r\n\r\n    // \u83B7\u53D6\u51E0\u4F55\u4F53\r\n    const getGeometry = (id) => {\r\n      const geometryEntry = geometries.value.get(id);\r\n      if (geometryEntry) {\r\n        geometryEntry.lastUsed = Date.now();\r\n        return geometryEntry.resource;\r\n      }\r\n      return undefined;\r\n    };\r\n\r\n    // \u6CE8\u518C\u5BF9\u8C61\r\n    const registerObject = (id, object) => {\r\n      objects.value.set(id, { resource: object, lastUsed: Date.now() });\r\n      if (props.debug) {\r\n        console.log(`[ResourceManager] Registered object: ${id}`);\r\n      }\r\n    };\r\n\r\n    // \u6CE8\u9500\u5BF9\u8C61\r\n    const unregisterObject = (id) => {\r\n      const objectEntry = objects.value.get(id);\r\n      if (objectEntry) {\r\n        disposeObject(objectEntry.resource);\r\n        objects.value.delete(id);\r\n        if (props.debug) {\r\n          console.log(`[ResourceManager] Unregistered object: ${id}`);\r\n        }\r\n      }\r\n    };\r\n\r\n    // \u83B7\u53D6\u5BF9\u8C61\r\n    const getObject = (id) => {\r\n      const objectEntry = objects.value.get(id);\r\n      if (objectEntry) {\r\n        objectEntry.lastUsed = Date.now();\r\n        return objectEntry.resource;\r\n      }\r\n      return undefined;\r\n    };\r\n\r\n    // \u5904\u7406\u672A\u4F7F\u7528\u7684\u8D44\u6E90\r\n    const disposeUnused = (maxAge = 60000) => { // \u9ED8\u8BA460\u79D2\u672A\u4F7F\u7528\u5219\u91CA\u653E\r\n      const now = Date.now();\r\n      \r\n      // \u5904\u7406\u7EB9\u7406\r\n      textures.value.forEach((entry, id) => {\r\n        if (now - entry.lastUsed > maxAge) {\r\n          unregisterTexture(id);\r\n        }\r\n      });\r\n      \r\n      // \u5904\u7406\u6750\u8D28\r\n      materials.value.forEach((entry, id) => {\r\n        if (now - entry.lastUsed > maxAge) {\r\n          unregisterMaterial(id);\r\n        }\r\n      });\r\n      \r\n      // \u5904\u7406\u51E0\u4F55\u4F53\r\n      geometries.value.forEach((entry, id) => {\r\n        if (now - entry.lastUsed > maxAge) {\r\n          unregisterGeometry(id);\r\n        }\r\n      });\r\n      \r\n      // \u5904\u7406\u5BF9\u8C61\r\n      objects.value.forEach((entry, id) => {\r\n        if (now - entry.lastUsed > maxAge) {\r\n          unregisterObject(id);\r\n        }\r\n      });\r\n      \r\n      if (props.debug) {\r\n        console.log(`[ResourceManager] Disposed unused resources. Remaining: textures=${textures.value.size}, materials=${materials.value.size}, geometries=${geometries.value.size}, objects=${objects.value.size}`);\r\n      }\r\n    };\r\n\r\n    // \u91CA\u653E\u6240\u6709\u8D44\u6E90\r\n    const disposeAll = () => {\r\n      // \u5904\u7406\u7EB9\u7406\r\n      textures.value.forEach((entry, id) => {\r\n        unregisterTexture(id);\r\n      });\r\n      \r\n      // \u5904\u7406\u6750\u8D28\r\n      materials.value.forEach((entry, id) => {\r\n        unregisterMaterial(id);\r\n      });\r\n      \r\n      // \u5904\u7406\u51E0\u4F55\u4F53\r\n      geometries.value.forEach((entry, id) => {\r\n        unregisterGeometry(id);\r\n      });\r\n      \r\n      // \u5904\u7406\u5BF9\u8C61\r\n      objects.value.forEach((entry, id) => {\r\n        unregisterObject(id);\r\n      });\r\n      \r\n      if (props.debug) {\r\n        console.log('[ResourceManager] Disposed all resources');\r\n      }\r\n    };\r\n\r\n    // \u81EA\u52A8\u5904\u7406\u672A\u4F7F\u7528\u7684\u8D44\u6E90\r\n    let disposeInterval = null;\r\n\r\n    // \u7EC4\u4EF6\u6302\u8F7D\u548C\u5378\u8F7D\r\n    onMounted(() => {\r\n      if (props.autoDispose && props.disposeInterval) {\r\n        disposeInterval = window.setInterval(() => {\r\n          disposeUnused();\r\n        }, props.disposeInterval);\r\n      }\r\n      \r\n      // \u63D0\u4F9B\u8D44\u6E90\u7BA1\u7406\u5668\u7ED9\u5B50\u7EC4\u4EF6\r\n      provide(RESOURCE_MANAGER_INJECTION_KEY, {\r\n        registerTexture,\r\n        unregisterTexture,\r\n        getTexture,\r\n        registerMaterial,\r\n        unregisterMaterial,\r\n        getMaterial,\r\n        registerGeometry,\r\n        unregisterGeometry,\r\n        getGeometry,\r\n        registerObject,\r\n        unregisterObject,\r\n        getObject,\r\n        disposeUnused,\r\n        disposeAll\r\n      });\r\n    });\r\n\r\n    onBeforeUnmount(() => {\r\n      // \u6E05\u7406\u5B9A\u65F6\u5668\r\n      if (disposeInterval !== null) {\r\n        clearInterval(disposeInterval);\r\n      }\r\n      \r\n      // \u91CA\u653E\u6240\u6709\u8D44\u6E90\r\n      disposeAll();\r\n    });\r\n\r\n    return {\r\n      textures,\r\n      materials,\r\n      geometries,\r\n      objects,\r\n      registerTexture,\r\n      unregisterTexture,\r\n      getTexture,\r\n      registerMaterial,\r\n      unregisterMaterial,\r\n      getMaterial,\r\n      registerGeometry,\r\n      unregisterGeometry,\r\n      getGeometry,\r\n      registerObject,\r\n      unregisterObject,\r\n      getObject,\r\n      disposeUnused,\r\n      disposeAll\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<template>\r\n  <div class=\"three-resource-manager\">\r\n    <slot \r\n      :textures=\"textures\"\r\n      :materials=\"materials\"\r\n      :geometries=\"geometries\"\r\n      :objects=\"objects\"\r\n      :register-texture=\"registerTexture\"\r\n      :unregister-texture=\"unregisterTexture\"\r\n      :get-texture=\"getTexture\"\r\n      :register-material=\"registerMaterial\"\r\n      :unregister-material=\"unregisterMaterial\"\r\n      :get-material=\"getMaterial\"\r\n      :register-geometry=\"registerGeometry\"\r\n      :unregister-geometry=\"unregisterGeometry\"\r\n      :get-geometry=\"getGeometry\"\r\n      :register-object=\"registerObject\"\r\n      :unregister-object=\"unregisterObject\"\r\n      :get-object=\"getObject\"\r\n      :dispose-unused=\"disposeUnused\"\r\n      :dispose-all=\"disposeAll\"\r\n    ></slot>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n.three-resource-manager {\r\n  display: contents;\r\n}\r\n</style> ", "<script setup lang=\"ts\">\r\nimport { ref, onMounted, onBeforeUnmount, watch } from 'vue';\r\nimport { WebGLRenderer as WebGPURenderer, Scene, Camera } from 'three'; // \u4E34\u65F6\u4F7F\u7528WebGLRenderer\u4EE3\u66FFWebGPURenderer\r\nimport { useThree } from '../../composables/useThree';\r\nimport { useFrame } from '../../composables/useFrame';\r\nimport { isWebGPUSupported } from '../../utils';\r\n\r\nconst props = defineProps<{\r\n  enabled?: boolean;\r\n  antialias?: boolean;\r\n  alpha?: boolean;\r\n  clearColor?: number | string;\r\n  clearAlpha?: number;\r\n  pixelRatio?: number;\r\n  width?: number | string;\r\n  height?: number | string;\r\n  shadowMap?: boolean;\r\n  toneMapping?: number;\r\n  toneMappingExposure?: number;\r\n  outputEncoding?: number;\r\n  autoClear?: boolean;\r\n  autoClearDepth?: boolean;\r\n  autoClearColor?: boolean;\r\n  autoClearStencil?: boolean;\r\n  powerPreference?: 'high-performance' | 'low-power' | 'default';\r\n}>();\r\n\r\nconst emit = defineEmits(['initialized', 'rendered', 'error']);\r\n\r\n// \u83B7\u53D6Three.js\u6838\u5FC3\u5BF9\u8C61\r\nconst { scene, camera } = useThree();\r\n\r\n// WebGPU\u6E32\u67D3\u5668\r\nconst renderer = ref<WebGPURenderer | null>(null);\r\nconst container = ref<HTMLDivElement | null>(null);\r\nconst isSupported = ref<boolean>(false);\r\nconst isInitialized = ref<boolean>(false);\r\nconst isEnabled = ref<boolean>(props.enabled !== false);\r\n\r\n// \u521B\u5EFAWebGPU\u6E32\u67D3\u5668\r\nconst createRenderer = async () => {\r\n  if (!container.value) return;\r\n  \r\n  try {\r\n    // \u68C0\u67E5WebGPU\u652F\u6301\r\n    isSupported.value = await isWebGPUSupported();\r\n    \r\n    if (!isSupported.value) {\r\n      throw new Error('WebGPU is not supported in this browser');\r\n    }\r\n    \r\n    // \u521B\u5EFA\u6E32\u67D3\u5668 - \u4E34\u65F6\u4F7F\u7528WebGLRenderer\r\n    renderer.value = new WebGPURenderer({\r\n      antialias: props.antialias !== false,\r\n      alpha: props.alpha || false,\r\n      powerPreference: props.powerPreference || 'high-performance'\r\n    });\r\n    \r\n    // \u8BBE\u7F6E\u5927\u5C0F\r\n    const width = typeof props.width === 'number' ? props.width : container.value.clientWidth;\r\n    const height = typeof props.height === 'number' ? props.height : container.value.clientHeight;\r\n    renderer.value.setSize(width, height);\r\n    \r\n    // \u8BBE\u7F6E\u50CF\u7D20\u6BD4\r\n    renderer.value.setPixelRatio(props.pixelRatio || window.devicePixelRatio);\r\n    \r\n    // \u8BBE\u7F6E\u6E05\u9664\u989C\u8272\r\n    if (props.clearColor !== undefined) {\r\n      renderer.value.setClearColor(props.clearColor, props.clearAlpha || 1);\r\n    }\r\n    \r\n    // \u8BBE\u7F6E\u8272\u8C03\u6620\u5C04\r\n    if (props.toneMapping !== undefined) {\r\n      renderer.value.toneMapping = props.toneMapping;\r\n    }\r\n    \r\n    // \u8BBE\u7F6E\u8272\u8C03\u6620\u5C04\u66DD\u5149\r\n    if (props.toneMappingExposure !== undefined) {\r\n      renderer.value.toneMappingExposure = props.toneMappingExposure;\r\n    }\r\n    \r\n    // \u8BBE\u7F6E\u8F93\u51FA\u7F16\u7801\r\n    if (props.outputEncoding !== undefined) {\r\n      renderer.value.outputEncoding = props.outputEncoding;\r\n    }\r\n    \r\n    // \u8BBE\u7F6E\u9634\u5F71\u8D34\u56FE\r\n    if (props.shadowMap) {\r\n      renderer.value.shadowMap.enabled = true;\r\n    }\r\n    \r\n    // \u6DFB\u52A0\u5230\u5BB9\u5668\r\n    container.value.appendChild(renderer.value.domElement);\r\n    \r\n    // \u6807\u8BB0\u4E3A\u5DF2\u521D\u59CB\u5316\r\n    isInitialized.value = true;\r\n    \r\n    // \u89E6\u53D1\u521D\u59CB\u5316\u4E8B\u4EF6\r\n    emit('initialized', renderer.value);\r\n    \r\n    // \u63D0\u4F9B\u6E32\u67D3\u5668\u7ED9Three.js\u4E0A\u4E0B\u6587\r\n    const three = useThree();\r\n    if (three && typeof three.renderer === 'object') {\r\n      (three as any).renderer = renderer.value;\r\n    }\r\n  } catch (error) {\r\n    console.error('Failed to initialize WebGPU renderer:', error);\r\n    emit('error', error as Error);\r\n  }\r\n};\r\n\r\n// \u6E32\u67D3\u573A\u666F\r\nconst render = () => {\r\n  if (!renderer.value || !scene.value || !camera.value || !isEnabled.value || !isInitialized.value) return;\r\n  \r\n  // \u6E32\u67D3\u524D\u8BBE\u7F6E\u81EA\u52A8\u6E05\u9664\u9009\u9879\r\n  if (props.autoClear !== undefined) {\r\n    renderer.value.autoClear = props.autoClear;\r\n  }\r\n  if (props.autoClearDepth !== undefined) {\r\n    renderer.value.autoClearDepth = props.autoClearDepth;\r\n  }\r\n  if (props.autoClearColor !== undefined) {\r\n    renderer.value.autoClearColor = props.autoClearColor;\r\n  }\r\n  if (props.autoClearStencil !== undefined) {\r\n    renderer.value.autoClearStencil = props.autoClearStencil;\r\n  }\r\n  \r\n  // \u6E32\u67D3\u573A\u666F\r\n  renderer.value.render(scene.value, camera.value);\r\n  \r\n  // \u89E6\u53D1\u6E32\u67D3\u4E8B\u4EF6\r\n  emit('rendered', renderer.value);\r\n};\r\n\r\n// \u8C03\u6574\u5927\u5C0F\r\nconst resize = () => {\r\n  if (!renderer.value || !container.value) return;\r\n  \r\n  const width = typeof props.width === 'number' ? props.width : container.value.clientWidth;\r\n  const height = typeof props.height === 'number' ? props.height : container.value.clientHeight;\r\n  \r\n  renderer.value.setSize(width, height);\r\n};\r\n\r\n// \u542F\u7528/\u7981\u7528\u6E32\u67D3\r\nconst setEnabled = (enabled: boolean) => {\r\n  isEnabled.value = enabled;\r\n};\r\n\r\n// \u76D1\u542C\u5C5E\u6027\u53D8\u5316\r\nwatch(() => props.enabled, (enabled) => {\r\n  setEnabled(enabled !== false);\r\n});\r\n\r\nwatch(() => props.clearColor, (color) => {\r\n  if (renderer.value && color !== undefined) {\r\n    renderer.value.setClearColor(color, props.clearAlpha || 1);\r\n  }\r\n});\r\n\r\nwatch(() => props.pixelRatio, (ratio) => {\r\n  if (renderer.value && ratio !== undefined) {\r\n    renderer.value.setPixelRatio(ratio);\r\n  }\r\n});\r\n\r\nwatch(() => [props.width, props.height], () => {\r\n  resize();\r\n});\r\n\r\nwatch(() => props.shadowMap, (enabled) => {\r\n  if (renderer.value) {\r\n    renderer.value.shadowMap.enabled = enabled || false;\r\n    renderer.value.shadowMap.needsUpdate = true;\r\n  }\r\n});\r\n\r\n// \u76D1\u542C\u7A97\u53E3\u5927\u5C0F\u53D8\u5316\r\nconst handleResize = () => {\r\n  if (typeof props.width !== 'number' || typeof props.height !== 'number') {\r\n    resize();\r\n  }\r\n};\r\n\r\n// \u7EC4\u4EF6\u6302\u8F7D\u548C\u5378\u8F7D\r\nonMounted(async () => {\r\n  // \u521B\u5EFA\u6E32\u67D3\u5668\r\n  await createRenderer();\r\n  \r\n  // \u6DFB\u52A0\u5E27\u66F4\u65B0\r\n  useFrame(render);\r\n  \r\n  // \u6DFB\u52A0\u7A97\u53E3\u5927\u5C0F\u53D8\u5316\u76D1\u542C\r\n  window.addEventListener('resize', handleResize);\r\n});\r\n\r\nonBeforeUnmount(() => {\r\n  // \u79FB\u9664\u7A97\u53E3\u5927\u5C0F\u53D8\u5316\u76D1\u542C\r\n  window.removeEventListener('resize', handleResize);\r\n  \r\n  // \u6E05\u7406\u6E32\u67D3\u5668\r\n  if (renderer.value) {\r\n    renderer.value.dispose();\r\n    \r\n    // \u4ECE\u5BB9\u5668\u4E2D\u79FB\u9664\r\n    if (container.value && renderer.value.domElement.parentNode === container.value) {\r\n      container.value.removeChild(renderer.value.domElement);\r\n    }\r\n  }\r\n});\r\n\r\n// \u66B4\u9732\u7EC4\u4EF6\u5185\u90E8\u72B6\u6001\u548C\u65B9\u6CD5\r\ndefineExpose({\r\n  renderer,\r\n  container,\r\n  isSupported,\r\n  isInitialized,\r\n  isEnabled,\r\n  render,\r\n  resize,\r\n  setEnabled\r\n});\r\n</script>\r\n\r\n<template>\r\n  <div \r\n    ref=\"container\"\r\n    class=\"three-webgpu-renderer\"\r\n    :style=\"{\r\n      width: typeof width === 'number' ? `${width}px` : width || '100%',\r\n      height: typeof height === 'number' ? `${height}px` : height || '100%'\r\n    }\"\r\n  >\r\n    <div v-if=\"!isSupported\" class=\"webgpu-not-supported\">\r\n      <slot name=\"not-supported\">\r\n        <p>WebGPU is not supported in this browser.</p>\r\n      </slot>\r\n    </div>\r\n    <slot \r\n      :renderer=\"renderer\" \r\n      :is-supported=\"isSupported\"\r\n      :is-initialized=\"isInitialized\"\r\n      :is-enabled=\"isEnabled\"\r\n    ></slot>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n.three-webgpu-renderer {\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n\r\n.webgpu-not-supported {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  background-color: rgba(0, 0, 0, 0.7);\r\n  color: white;\r\n  font-size: 16px;\r\n  text-align: center;\r\n  padding: 20px;\r\n}\r\n</style> ", "<script>\r\nimport { ref, onMounted, onBeforeUnmount, provide, watch, InjectionKey } from 'vue';\r\nimport { World, Vec3, Body, Shape, NaiveBroadphase, SAPBroadphase, GridBroadphase } from 'cannon-es';\r\nimport { useFrame } from '../../composables/useFrame';\r\nimport { PhysicsWorldOptions } from '../../types';\r\n\r\n// \u7269\u7406\u4E16\u754C\u6CE8\u5165\u952E\r\nconst PHYSICS_WORLD_INJECTION_KEY = Symbol('physics-world');\r\n\r\nexport { PHYSICS_WORLD_INJECTION_KEY };\r\n\r\nexport default {\r\n  props: {\r\n    gravity: {\r\n      type: Array,\r\n      default: () => [0, -9.82, 0]\r\n    },\r\n    iterations: {\r\n      type: Number,\r\n      default: 10\r\n    },\r\n    tolerance: {\r\n      type: Number,\r\n      default: 0.001\r\n    },\r\n    broadphase: {\r\n      type: String,\r\n      default: 'naive',\r\n      validator: (value) => ['naive', 'sap', 'grid'].includes(value)\r\n    },\r\n    allowSleep: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    axisIndex: {\r\n      type: Number,\r\n      default: 1\r\n    },\r\n    defaultContactMaterial: {\r\n      type: Object,\r\n      default: () => ({\r\n        friction: 0.3,\r\n        restitution: 0.3,\r\n        contactEquationStiffness: 1e7,\r\n        contactEquationRelaxation: 3,\r\n        frictionEquationStiffness: 1e7,\r\n        frictionEquationRelaxation: 3\r\n      })\r\n    },\r\n    debug: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  emits: [\r\n    'init',\r\n    'step',\r\n    'collide'\r\n  ],\r\n  setup(props, { emit }) {\r\n    // \u521B\u5EFA\u7269\u7406\u4E16\u754C\r\n    const world = ref(new World());\r\n    \r\n    // \u521D\u59CB\u5316\u7269\u7406\u4E16\u754C\r\n    const initWorld = () => {\r\n      // \u8BBE\u7F6E\u91CD\u529B\r\n      world.value.gravity.set(\r\n        props.gravity[0],\r\n        props.gravity[1],\r\n        props.gravity[2]\r\n      );\r\n      \r\n      // \u8BBE\u7F6E\u6C42\u89E3\u5668\u53C2\u6570\r\n      world.value.solver.iterations = props.iterations;\r\n      world.value.solver.tolerance = props.tolerance;\r\n      \r\n      // \u8BBE\u7F6E\u78B0\u649E\u68C0\u6D4B\u7B97\u6CD5\r\n      if (props.broadphase === 'naive') {\r\n        world.value.broadphase = new NaiveBroadphase();\r\n      } else if (props.broadphase === 'sap') {\r\n        world.value.broadphase = new SAPBroadphase(world.value);\r\n      } else if (props.broadphase === 'grid') {\r\n        world.value.broadphase = new GridBroadphase();\r\n      }\r\n      \r\n      // \u8BBE\u7F6E\u662F\u5426\u5141\u8BB8\u4F11\u7720\r\n      world.value.allowSleep = props.allowSleep;\r\n      \r\n      // \u8BBE\u7F6E\u9ED8\u8BA4\u63A5\u89E6\u6750\u8D28\r\n      world.value.defaultContactMaterial.friction = props.defaultContactMaterial.friction;\r\n      world.value.defaultContactMaterial.restitution = props.defaultContactMaterial.restitution;\r\n      \r\n      if (props.defaultContactMaterial.contactEquationStiffness) {\r\n        world.value.defaultContactMaterial.contactEquationStiffness = props.defaultContactMaterial.contactEquationStiffness;\r\n      }\r\n      \r\n      if (props.defaultContactMaterial.contactEquationRelaxation) {\r\n        world.value.defaultContactMaterial.contactEquationRelaxation = props.defaultContactMaterial.contactEquationRelaxation;\r\n      }\r\n      \r\n      if (props.defaultContactMaterial.frictionEquationStiffness) {\r\n        world.value.defaultContactMaterial.frictionEquationStiffness = props.defaultContactMaterial.frictionEquationStiffness;\r\n      }\r\n      \r\n      if (props.defaultContactMaterial.frictionEquationRelaxation) {\r\n        world.value.defaultContactMaterial.frictionEquationRelaxation = props.defaultContactMaterial.frictionEquationRelaxation;\r\n      }\r\n      \r\n      // \u6DFB\u52A0\u78B0\u649E\u4E8B\u4EF6\u76D1\u542C\r\n      world.value.addEventListener('collide', (event) => {\r\n        emit('collide', event);\r\n      });\r\n      \r\n      // \u89E6\u53D1\u521D\u59CB\u5316\u4E8B\u4EF6\r\n      emit('init', { world: world.value });\r\n      \r\n      if (props.debug) {\r\n        console.log('[PhysicsWorld] Initialized with:', {\r\n          gravity: props.gravity,\r\n          iterations: props.iterations,\r\n          tolerance: props.tolerance,\r\n          broadphase: props.broadphase,\r\n          allowSleep: props.allowSleep\r\n        });\r\n      }\r\n    };\r\n    \r\n    // \u66F4\u65B0\u7269\u7406\u4E16\u754C\r\n    const fixedTimeStep = 1 / 60;\r\n    const maxSubSteps = 10;\r\n    let lastTime = 0;\r\n    \r\n    const step = (time) => {\r\n      if (!world.value) return;\r\n      \r\n      const deltaTime = lastTime ? (time - lastTime) / 1000 : 0;\r\n      lastTime = time;\r\n      \r\n      // \u66F4\u65B0\u7269\u7406\u4E16\u754C\r\n      world.value.step(fixedTimeStep, deltaTime, maxSubSteps);\r\n      \r\n      // \u89E6\u53D1\u6B65\u8FDB\u4E8B\u4EF6\r\n      emit('step', {\r\n        time,\r\n        deltaTime,\r\n        bodies: world.value.bodies\r\n      });\r\n    };\r\n    \r\n    // \u6E05\u7406\u7269\u7406\u4E16\u754C\r\n    const clearWorld = () => {\r\n      if (!world.value) return;\r\n      \r\n      // \u79FB\u9664\u6240\u6709\u7269\u4F53\r\n      while (world.value.bodies.length > 0) {\r\n        world.value.removeBody(world.value.bodies[0]);\r\n      }\r\n      \r\n      if (props.debug) {\r\n        console.log('[PhysicsWorld] Cleared all bodies');\r\n      }\r\n    };\r\n    \r\n    // \u6DFB\u52A0\u7269\u4F53\r\n    const addBody = (body) => {\r\n      if (!world.value || !body) return;\r\n      \r\n      world.value.addBody(body);\r\n      \r\n      if (props.debug) {\r\n        console.log('[PhysicsWorld] Added body:', body);\r\n      }\r\n    };\r\n    \r\n    // \u79FB\u9664\u7269\u4F53\r\n    const removeBody = (body) => {\r\n      if (!world.value || !body) return;\r\n      \r\n      world.value.removeBody(body);\r\n      \r\n      if (props.debug) {\r\n        console.log('[PhysicsWorld] Removed body:', body);\r\n      }\r\n    };\r\n    \r\n    // \u76D1\u542C\u5C5E\u6027\u53D8\u5316\r\n    watch(() => props.iterations, (newIterations) => {\r\n      if (world.value && newIterations) {\r\n        world.value.solver.iterations = newIterations;\r\n      }\r\n    });\r\n    \r\n    watch(() => props.tolerance, (newTolerance) => {\r\n      if (world.value && newTolerance) {\r\n        world.value.solver.tolerance = newTolerance;\r\n      }\r\n    });\r\n    \r\n    watch(() => props.gravity, (newGravity) => {\r\n      if (world.value && newGravity) {\r\n        world.value.gravity.set(\r\n          newGravity[0],\r\n          newGravity[1],\r\n          newGravity[2]\r\n        );\r\n      }\r\n    }, { deep: true });\r\n    \r\n    watch(() => props.allowSleep, (newAllowSleep) => {\r\n      if (world.value) {\r\n        world.value.allowSleep = newAllowSleep;\r\n      }\r\n    });\r\n    \r\n    // \u7EC4\u4EF6\u6302\u8F7D\u548C\u5378\u8F7D\r\n    onMounted(() => {\r\n      // \u521D\u59CB\u5316\u7269\u7406\u4E16\u754C\r\n      initWorld();\r\n      \r\n      // \u6DFB\u52A0\u5E27\u66F4\u65B0\r\n      useFrame(step);\r\n      \r\n      // \u63D0\u4F9B\u7269\u7406\u4E16\u754C\u4E0A\u4E0B\u6587\r\n      provide(PHYSICS_WORLD_INJECTION_KEY, {\r\n        world: world.value,\r\n        addBody,\r\n        removeBody\r\n      });\r\n    });\r\n    \r\n    onBeforeUnmount(() => {\r\n      // \u6E05\u7406\u7269\u7406\u4E16\u754C\r\n      clearWorld();\r\n      \r\n      // \u6E05\u7406\u5F15\u7528\r\n      world.value = null;\r\n      lastTime = 0;\r\n    });\r\n    \r\n    return {\r\n      world,\r\n      addBody,\r\n      removeBody,\r\n      step,\r\n      clearWorld\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<template>\r\n  <div class=\"three-physics-world\">\r\n    <slot \r\n      :world=\"world\"\r\n      :add-body=\"addBody\"\r\n      :remove-body=\"removeBody\"\r\n    ></slot>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n.three-physics-world {\r\n  display: contents;\r\n}\r\n</style> ", "<script setup lang=\"ts\">\r\nimport { ref, onMounted, onBeforeUnmount, inject, watch } from 'vue';\r\nimport { Body, Vec3, Quaternion, Box, Sphere, Cylinder, Plane } from 'cannon-es';\r\nimport { Object3D, Box3, Vector3, Quaternion as ThreeQuaternion } from 'three';\r\nimport { injectThreeParent } from '../../composables/useThreeParent';\r\nimport { PHYSICS_WORLD_INJECTION_KEY } from './ThreePhysicsWorld.vue';\r\nimport { useFrame } from '../../composables/useFrame';\r\nimport { arrayToVector3, arrayToQuaternion, computeBoundingBox } from '../../utils';\r\nimport { RigidBodyOptions, BodyType, Vector3Tuple } from '../../types';\r\n\r\nconst props = defineProps<{\r\n  type?: BodyType;\r\n  mass?: number;\r\n  position?: Vector3Tuple;\r\n  rotation?: Vector3Tuple;\r\n  linearDamping?: number;\r\n  angularDamping?: number;\r\n  linearFactor?: Vector3Tuple;\r\n  angularFactor?: Vector3Tuple;\r\n  fixedRotation?: boolean;\r\n  allowSleep?: boolean;\r\n  sleepSpeedLimit?: number;\r\n  sleepTimeLimit?: number;\r\n  collisionFilterGroup?: number;\r\n  collisionFilterMask?: number;\r\n  shape?: 'auto' | 'box' | 'sphere' | 'cylinder' | 'plane';\r\n  shapeOptions?: Record<string, any>;\r\n  autoFit?: boolean;\r\n  offset?: Vector3Tuple;\r\n}>();\r\n\r\nconst emit = defineEmits<{\r\n  collide: [event: { body: Body; contact: any }];\r\n  sleep: [event: { body: Body }];\r\n  wakeup: [event: { body: Body }];\r\n}>();\r\n\r\n// \u83B7\u53D6\u7236\u5BF9\u8C61\u548C\u7269\u7406\u4E16\u754C\r\nconst parent = injectThreeParent();\r\nconst physicsWorld = inject(PHYSICS_WORLD_INJECTION_KEY);\r\n\r\n// \u521A\u4F53\r\nconst body = ref<Body | null>(null);\r\nconst isSleeping = ref<boolean>(false);\r\n\r\n// \u521B\u5EFA\u521A\u4F53\r\nconst createRigidBody = () => {\r\n  if (!parent.value) return;\r\n  \r\n  // \u521B\u5EFA\u5F62\u72B6\r\n  const shape = createShape();\r\n  if (!shape) return;\r\n  \r\n  // \u521B\u5EFA\u521A\u4F53\r\n  const bodyOptions = {\r\n    mass: props.type === 'static' ? 0 : (props.mass || 1),\r\n    type: props.type || 'dynamic',\r\n    position: new Vec3(),\r\n    quaternion: new Quaternion(),\r\n    linearDamping: props.linearDamping || 0.01,\r\n    angularDamping: props.angularDamping || 0.01,\r\n    fixedRotation: props.fixedRotation || false,\r\n    allowSleep: props.allowSleep || false,\r\n    sleepSpeedLimit: props.sleepSpeedLimit || 0.1,\r\n    sleepTimeLimit: props.sleepTimeLimit || 1,\r\n    collisionFilterGroup: props.collisionFilterGroup || 1,\r\n    collisionFilterMask: props.collisionFilterMask || -1,\r\n    material: undefined\r\n  };\r\n  \r\n  // \u521B\u5EFA\u521A\u4F53\r\n  body.value = new Body(bodyOptions);\r\n  \r\n  // \u6DFB\u52A0\u5F62\u72B6\r\n  const offset = props.offset ? new Vec3(props.offset[0], props.offset[1], props.offset[2]) : new Vec3();\r\n  body.value.addShape(shape, offset);\r\n  \r\n  // \u8BBE\u7F6E\u7EBF\u6027\u548C\u89D2\u56E0\u5B50\r\n  if (props.linearFactor) {\r\n    body.value.linearFactor.set(\r\n      props.linearFactor[0],\r\n      props.linearFactor[1],\r\n      props.linearFactor[2]\r\n    );\r\n  }\r\n  \r\n  if (props.angularFactor) {\r\n    body.value.angularFactor.set(\r\n      props.angularFactor[0],\r\n      props.angularFactor[1],\r\n      props.angularFactor[2]\r\n    );\r\n  }\r\n  \r\n  // \u8BBE\u7F6E\u4F4D\u7F6E\u548C\u65CB\u8F6C\r\n  updateBodyTransform();\r\n  \r\n  // \u6DFB\u52A0\u4E8B\u4EF6\u76D1\u542C\r\n  body.value.addEventListener('collide', handleCollide);\r\n  body.value.addEventListener('sleep', handleSleep);\r\n  body.value.addEventListener('wakeup', handleWakeup);\r\n  \r\n  // \u6DFB\u52A0\u5230\u7269\u7406\u4E16\u754C\r\n  if (physicsWorld) {\r\n    physicsWorld.addBody(body.value);\r\n  }\r\n};\r\n\r\n// \u521B\u5EFA\u5F62\u72B6\r\nconst createShape = () => {\r\n  if (!parent.value) return null;\r\n  \r\n  // \u5982\u679C\u6307\u5B9A\u4E86\u5F62\u72B6\u7C7B\u578B\r\n  if (props.shape && props.shape !== 'auto') {\r\n    return createSpecificShape(props.shape);\r\n  }\r\n  \r\n  // \u81EA\u52A8\u521B\u5EFA\u5F62\u72B6\r\n  if (props.autoFit !== false) {\r\n    // \u8BA1\u7B97\u5305\u56F4\u76D2\r\n    const box = computeBoundingBox(parent.value);\r\n    const size = new Vector3();\r\n    box.getSize(size);\r\n    \r\n    // \u521B\u5EFA\u76D2\u4F53\u5F62\u72B6\r\n    return new Box(new Vec3(size.x / 2, size.y / 2, size.z / 2));\r\n  }\r\n  \r\n  // \u9ED8\u8BA4\u521B\u5EFA\u76D2\u4F53\u5F62\u72B6\r\n  return new Box(new Vec3(0.5, 0.5, 0.5));\r\n};\r\n\r\n// \u521B\u5EFA\u7279\u5B9A\u5F62\u72B6\r\nconst createSpecificShape = (shapeType: string) => {\r\n  const options = props.shapeOptions || {};\r\n  \r\n  switch (shapeType) {\r\n    case 'box':\r\n      const halfExtents = options.halfExtents || [0.5, 0.5, 0.5];\r\n      return new Box(new Vec3(halfExtents[0], halfExtents[1], halfExtents[2]));\r\n    \r\n    case 'sphere':\r\n      const radius = options.radius || 0.5;\r\n      return new Sphere(radius);\r\n    \r\n    case 'cylinder':\r\n      const radiusTop = options.radiusTop || 0.5;\r\n      const radiusBottom = options.radiusBottom || 0.5;\r\n      const height = options.height || 1;\r\n      const numSegments = options.numSegments || 8;\r\n      return new Cylinder(radiusTop, radiusBottom, height, numSegments);\r\n    \r\n    case 'plane':\r\n      return new Plane();\r\n    \r\n    default:\r\n      return new Box(new Vec3(0.5, 0.5, 0.5));\r\n  }\r\n};\r\n\r\n// \u66F4\u65B0\u521A\u4F53\u53D8\u6362\r\nconst updateBodyTransform = () => {\r\n  if (!body.value || !parent.value) return;\r\n  \r\n  // \u83B7\u53D6\u4F4D\u7F6E\r\n  const position = props.position \r\n    ? new Vec3(props.position[0], props.position[1], props.position[2])\r\n    : new Vec3(parent.value.position.x, parent.value.position.y, parent.value.position.z);\r\n  \r\n  // \u83B7\u53D6\u65CB\u8F6C\r\n  let quaternion;\r\n  if (props.rotation) {\r\n    const euler = arrayToVector3(props.rotation);\r\n    quaternion = new Quaternion();\r\n    quaternion.setFromEuler(euler.x, euler.y, euler.z, 'XYZ');\r\n  } else {\r\n    const threeQuat = new ThreeQuaternion();\r\n    parent.value.getWorldQuaternion(threeQuat);\r\n    quaternion = new Quaternion(threeQuat.x, threeQuat.y, threeQuat.z, threeQuat.w);\r\n  }\r\n  \r\n  // \u8BBE\u7F6E\u4F4D\u7F6E\u548C\u65CB\u8F6C\r\n  body.value.position.copy(position);\r\n  body.value.quaternion.copy(quaternion);\r\n};\r\n\r\n// \u66F4\u65B0\u5BF9\u8C61\u53D8\u6362\r\nconst updateObjectTransform = () => {\r\n  if (!body.value || !parent.value) return;\r\n  \r\n  // \u66F4\u65B0\u4F4D\u7F6E\r\n  parent.value.position.set(\r\n    body.value.position.x,\r\n    body.value.position.y,\r\n    body.value.position.z\r\n  );\r\n  \r\n  // \u66F4\u65B0\u65CB\u8F6C\r\n  parent.value.quaternion.set(\r\n    body.value.quaternion.x,\r\n    body.value.quaternion.y,\r\n    body.value.quaternion.z,\r\n    body.value.quaternion.w\r\n  );\r\n};\r\n\r\n// \u5E94\u7528\u529B\r\nconst applyForce = (force: Vector3Tuple, worldPoint?: Vector3Tuple) => {\r\n  if (!body.value) return;\r\n  \r\n  const forceVec = new Vec3(force[0], force[1], force[2]);\r\n  \r\n  if (worldPoint) {\r\n    const pointVec = new Vec3(worldPoint[0], worldPoint[1], worldPoint[2]);\r\n    body.value.applyForce(forceVec, pointVec);\r\n  } else {\r\n    body.value.applyForce(forceVec, body.value.position);\r\n  }\r\n};\r\n\r\n// \u5E94\u7528\u51B2\u91CF\r\nconst applyImpulse = (impulse: Vector3Tuple, worldPoint?: Vector3Tuple) => {\r\n  if (!body.value) return;\r\n  \r\n  const impulseVec = new Vec3(impulse[0], impulse[1], impulse[2]);\r\n  \r\n  if (worldPoint) {\r\n    const pointVec = new Vec3(worldPoint[0], worldPoint[1], worldPoint[2]);\r\n    body.value.applyImpulse(impulseVec, pointVec);\r\n  } else {\r\n    body.value.applyImpulse(impulseVec, body.value.position);\r\n  }\r\n};\r\n\r\n// \u5E94\u7528\u5C40\u90E8\u529B\r\nconst applyLocalForce = (force: Vector3Tuple, localPoint?: Vector3Tuple) => {\r\n  if (!body.value) return;\r\n  \r\n  const forceVec = new Vec3(force[0], force[1], force[2]);\r\n  \r\n  if (localPoint) {\r\n    const pointVec = new Vec3(localPoint[0], localPoint[1], localPoint[2]);\r\n    body.value.applyLocalForce(forceVec, pointVec);\r\n  } else {\r\n    body.value.applyLocalForce(forceVec, new Vec3());\r\n  }\r\n};\r\n\r\n// \u5E94\u7528\u5C40\u90E8\u51B2\u91CF\r\nconst applyLocalImpulse = (impulse: Vector3Tuple, localPoint?: Vector3Tuple) => {\r\n  if (!body.value) return;\r\n  \r\n  const impulseVec = new Vec3(impulse[0], impulse[1], impulse[2]);\r\n  \r\n  if (localPoint) {\r\n    const pointVec = new Vec3(localPoint[0], localPoint[1], localPoint[2]);\r\n    body.value.applyLocalImpulse(impulseVec, pointVec);\r\n  } else {\r\n    body.value.applyLocalImpulse(impulseVec, new Vec3());\r\n  }\r\n};\r\n\r\n// \u5904\u7406\u78B0\u649E\u4E8B\u4EF6\r\nconst handleCollide = (event: any) => {\r\n  emit('collide', { body: event.body, contact: event.contact });\r\n};\r\n\r\n// \u5904\u7406\u7761\u7720\u4E8B\u4EF6\r\nconst handleSleep = () => {\r\n  isSleeping.value = true;\r\n  emit('sleep', { body: body.value });\r\n};\r\n\r\n// \u5904\u7406\u5524\u9192\u4E8B\u4EF6\r\nconst handleWakeup = () => {\r\n  isSleeping.value = false;\r\n  emit('wakeup', { body: body.value });\r\n};\r\n\r\n// \u5728\u6BCF\u4E00\u5E27\u66F4\u65B0\r\nconst onFrame = () => {\r\n  if (body.value && parent.value) {\r\n    updateObjectTransform();\r\n  }\r\n};\r\n\r\n// \u76D1\u542C\u5C5E\u6027\u53D8\u5316\r\nwatch(() => props.mass, (newMass) => {\r\n  if (body.value && newMass !== undefined && props.type !== 'static') {\r\n    body.value.mass = newMass;\r\n    body.value.updateMassProperties();\r\n  }\r\n});\r\n\r\nwatch(() => props.type, (newType) => {\r\n  if (body.value && newType) {\r\n    if (newType === 'static') {\r\n      body.value.mass = 0;\r\n      body.value.updateMassProperties();\r\n      body.value.type = Body.STATIC;\r\n    } else if (newType === 'dynamic') {\r\n      body.value.mass = props.mass || 1;\r\n      body.value.updateMassProperties();\r\n      body.value.type = Body.DYNAMIC;\r\n    } else if (newType === 'kinematic') {\r\n      body.value.mass = props.mass || 1;\r\n      body.value.updateMassProperties();\r\n      body.value.type = Body.KINEMATIC;\r\n    }\r\n  }\r\n});\r\n\r\nwatch(() => props.position, (newPosition) => {\r\n  if (body.value && newPosition) {\r\n    body.value.position.set(newPosition[0], newPosition[1], newPosition[2]);\r\n    body.value.previousPosition.set(newPosition[0], newPosition[1], newPosition[2]);\r\n    body.value.initPosition.set(newPosition[0], newPosition[1], newPosition[2]);\r\n  }\r\n});\r\n\r\nwatch(() => props.rotation, (newRotation) => {\r\n  if (body.value && newRotation) {\r\n    const euler = arrayToVector3(newRotation);\r\n    body.value.quaternion.setFromEuler(euler.x, euler.y, euler.z, 'XYZ');\r\n    body.value.previousQuaternion.copy(body.value.quaternion);\r\n    body.value.initQuaternion.copy(body.value.quaternion);\r\n  }\r\n});\r\n\r\nwatch(() => props.linearDamping, (newLinearDamping) => {\r\n  if (body.value && newLinearDamping !== undefined) {\r\n    body.value.linearDamping = newLinearDamping;\r\n  }\r\n});\r\n\r\nwatch(() => props.angularDamping, (newAngularDamping) => {\r\n  if (body.value && newAngularDamping !== undefined) {\r\n    body.value.angularDamping = newAngularDamping;\r\n  }\r\n});\r\n\r\nwatch(() => props.linearFactor, (newLinearFactor) => {\r\n  if (body.value && newLinearFactor) {\r\n    body.value.linearFactor.set(\r\n      newLinearFactor[0],\r\n      newLinearFactor[1],\r\n      newLinearFactor[2]\r\n    );\r\n  }\r\n});\r\n\r\nwatch(() => props.angularFactor, (newAngularFactor) => {\r\n  if (body.value && newAngularFactor) {\r\n    body.value.angularFactor.set(\r\n      newAngularFactor[0],\r\n      newAngularFactor[1],\r\n      newAngularFactor[2]\r\n    );\r\n  }\r\n});\r\n\r\nwatch(() => props.fixedRotation, (newFixedRotation) => {\r\n  if (body.value && newFixedRotation !== undefined) {\r\n    body.value.fixedRotation = newFixedRotation;\r\n    body.value.updateMassProperties();\r\n  }\r\n});\r\n\r\nwatch(() => props.allowSleep, (newAllowSleep) => {\r\n  if (body.value && newAllowSleep !== undefined) {\r\n    body.value.allowSleep = newAllowSleep;\r\n  }\r\n});\r\n\r\nwatch(() => props.sleepSpeedLimit, (newSleepSpeedLimit) => {\r\n  if (body.value && newSleepSpeedLimit !== undefined) {\r\n    body.value.sleepSpeedLimit = newSleepSpeedLimit;\r\n  }\r\n});\r\n\r\nwatch(() => props.sleepTimeLimit, (newSleepTimeLimit) => {\r\n  if (body.value && newSleepTimeLimit !== undefined) {\r\n    body.value.sleepTimeLimit = newSleepTimeLimit;\r\n  }\r\n});\r\n\r\nwatch(() => props.collisionFilterGroup, (newCollisionFilterGroup) => {\r\n  if (body.value && newCollisionFilterGroup !== undefined) {\r\n    body.value.collisionFilterGroup = newCollisionFilterGroup;\r\n  }\r\n});\r\n\r\nwatch(() => props.collisionFilterMask, (newCollisionFilterMask) => {\r\n  if (body.value && newCollisionFilterMask !== undefined) {\r\n    body.value.collisionFilterMask = newCollisionFilterMask;\r\n  }\r\n});\r\n\r\n// \u7EC4\u4EF6\u6302\u8F7D\u548C\u5378\u8F7D\r\nonMounted(() => {\r\n  // \u521B\u5EFA\u521A\u4F53\r\n  createRigidBody();\r\n  \r\n  // \u6DFB\u52A0\u5E27\u66F4\u65B0\r\n  useFrame(onFrame);\r\n});\r\n\r\nonBeforeUnmount(() => {\r\n  if (body.value) {\r\n    // \u79FB\u9664\u4E8B\u4EF6\u76D1\u542C\r\n    body.value.removeEventListener('collide', handleCollide);\r\n    body.value.removeEventListener('sleep', handleSleep);\r\n    body.value.removeEventListener('wakeup', handleWakeup);\r\n    \r\n    // \u4ECE\u7269\u7406\u4E16\u754C\u79FB\u9664\r\n    if (physicsWorld) {\r\n      physicsWorld.removeBody(body.value);\r\n    }\r\n  }\r\n});\r\n\r\n// \u66B4\u9732\u7EC4\u4EF6\u5185\u90E8\u72B6\u6001\u548C\u65B9\u6CD5\r\ndefineExpose({\r\n  body,\r\n  isSleeping,\r\n  applyForce,\r\n  applyImpulse,\r\n  applyLocalForce,\r\n  applyLocalImpulse,\r\n  updateBodyTransform,\r\n  updateObjectTransform\r\n});\r\n</script>\r\n\r\n<template>\r\n  <div>\r\n    <slot \r\n      :body=\"body\" \r\n      :is-sleeping=\"isSleeping\"\r\n      :apply-force=\"applyForce\"\r\n      :apply-impulse=\"applyImpulse\"\r\n      :apply-local-force=\"applyLocalForce\"\r\n      :apply-local-impulse=\"applyLocalImpulse\"\r\n    ></slot>\r\n  </div>\r\n</template> ", "<script setup lang=\"ts\">\r\nimport { ref, onMounted, onBeforeUnmount, inject, watch } from 'vue';\r\nimport { Box, Vec3, Body } from 'cannon-es';\r\nimport { Object3D, Box3, Vector3 } from 'three';\r\nimport { injectThreeParent } from '../../composables/useThreeParent';\r\nimport { PHYSICS_WORLD_INJECTION_KEY } from './ThreePhysicsWorld.vue';\r\nimport { BoxColliderOptions, Vector3Tuple } from '../../types';\r\nimport { arrayToVector3, computeBoundingBox } from '../../utils';\r\n\r\nconst props = defineProps<{\r\n  size?: Vector3Tuple;\r\n  position?: Vector3Tuple;\r\n  rotation?: Vector3Tuple;\r\n  offset?: Vector3Tuple;\r\n  isTrigger?: boolean;\r\n  collisionFilterGroup?: number;\r\n  collisionFilterMask?: number;\r\n  autoFit?: boolean;\r\n}>();\r\n\r\nconst emit = defineEmits<{\r\n  collide: [event: { body: Body; contact: any }];\r\n}>();\r\n\r\n// \u83B7\u53D6\u7236\u5BF9\u8C61\u548C\u7269\u7406\u4E16\u754C\r\nconst parent = injectThreeParent();\r\nconst physicsWorld = inject(PHYSICS_WORLD_INJECTION_KEY);\r\n\r\n// \u78B0\u649E\u5668\r\nconst collider = ref<Body | null>(null);\r\n\r\n// \u521B\u5EFA\u78B0\u649E\u5668\r\nconst createCollider = () => {\r\n  if (!parent.value) return;\r\n  \r\n  // \u521B\u5EFA\u5F62\u72B6\r\n  let halfExtents: Vec3;\r\n  \r\n  if (props.size) {\r\n    // \u4F7F\u7528\u6307\u5B9A\u5927\u5C0F\r\n    halfExtents = new Vec3(props.size[0] / 2, props.size[1] / 2, props.size[2] / 2);\r\n  } else if (props.autoFit !== false) {\r\n    // \u81EA\u52A8\u9002\u5E94\u5BF9\u8C61\u5927\u5C0F\r\n    const box = computeBoundingBox(parent.value);\r\n    const size = new Vector3();\r\n    box.getSize(size);\r\n    halfExtents = new Vec3(size.x / 2, size.y / 2, size.z / 2);\r\n  } else {\r\n    // \u9ED8\u8BA4\u5927\u5C0F\r\n    halfExtents = new Vec3(0.5, 0.5, 0.5);\r\n  }\r\n  \r\n  // \u521B\u5EFA\u76D2\u4F53\u5F62\u72B6\r\n  const shape = new Box(halfExtents);\r\n  \r\n  // \u521B\u5EFA\u521A\u4F53\uFF08\u8D28\u91CF\u4E3A0\uFF0C\u4F7F\u5176\u6210\u4E3A\u9759\u6001\u78B0\u649E\u5668\uFF09\r\n  collider.value = new Body({\r\n    mass: 0,\r\n    type: Body.STATIC,\r\n    shape,\r\n    position: new Vec3(),\r\n    collisionFilterGroup: props.collisionFilterGroup || 1,\r\n    collisionFilterMask: props.collisionFilterMask || -1,\r\n    isTrigger: props.isTrigger || false\r\n  });\r\n  \r\n  // \u8BBE\u7F6E\u4F4D\u7F6E\u548C\u65CB\u8F6C\r\n  updateColliderTransform();\r\n  \r\n  // \u6DFB\u52A0\u78B0\u649E\u4E8B\u4EF6\u76D1\u542C\r\n  collider.value.addEventListener('collide', handleCollide);\r\n  \r\n  // \u6DFB\u52A0\u5230\u7269\u7406\u4E16\u754C\r\n  if (physicsWorld) {\r\n    physicsWorld.addBody(collider.value);\r\n  }\r\n};\r\n\r\n// \u66F4\u65B0\u78B0\u649E\u5668\u53D8\u6362\r\nconst updateColliderTransform = () => {\r\n  if (!collider.value || !parent.value) return;\r\n  \r\n  // \u83B7\u53D6\u4F4D\u7F6E\r\n  let position: Vec3;\r\n  if (props.position) {\r\n    position = new Vec3(props.position[0], props.position[1], props.position[2]);\r\n  } else {\r\n    position = new Vec3(\r\n      parent.value.position.x,\r\n      parent.value.position.y,\r\n      parent.value.position.z\r\n    );\r\n  }\r\n  \r\n  // \u5E94\u7528\u504F\u79FB\r\n  if (props.offset) {\r\n    position.x += props.offset[0];\r\n    position.y += props.offset[1];\r\n    position.z += props.offset[2];\r\n  }\r\n  \r\n  // \u8BBE\u7F6E\u4F4D\u7F6E\r\n  collider.value.position.copy(position);\r\n  \r\n  // \u8BBE\u7F6E\u65CB\u8F6C\r\n  if (props.rotation) {\r\n    const euler = arrayToVector3(props.rotation);\r\n    collider.value.quaternion.setFromEuler(euler.x, euler.y, euler.z, 'XYZ');\r\n  } else {\r\n    collider.value.quaternion.copy(parent.value.quaternion);\r\n  }\r\n};\r\n\r\n// \u5904\u7406\u78B0\u649E\u4E8B\u4EF6\r\nconst handleCollide = (event: any) => {\r\n  emit('collide', { body: event.body, contact: event.contact });\r\n};\r\n\r\n// \u76D1\u542C\u5C5E\u6027\u53D8\u5316\r\nwatch(() => props.position, (newPosition) => {\r\n  if (collider.value && newPosition) {\r\n    collider.value.position.set(newPosition[0], newPosition[1], newPosition[2]);\r\n    \r\n    // \u5E94\u7528\u504F\u79FB\r\n    if (props.offset) {\r\n      collider.value.position.x += props.offset[0];\r\n      collider.value.position.y += props.offset[1];\r\n      collider.value.position.z += props.offset[2];\r\n    }\r\n  }\r\n});\r\n\r\nwatch(() => props.rotation, (newRotation) => {\r\n  if (collider.value && newRotation) {\r\n    const euler = arrayToVector3(newRotation);\r\n    collider.value.quaternion.setFromEuler(euler.x, euler.y, euler.z, 'XYZ');\r\n  }\r\n});\r\n\r\nwatch(() => props.offset, (newOffset) => {\r\n  if (collider.value && parent.value && newOffset) {\r\n    // \u91CD\u65B0\u8BA1\u7B97\u4F4D\u7F6E\r\n    let position: Vec3;\r\n    if (props.position) {\r\n      position = new Vec3(props.position[0], props.position[1], props.position[2]);\r\n    } else {\r\n      position = new Vec3(\r\n        parent.value.position.x,\r\n        parent.value.position.y,\r\n        parent.value.position.z\r\n      );\r\n    }\r\n    \r\n    // \u5E94\u7528\u65B0\u504F\u79FB\r\n    position.x += newOffset[0];\r\n    position.y += newOffset[1];\r\n    position.z += newOffset[2];\r\n    \r\n    // \u8BBE\u7F6E\u4F4D\u7F6E\r\n    collider.value.position.copy(position);\r\n  }\r\n}, { deep: true });\r\n\r\nwatch(() => props.isTrigger, (newIsTrigger) => {\r\n  if (collider.value && newIsTrigger !== undefined) {\r\n    collider.value.isTrigger = newIsTrigger;\r\n  }\r\n});\r\n\r\nwatch(() => props.collisionFilterGroup, (newGroup) => {\r\n  if (collider.value && newGroup !== undefined) {\r\n    collider.value.collisionFilterGroup = newGroup;\r\n  }\r\n});\r\n\r\nwatch(() => props.collisionFilterMask, (newMask) => {\r\n  if (collider.value && newMask !== undefined) {\r\n    collider.value.collisionFilterMask = newMask;\r\n  }\r\n});\r\n\r\n// \u7EC4\u4EF6\u6302\u8F7D\u548C\u5378\u8F7D\r\nonMounted(() => {\r\n  // \u521B\u5EFA\u78B0\u649E\u5668\r\n  createCollider();\r\n});\r\n\r\nonBeforeUnmount(() => {\r\n  if (collider.value) {\r\n    // \u79FB\u9664\u78B0\u649E\u4E8B\u4EF6\u76D1\u542C\r\n    collider.value.removeEventListener('collide', handleCollide);\r\n    \r\n    // \u4ECE\u7269\u7406\u4E16\u754C\u79FB\u9664\r\n    if (physicsWorld) {\r\n      physicsWorld.removeBody(collider.value);\r\n    }\r\n  }\r\n});\r\n\r\n// \u66B4\u9732\u7EC4\u4EF6\u5185\u90E8\u72B6\u6001\u548C\u65B9\u6CD5\r\ndefineExpose({\r\n  collider,\r\n  updateColliderTransform\r\n});\r\n</script>\r\n\r\n<template>\r\n  <div>\r\n    <slot :collider=\"collider\"></slot>\r\n  </div>\r\n</template> ", "<script setup lang=\"ts\">\r\nimport { ref, onMounted, onBeforeUnmount, inject, watch } from 'vue';\r\nimport { Sphere, Vec3, Body } from 'cannon-es';\r\nimport { Object3D, Box3, Vector3 } from 'three';\r\nimport { injectThreeParent } from '../../composables/useThreeParent';\r\nimport { PHYSICS_WORLD_INJECTION_KEY } from './ThreePhysicsWorld.vue';\r\nimport { SphereColliderOptions, Vector3Tuple } from '../../types';\r\nimport { arrayToVector3, computeBoundingSphere } from '../../utils';\r\n\r\nconst props = defineProps<{\r\n  radius?: number;\r\n  position?: Vector3Tuple;\r\n  rotation?: Vector3Tuple;\r\n  offset?: Vector3Tuple;\r\n  isTrigger?: boolean;\r\n  collisionFilterGroup?: number;\r\n  collisionFilterMask?: number;\r\n  autoFit?: boolean;\r\n}>();\r\n\r\nconst emit = defineEmits<{\r\n  collide: [event: { body: Body; contact: any }];\r\n}>();\r\n\r\n// \u83B7\u53D6\u7236\u5BF9\u8C61\u548C\u7269\u7406\u4E16\u754C\r\nconst parent = injectThreeParent();\r\nconst physicsWorld = inject(PHYSICS_WORLD_INJECTION_KEY);\r\n\r\n// \u78B0\u649E\u5668\r\nconst collider = ref<Body | null>(null);\r\n\r\n// \u521B\u5EFA\u78B0\u649E\u5668\r\nconst createCollider = () => {\r\n  if (!parent.value) return;\r\n  \r\n  // \u521B\u5EFA\u5F62\u72B6\r\n  let radius: number;\r\n  \r\n  if (props.radius) {\r\n    // \u4F7F\u7528\u6307\u5B9A\u534A\u5F84\r\n    radius = props.radius;\r\n  } else if (props.autoFit !== false) {\r\n    // \u81EA\u52A8\u9002\u5E94\u5BF9\u8C61\u5927\u5C0F\r\n    const boundingSphere = computeBoundingSphere(parent.value);\r\n    radius = boundingSphere.radius;\r\n  } else {\r\n    // \u9ED8\u8BA4\u534A\u5F84\r\n    radius = 0.5;\r\n  }\r\n  \r\n  // \u521B\u5EFA\u7403\u4F53\u5F62\u72B6\r\n  const shape = new Sphere(radius);\r\n  \r\n  // \u521B\u5EFA\u521A\u4F53\uFF08\u8D28\u91CF\u4E3A0\uFF0C\u4F7F\u5176\u6210\u4E3A\u9759\u6001\u78B0\u649E\u5668\uFF09\r\n  collider.value = new Body({\r\n    mass: 0,\r\n    type: Body.STATIC,\r\n    shape,\r\n    position: new Vec3(),\r\n    collisionFilterGroup: props.collisionFilterGroup || 1,\r\n    collisionFilterMask: props.collisionFilterMask || -1,\r\n    isTrigger: props.isTrigger || false\r\n  });\r\n  \r\n  // \u8BBE\u7F6E\u4F4D\u7F6E\u548C\u65CB\u8F6C\r\n  updateColliderTransform();\r\n  \r\n  // \u6DFB\u52A0\u78B0\u649E\u4E8B\u4EF6\u76D1\u542C\r\n  collider.value.addEventListener('collide', handleCollide);\r\n  \r\n  // \u6DFB\u52A0\u5230\u7269\u7406\u4E16\u754C\r\n  if (physicsWorld) {\r\n    physicsWorld.addBody(collider.value);\r\n  }\r\n};\r\n\r\n// \u66F4\u65B0\u78B0\u649E\u5668\u53D8\u6362\r\nconst updateColliderTransform = () => {\r\n  if (!collider.value || !parent.value) return;\r\n  \r\n  // \u83B7\u53D6\u4F4D\u7F6E\r\n  let position: Vec3;\r\n  if (props.position) {\r\n    position = new Vec3(props.position[0], props.position[1], props.position[2]);\r\n  } else {\r\n    position = new Vec3(\r\n      parent.value.position.x,\r\n      parent.value.position.y,\r\n      parent.value.position.z\r\n    );\r\n  }\r\n  \r\n  // \u5E94\u7528\u504F\u79FB\r\n  if (props.offset) {\r\n    position.x += props.offset[0];\r\n    position.y += props.offset[1];\r\n    position.z += props.offset[2];\r\n  }\r\n  \r\n  // \u8BBE\u7F6E\u4F4D\u7F6E\r\n  collider.value.position.copy(position);\r\n  \r\n  // \u8BBE\u7F6E\u65CB\u8F6C\r\n  if (props.rotation) {\r\n    const euler = arrayToVector3(props.rotation);\r\n    collider.value.quaternion.setFromEuler(euler.x, euler.y, euler.z, 'XYZ');\r\n  } else {\r\n    collider.value.quaternion.copy(parent.value.quaternion);\r\n  }\r\n};\r\n\r\n// \u5904\u7406\u78B0\u649E\u4E8B\u4EF6\r\nconst handleCollide = (event: any) => {\r\n  emit('collide', { body: event.body, contact: event.contact });\r\n};\r\n\r\n// \u76D1\u542C\u5C5E\u6027\u53D8\u5316\r\nwatch(() => props.position, (newPosition) => {\r\n  if (collider.value && newPosition) {\r\n    collider.value.position.set(newPosition[0], newPosition[1], newPosition[2]);\r\n    \r\n    // \u5E94\u7528\u504F\u79FB\r\n    if (props.offset) {\r\n      collider.value.position.x += props.offset[0];\r\n      collider.value.position.y += props.offset[1];\r\n      collider.value.position.z += props.offset[2];\r\n    }\r\n  }\r\n});\r\n\r\nwatch(() => props.rotation, (newRotation) => {\r\n  if (collider.value && newRotation) {\r\n    const euler = arrayToVector3(newRotation);\r\n    collider.value.quaternion.setFromEuler(euler.x, euler.y, euler.z, 'XYZ');\r\n  }\r\n});\r\n\r\nwatch(() => props.offset, (newOffset) => {\r\n  if (collider.value && parent.value && newOffset) {\r\n    // \u91CD\u65B0\u8BA1\u7B97\u4F4D\u7F6E\r\n    let position: Vec3;\r\n    if (props.position) {\r\n      position = new Vec3(props.position[0], props.position[1], props.position[2]);\r\n    } else {\r\n      position = new Vec3(\r\n        parent.value.position.x,\r\n        parent.value.position.y,\r\n        parent.value.position.z\r\n      );\r\n    }\r\n    \r\n    // \u5E94\u7528\u65B0\u504F\u79FB\r\n    position.x += newOffset[0];\r\n    position.y += newOffset[1];\r\n    position.z += newOffset[2];\r\n    \r\n    // \u8BBE\u7F6E\u4F4D\u7F6E\r\n    collider.value.position.copy(position);\r\n  }\r\n}, { deep: true });\r\n\r\nwatch(() => props.radius, (newRadius) => {\r\n  if (collider.value && physicsWorld && newRadius) {\r\n    // \u4ECE\u7269\u7406\u4E16\u754C\u79FB\u9664\u65E7\u78B0\u649E\u5668\r\n    physicsWorld.removeBody(collider.value);\r\n    \r\n    // \u91CD\u65B0\u521B\u5EFA\u78B0\u649E\u5668\r\n    createCollider();\r\n  }\r\n});\r\n\r\nwatch(() => props.isTrigger, (newIsTrigger) => {\r\n  if (collider.value && newIsTrigger !== undefined) {\r\n    collider.value.isTrigger = newIsTrigger;\r\n  }\r\n});\r\n\r\nwatch(() => props.collisionFilterGroup, (newGroup) => {\r\n  if (collider.value && newGroup !== undefined) {\r\n    collider.value.collisionFilterGroup = newGroup;\r\n  }\r\n});\r\n\r\nwatch(() => props.collisionFilterMask, (newMask) => {\r\n  if (collider.value && newMask !== undefined) {\r\n    collider.value.collisionFilterMask = newMask;\r\n  }\r\n});\r\n\r\n// \u7EC4\u4EF6\u6302\u8F7D\u548C\u5378\u8F7D\r\nonMounted(() => {\r\n  // \u521B\u5EFA\u78B0\u649E\u5668\r\n  createCollider();\r\n});\r\n\r\nonBeforeUnmount(() => {\r\n  if (collider.value) {\r\n    // \u79FB\u9664\u78B0\u649E\u4E8B\u4EF6\u76D1\u542C\r\n    collider.value.removeEventListener('collide', handleCollide);\r\n    \r\n    // \u4ECE\u7269\u7406\u4E16\u754C\u79FB\u9664\r\n    if (physicsWorld) {\r\n      physicsWorld.removeBody(collider.value);\r\n    }\r\n  }\r\n});\r\n\r\n// \u66B4\u9732\u7EC4\u4EF6\u5185\u90E8\u72B6\u6001\u548C\u65B9\u6CD5\r\ndefineExpose({\r\n  collider,\r\n  updateColliderTransform\r\n});\r\n</script>\r\n\r\n<template>\r\n  <div>\r\n    <slot :collider=\"collider\"></slot>\r\n  </div>\r\n</template> ", "<script setup lang=\"ts\">\r\nimport { ref, onMounted, onBeforeUnmount, inject, watch } from 'vue';\r\nimport { \r\n  Constraint, PointToPointConstraint, DistanceConstraint, \r\n  HingeConstraint, LockConstraint, Vec3, Body \r\n} from 'cannon-es';\r\nimport { injectThreeParent } from '../../composables/useThreeParent';\r\nimport { PHYSICS_WORLD_INJECTION_KEY } from './ThreePhysicsWorld.vue';\r\nimport { ConstraintOptions, ConstraintType, Vector3Tuple } from '../../types';\r\nimport { arrayToVector3 } from '../../utils';\r\n\r\nconst props = defineProps<{\r\n  type: ConstraintType;\r\n  bodyA: Body;\r\n  bodyB?: Body | null;\r\n  pivotA?: Vector3Tuple;\r\n  pivotB?: Vector3Tuple;\r\n  axisA?: Vector3Tuple;\r\n  axisB?: Vector3Tuple;\r\n  distance?: number;\r\n  maxForce?: number;\r\n  collideConnected?: boolean;\r\n  stiffness?: number;\r\n  damping?: number;\r\n  restLength?: number;\r\n  motorEnabled?: boolean;\r\n  motorSpeed?: number;\r\n  motorMaxForce?: number;\r\n}>();\r\n\r\nconst emit = defineEmits<{\r\n  created: [constraint: Constraint];\r\n}>();\r\n\r\n// \u83B7\u53D6\u7236\u5BF9\u8C61\u548C\u7269\u7406\u4E16\u754C\r\nconst parent = injectThreeParent();\r\nconst physicsWorld = inject(PHYSICS_WORLD_INJECTION_KEY);\r\n\r\n// \u7EA6\u675F\r\nconst constraint = ref<Constraint | null>(null);\r\n\r\n// \u521B\u5EFA\u7EA6\u675F\r\nconst createConstraint = () => {\r\n  if (!props.bodyA) return;\r\n  \r\n  switch (props.type) {\r\n    case 'point':\r\n      createPointConstraint();\r\n      break;\r\n    case 'distance':\r\n      createDistanceConstraint();\r\n      break;\r\n    case 'hinge':\r\n      createHingeConstraint();\r\n      break;\r\n    case 'lock':\r\n      createLockConstraint();\r\n      break;\r\n    case 'spring':\r\n      createSpringConstraint();\r\n      break;\r\n    default:\r\n      console.warn(`Unknown constraint type: ${props.type}`);\r\n  }\r\n  \r\n  // \u6DFB\u52A0\u5230\u7269\u7406\u4E16\u754C\r\n  if (constraint.value && physicsWorld) {\r\n    physicsWorld.world.addConstraint(constraint.value);\r\n    emit('created', constraint.value);\r\n  }\r\n};\r\n\r\n// \u521B\u5EFA\u70B9\u5BF9\u70B9\u7EA6\u675F\r\nconst createPointConstraint = () => {\r\n  const pivotA = props.pivotA ? new Vec3(props.pivotA[0], props.pivotA[1], props.pivotA[2]) : new Vec3();\r\n  const pivotB = props.pivotB && props.bodyB ? new Vec3(props.pivotB[0], props.pivotB[1], props.pivotB[2]) : new Vec3();\r\n  \r\n  if (props.bodyB) {\r\n    constraint.value = new PointToPointConstraint(\r\n      props.bodyA,\r\n      pivotA,\r\n      props.bodyB,\r\n      pivotB,\r\n      props.maxForce || undefined\r\n    );\r\n  } else {\r\n    constraint.value = new PointToPointConstraint(\r\n      props.bodyA,\r\n      pivotA,\r\n      props.bodyA, // \u81EA\u8EAB\u7EA6\u675F\r\n      new Vec3(),\r\n      props.maxForce || undefined\r\n    );\r\n  }\r\n};\r\n\r\n// \u521B\u5EFA\u8DDD\u79BB\u7EA6\u675F\r\nconst createDistanceConstraint = () => {\r\n  if (!props.bodyB) return;\r\n  \r\n  const distance = props.distance || 1;\r\n  \r\n  constraint.value = new DistanceConstraint(\r\n    props.bodyA,\r\n    props.bodyB,\r\n    distance,\r\n    props.maxForce || undefined\r\n  );\r\n};\r\n\r\n// \u521B\u5EFA\u94F0\u94FE\u7EA6\u675F\r\nconst createHingeConstraint = () => {\r\n  if (!props.bodyB) return;\r\n  \r\n  const pivotA = props.pivotA ? new Vec3(props.pivotA[0], props.pivotA[1], props.pivotA[2]) : new Vec3();\r\n  const pivotB = props.pivotB ? new Vec3(props.pivotB[0], props.pivotB[1], props.pivotB[2]) : new Vec3();\r\n  const axisA = props.axisA ? new Vec3(props.axisA[0], props.axisA[1], props.axisA[2]) : new Vec3(1, 0, 0);\r\n  const axisB = props.axisB ? new Vec3(props.axisB[0], props.axisB[1], props.axisB[2]) : new Vec3(1, 0, 0);\r\n  \r\n  const hingeConstraint = new HingeConstraint(\r\n    props.bodyA,\r\n    props.bodyB,\r\n    {\r\n      pivotA,\r\n      pivotB,\r\n      axisA,\r\n      axisB,\r\n      maxForce: props.maxForce || undefined,\r\n      collideConnected: props.collideConnected || false\r\n    }\r\n  );\r\n  \r\n  // \u8BBE\u7F6E\u7535\u673A\r\n  if (props.motorEnabled) {\r\n    hingeConstraint.enableMotor();\r\n    if (props.motorSpeed !== undefined) {\r\n      hingeConstraint.setMotorSpeed(props.motorSpeed);\r\n    }\r\n    if (props.motorMaxForce !== undefined) {\r\n      hingeConstraint.setMotorMaxForce(props.motorMaxForce);\r\n    }\r\n  }\r\n  \r\n  constraint.value = hingeConstraint;\r\n};\r\n\r\n// \u521B\u5EFA\u9501\u5B9A\u7EA6\u675F\r\nconst createLockConstraint = () => {\r\n  if (!props.bodyB) return;\r\n  \r\n  constraint.value = new LockConstraint(\r\n    props.bodyA,\r\n    props.bodyB,\r\n    {\r\n      maxForce: props.maxForce || undefined,\r\n      collideConnected: props.collideConnected || false\r\n    }\r\n  );\r\n};\r\n\r\n// \u521B\u5EFA\u5F39\u7C27\u7EA6\u675F\r\nconst createSpringConstraint = () => {\r\n  if (!props.bodyB) return;\r\n  \r\n  const localAnchorA = props.pivotA ? new Vec3(props.pivotA[0], props.pivotA[1], props.pivotA[2]) : new Vec3();\r\n  const localAnchorB = props.pivotB ? new Vec3(props.pivotB[0], props.pivotB[1], props.pivotB[2]) : new Vec3();\r\n  \r\n  // \u521B\u5EFA\u8DDD\u79BB\u7EA6\u675F\u5E76\u6DFB\u52A0\u5F39\u7C27\u5C5E\u6027\r\n  const distanceConstraint = new DistanceConstraint(\r\n    props.bodyA,\r\n    props.bodyB,\r\n    props.restLength || 1,\r\n    props.maxForce || undefined\r\n  );\r\n  \r\n  // \u8BBE\u7F6E\u5F39\u7C27\u5C5E\u6027\r\n  if (props.stiffness !== undefined) {\r\n    distanceConstraint.stiffness = props.stiffness;\r\n  }\r\n  if (props.damping !== undefined) {\r\n    distanceConstraint.damping = props.damping;\r\n  }\r\n  if (props.restLength !== undefined) {\r\n    distanceConstraint.restLength = props.restLength;\r\n  }\r\n  \r\n  constraint.value = distanceConstraint;\r\n};\r\n\r\n// \u542F\u7528/\u7981\u7528\u7EA6\u675F\r\nconst enableConstraint = (enabled: boolean) => {\r\n  if (!constraint.value || !physicsWorld) return;\r\n  \r\n  if (enabled) {\r\n    if (!physicsWorld.world.constraints.includes(constraint.value)) {\r\n      physicsWorld.world.addConstraint(constraint.value);\r\n    }\r\n  } else {\r\n    if (physicsWorld.world.constraints.includes(constraint.value)) {\r\n      physicsWorld.world.removeConstraint(constraint.value);\r\n    }\r\n  }\r\n};\r\n\r\n// \u66F4\u65B0\u7EA6\u675F\u53C2\u6570\r\nconst updateConstraint = () => {\r\n  if (!constraint.value) return;\r\n  \r\n  // \u6839\u636E\u7EA6\u675F\u7C7B\u578B\u66F4\u65B0\u53C2\u6570\r\n  if (props.type === 'distance' || props.type === 'spring') {\r\n    const distanceConstraint = constraint.value as DistanceConstraint;\r\n    \r\n    if (props.stiffness !== undefined) {\r\n      distanceConstraint.stiffness = props.stiffness;\r\n    }\r\n    if (props.damping !== undefined) {\r\n      distanceConstraint.damping = props.damping;\r\n    }\r\n    if (props.restLength !== undefined) {\r\n      distanceConstraint.restLength = props.restLength;\r\n    }\r\n  } else if (props.type === 'hinge') {\r\n    const hingeConstraint = constraint.value as HingeConstraint;\r\n    \r\n    if (props.motorEnabled) {\r\n      hingeConstraint.enableMotor();\r\n      if (props.motorSpeed !== undefined) {\r\n        hingeConstraint.setMotorSpeed(props.motorSpeed);\r\n      }\r\n      if (props.motorMaxForce !== undefined) {\r\n        hingeConstraint.setMotorMaxForce(props.motorMaxForce);\r\n      }\r\n    } else {\r\n      hingeConstraint.disableMotor();\r\n    }\r\n  }\r\n};\r\n\r\n// \u76D1\u542C\u5C5E\u6027\u53D8\u5316\r\nwatch(() => props.bodyA, (newBodyA) => {\r\n  if (newBodyA && physicsWorld) {\r\n    // \u91CD\u65B0\u521B\u5EFA\u7EA6\u675F\r\n    if (constraint.value) {\r\n      physicsWorld.world.removeConstraint(constraint.value);\r\n    }\r\n    createConstraint();\r\n  }\r\n});\r\n\r\nwatch(() => props.bodyB, (newBodyB) => {\r\n  if (props.bodyA && newBodyB && physicsWorld) {\r\n    // \u91CD\u65B0\u521B\u5EFA\u7EA6\u675F\r\n    if (constraint.value) {\r\n      physicsWorld.world.removeConstraint(constraint.value);\r\n    }\r\n    createConstraint();\r\n  }\r\n});\r\n\r\nwatch(() => props.type, (newType) => {\r\n  if (props.bodyA && physicsWorld) {\r\n    // \u91CD\u65B0\u521B\u5EFA\u7EA6\u675F\r\n    if (constraint.value) {\r\n      physicsWorld.world.removeConstraint(constraint.value);\r\n    }\r\n    createConstraint();\r\n  }\r\n});\r\n\r\nwatch([() => props.stiffness, () => props.damping, () => props.restLength], () => {\r\n  if (props.type === 'distance' || props.type === 'spring') {\r\n    updateConstraint();\r\n  }\r\n});\r\n\r\nwatch([() => props.motorEnabled, () => props.motorSpeed, () => props.motorMaxForce], () => {\r\n  if (props.type === 'hinge') {\r\n    updateConstraint();\r\n  }\r\n});\r\n\r\n// \u7EC4\u4EF6\u6302\u8F7D\u548C\u5378\u8F7D\r\nonMounted(() => {\r\n  // \u521B\u5EFA\u7EA6\u675F\r\n  createConstraint();\r\n});\r\n\r\nonBeforeUnmount(() => {\r\n  // \u4ECE\u7269\u7406\u4E16\u754C\u79FB\u9664\u7EA6\u675F\r\n  if (constraint.value && physicsWorld) {\r\n    physicsWorld.world.removeConstraint(constraint.value);\r\n  }\r\n});\r\n\r\n// \u66B4\u9732\u7EC4\u4EF6\u5185\u90E8\u72B6\u6001\u548C\u65B9\u6CD5\r\ndefineExpose({\r\n  constraint,\r\n  enableConstraint,\r\n  updateConstraint\r\n});\r\n</script>\r\n\r\n<template>\r\n  <div>\r\n    <slot :constraint=\"constraint\"></slot>\r\n  </div>\r\n</template> ", "<script>\r\nimport { ref, onMounted, onBeforeUnmount, provide, watch, InjectionKey } from 'vue';\r\nimport {\r\n  EffectComposer,\r\n  RenderPass,\r\n  NormalPass,\r\n  SMAAPass,\r\n  EffectPass,\r\n  BloomEffect,\r\n  DepthOfFieldEffect,\r\n  SSAOEffect\r\n} from 'postprocessing';\r\nimport { useThree } from '../../composables/useThree';\r\nimport { useFrame } from '../../composables/useFrame';\r\nimport { getDevicePixelRatio } from '../../utils';\r\n\r\n// \u540E\u5904\u7406\u4E0A\u4E0B\u6587\u6CE8\u5165\u952E\r\nconst POST_PROCESSING_INJECTION_KEY = Symbol('post-processing');\r\n\r\nexport { POST_PROCESSING_INJECTION_KEY };\r\n\r\nexport default {\r\n  props: {\r\n    enabled: {\r\n      type: Boolean,\r\n      default: true\r\n    },\r\n    autoClear: {\r\n      type: Boolean,\r\n      default: true\r\n    },\r\n    renderToScreen: {\r\n      type: Boolean,\r\n      default: true\r\n    },\r\n    multisampling: {\r\n      type: Number,\r\n      default: 0\r\n    },\r\n    depthBuffer: {\r\n      type: Boolean,\r\n      default: true\r\n    },\r\n    stencilBuffer: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    normalPass: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    smaa: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    debug: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  setup(props, { emit }) {\r\n    // \u83B7\u53D6Three.js\u6838\u5FC3\u5BF9\u8C61\r\n    const { scene, camera, renderer } = useThree();\r\n    \r\n    // \u540E\u5904\u7406\u7EC4\u5408\u5668\r\n    const composer = ref(null);\r\n    const renderPass = ref(null);\r\n    const normalPass = ref(null);\r\n    const smaaPass = ref(null);\r\n    const passes = ref([]);\r\n    \r\n    // \u521D\u59CB\u5316\r\n    const init = () => {\r\n      if (!scene.value || !camera.value || !renderer.value) {\r\n        console.warn('Scene, camera or renderer not available');\r\n        return;\r\n      }\r\n      \r\n      const pixelRatio = getDevicePixelRatio();\r\n      \r\n      // \u521B\u5EFA\u6548\u679C\u7EC4\u5408\u5668\r\n      composer.value = new EffectComposer(renderer.value, {\r\n        multisampling: props.multisampling,\r\n        depthBuffer: props.depthBuffer,\r\n        stencilBuffer: props.stencilBuffer\r\n      });\r\n      \r\n      // \u6DFB\u52A0\u6E32\u67D3\u901A\u9053\r\n      renderPass.value = new RenderPass(scene.value, camera.value);\r\n      renderPass.value.enabled = true;\r\n      composer.value.addPass(renderPass.value);\r\n      \r\n      // \u6DFB\u52A0\u6CD5\u7EBF\u901A\u9053\uFF08\u5982\u679C\u9700\u8981\uFF09\r\n      if (props.normalPass) {\r\n        normalPass.value = new NormalPass(scene.value, camera.value);\r\n        normalPass.value.enabled = true;\r\n        composer.value.addPass(normalPass.value);\r\n      }\r\n      \r\n      // \u6DFB\u52A0SMAA\u6297\u952F\u9F7F\u901A\u9053\uFF08\u5982\u679C\u9700\u8981\uFF09\r\n      if (props.smaa) {\r\n        smaaPass.value = new SMAAPass(\r\n          renderer.value.getSize().width * pixelRatio,\r\n          renderer.value.getSize().height * pixelRatio\r\n        );\r\n        smaaPass.value.enabled = true;\r\n        composer.value.addPass(smaaPass.value);\r\n      }\r\n      \r\n      // \u63D0\u4F9B\u540E\u5904\u7406\u4E0A\u4E0B\u6587\r\n      provide(POST_PROCESSING_INJECTION_KEY, {\r\n        composer: composer.value,\r\n        normalPass: normalPass.value,\r\n        renderPass: renderPass.value,\r\n        addPass: (pass) => {\r\n          if (pass) {\r\n            composer.value.addPass(pass);\r\n            passes.value.push(pass);\r\n          }\r\n        },\r\n        removePass: (pass) => {\r\n          if (pass) {\r\n            composer.value.removePass(pass);\r\n            const index = passes.value.indexOf(pass);\r\n            if (index !== -1) {\r\n              passes.value.splice(index, 1);\r\n            }\r\n          }\r\n        }\r\n      });\r\n      \r\n      // \u89E6\u53D1\u521D\u59CB\u5316\u4E8B\u4EF6\r\n      emit('initialized', composer.value);\r\n    };\r\n    \r\n    // \u8C03\u6574\u5927\u5C0F\r\n    const resize = () => {\r\n      if (composer.value && renderer.value) {\r\n        composer.value.setSize(\r\n          renderer.value.domElement.width,\r\n          renderer.value.domElement.height\r\n        );\r\n      }\r\n    };\r\n    \r\n    // \u6E32\u67D3\r\n    const render = () => {\r\n      if (!composer.value || !props.enabled) return;\r\n      \r\n      // \u6E32\u67D3\u573A\u666F\r\n      composer.value.render();\r\n      \r\n      // \u89E6\u53D1\u6E32\u67D3\u4E8B\u4EF6\r\n      emit('rendered', composer.value);\r\n    };\r\n    \r\n    // \u76D1\u542C\u5C5E\u6027\u53D8\u5316\r\n    watch(() => props.enabled, (enabled) => {\r\n      if (composer.value) {\r\n        if (enabled) {\r\n          useFrame(render);\r\n        }\r\n      }\r\n    });\r\n    \r\n    watch(() => props.renderToScreen, (renderToScreen) => {\r\n      if (composer.value) {\r\n        // \u83B7\u53D6\u6700\u540E\u4E00\u4E2A\u901A\u9053\r\n        const lastPass = composer.value.passes[composer.value.passes.length - 1];\r\n        if (lastPass) {\r\n          lastPass.renderToScreen = renderToScreen;\r\n        }\r\n      }\r\n    });\r\n    \r\n    // \u7EC4\u4EF6\u6302\u8F7D\u548C\u5378\u8F7D\r\n    onMounted(() => {\r\n      // \u521D\u59CB\u5316\u540E\u5904\u7406\r\n      init();\r\n      \r\n      // \u6DFB\u52A0\u5E27\u66F4\u65B0\r\n      if (props.enabled) {\r\n        useFrame(render);\r\n      }\r\n      \r\n      // \u6DFB\u52A0\u7A97\u53E3\u5927\u5C0F\u53D8\u5316\u76D1\u542C\r\n      window.addEventListener('resize', resize);\r\n    });\r\n    \r\n    onBeforeUnmount(() => {\r\n      // \u79FB\u9664\u7A97\u53E3\u5927\u5C0F\u53D8\u5316\u76D1\u542C\r\n      window.removeEventListener('resize', resize);\r\n      \r\n      // \u6E05\u7406\u901A\u9053\r\n      if (composer.value) {\r\n        composer.value.passes.forEach(pass => {\r\n          if (pass.dispose) {\r\n            pass.dispose();\r\n          }\r\n        });\r\n      }\r\n      \r\n      // \u6E05\u7406\u5F15\u7528\r\n      composer.value = null;\r\n      renderPass.value = null;\r\n      normalPass.value = null;\r\n      smaaPass.value = null;\r\n      passes.value = [];\r\n    });\r\n    \r\n    return {\r\n      composer,\r\n      renderPass,\r\n      normalPass,\r\n      smaaPass,\r\n      passes,\r\n      render,\r\n      resize\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<template>\r\n  <div class=\"three-post-processing\">\r\n    <slot \r\n      :composer=\"composer\"\r\n      :render-pass=\"renderPass\"\r\n      :normal-pass=\"normalPass\"\r\n      :smaa-pass=\"smaaPass\"\r\n      :passes=\"passes\"\r\n    ></slot>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n.three-post-processing {\r\n  display: contents;\r\n}\r\n</style> ", "<template>\r\n  <slot></slot>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, inject, onMounted, onBeforeUnmount, watch } from 'vue';\r\nimport * as THREE from 'three';\r\nimport { UnrealBloomPass } from 'three/examples/jsm/postprocessing/UnrealBloomPass.js';\r\nimport { POST_PROCESSING_CONTEXT_KEY } from '../../constants';\r\nimport { useThree } from '../../composables/useThree';\r\n\r\nconst props = withDefaults(defineProps<{\r\n  /**\r\n   * \u8F89\u5149\u5F3A\u5EA6\u3002\u9ED8\u8BA4\u4E3A1\u3002\r\n   */\r\n  strength?: number;\r\n  /**\r\n   * \u8F89\u5149\u534A\u5F84\u3002\u9ED8\u8BA4\u4E3A0.7\u3002\r\n   */\r\n  radius?: number;\r\n  /**\r\n   * \u8F89\u5149\u9608\u503C\uFF0C\u4F4E\u4E8E\u6B64\u503C\u7684\u4EAE\u5EA6\u4E0D\u4F1A\u4EA7\u751F\u8F89\u5149\u3002\u9ED8\u8BA4\u4E3A0.8\u3002\r\n   */\r\n  threshold?: number;\r\n  /**\r\n   * \u8F89\u5149\u5206\u8FA8\u7387\uFF0C\u5F71\u54CD\u6027\u80FD\u548C\u8D28\u91CF\u3002\u9ED8\u8BA4\u4E3A256\u3002\r\n   */\r\n  resolution?: number;\r\n  /**\r\n   * \u662F\u5426\u542F\u7528\u3002\u9ED8\u8BA4\u4E3Atrue\u3002\r\n   */\r\n  enabled?: boolean;\r\n}>(), {\r\n  strength: 1,\r\n  radius: 0.7,\r\n  threshold: 0.8,\r\n  resolution: 256,\r\n  enabled: true\r\n});\r\n\r\n// \u4F7F\u7528three\u7EC4\u5408\u5F0F\u51FD\u6570\r\nconst { size } = useThree();\r\n\r\n// \u83B7\u53D6\u540E\u5904\u7406\u4E0A\u4E0B\u6587\r\nconst postProcessingContext = inject(POST_PROCESSING_CONTEXT_KEY, null);\r\n\r\n// \u521B\u5EFA\u8F89\u5149\u901A\u9053\r\nconst bloomPass = ref<UnrealBloomPass | null>(null);\r\n\r\n// \u521B\u5EFA\u8F89\u5149\u901A\u9053\r\nconst createBloomPass = () => {\r\n  if (!size.value) {\r\n    return;\r\n  }\r\n\r\n  // \u521B\u5EFA\u8F89\u5149\u901A\u9053\r\n  const resolution = new THREE.Vector2(props.resolution, props.resolution);\r\n  bloomPass.value = new UnrealBloomPass(resolution, props.strength, props.radius, props.threshold);\r\n  \r\n  // \u8BBE\u7F6E\u542F\u7528\u72B6\u6001\r\n  if (bloomPass.value) {\r\n    bloomPass.value.enabled = props.enabled;\r\n  }\r\n  \r\n  // \u6DFB\u52A0\u5230\u6548\u679C\u5408\u6210\u5668\r\n  if (postProcessingContext && bloomPass.value) {\r\n    postProcessingContext.addEffectPass(bloomPass.value);\r\n  }\r\n};\r\n\r\n// \u66F4\u65B0\u8F89\u5149\u901A\u9053\u914D\u7F6E\r\nconst updateBloomPassConfig = () => {\r\n  if (!bloomPass.value) {\r\n    return;\r\n  }\r\n  \r\n  bloomPass.value.strength = props.strength;\r\n  bloomPass.value.radius = props.radius;\r\n  bloomPass.value.threshold = props.threshold;\r\n  bloomPass.value.enabled = props.enabled;\r\n  \r\n  // \u66F4\u65B0\u5206\u8FA8\u7387\r\n  if (props.resolution !== bloomPass.value.resolution.x) {\r\n    bloomPass.value.resolution.set(props.resolution, props.resolution);\r\n  }\r\n};\r\n\r\n// \u76D1\u542C\u5C5E\u6027\u53D8\u5316\r\nwatch(\r\n  () => ({\r\n    strength: props.strength,\r\n    radius: props.radius,\r\n    threshold: props.threshold,\r\n    resolution: props.resolution,\r\n    enabled: props.enabled\r\n  }),\r\n  () => {\r\n    updateBloomPassConfig();\r\n  },\r\n  { deep: true }\r\n);\r\n\r\n// \u76D1\u542C\u5C3A\u5BF8\u53D8\u5316\r\nwatch(\r\n  size,\r\n  () => {\r\n    if (bloomPass.value) {\r\n      // \u53EF\u4EE5\u6839\u636E\u5C3A\u5BF8\u8C03\u6574\u5206\u8FA8\u7387\r\n    }\r\n  }\r\n);\r\n\r\n// \u7EC4\u4EF6\u6302\u8F7D\u65F6\u521B\u5EFA\u8F89\u5149\u901A\u9053\r\nonMounted(() => {\r\n  createBloomPass();\r\n});\r\n\r\n// \u7EC4\u4EF6\u5378\u8F7D\u65F6\u79FB\u9664\u8F89\u5149\u901A\u9053\r\nonBeforeUnmount(() => {\r\n  if (postProcessingContext && bloomPass.value) {\r\n    postProcessingContext.removeEffectPass(bloomPass.value);\r\n  }\r\n  \r\n  if (bloomPass.value && bloomPass.value.dispose) {\r\n    bloomPass.value.dispose();\r\n  }\r\n  \r\n  bloomPass.value = null;\r\n});\r\n\r\n// \u66B4\u9732API\r\ndefineExpose({\r\n  bloomPass\r\n});\r\n</script> ", "<template>\r\n  <slot></slot>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, inject, onMounted, onBeforeUnmount, watch } from 'vue';\r\nimport * as THREE from 'three';\r\nimport { ShaderPass } from 'three/examples/jsm/postprocessing/ShaderPass.js';\r\nimport { FXAAShader } from 'three/examples/jsm/shaders/FXAAShader.js';\r\nimport { POST_PROCESSING_CONTEXT_KEY } from '../../constants';\r\nimport { useThree } from '../../composables/useThree';\r\n\r\nconst props = withDefaults(defineProps<{\r\n  /**\r\n   * \u662F\u5426\u542F\u7528\u3002\u9ED8\u8BA4\u4E3Atrue\u3002\r\n   */\r\n  enabled?: boolean;\r\n}>(), {\r\n  enabled: true\r\n});\r\n\r\n// \u4F7F\u7528three\u7EC4\u5408\u5F0F\u51FD\u6570\r\nconst { size, renderer } = useThree();\r\n\r\n// \u83B7\u53D6\u540E\u5904\u7406\u4E0A\u4E0B\u6587\r\nconst postProcessingContext = inject(POST_PROCESSING_CONTEXT_KEY, null);\r\n\r\n// \u521B\u5EFAFXAA\u901A\u9053\r\nconst fxaaPass = ref<ShaderPass | null>(null);\r\n\r\n// \u521B\u5EFAFXAA\u901A\u9053\r\nconst createFXAAPass = () => {\r\n  if (!size.value) {\r\n    return;\r\n  }\r\n\r\n  // \u521B\u5EFAFXAA\u901A\u9053\r\n  fxaaPass.value = new ShaderPass(FXAAShader);\r\n  \r\n  // \u66F4\u65B0\u5206\u8FA8\u7387\r\n  updateResolution();\r\n  \r\n  // \u8BBE\u7F6E\u542F\u7528\u72B6\u6001\r\n  if (fxaaPass.value) {\r\n    fxaaPass.value.enabled = props.enabled;\r\n  }\r\n  \r\n  // \u6DFB\u52A0\u5230\u6548\u679C\u5408\u6210\u5668\r\n  if (postProcessingContext && fxaaPass.value) {\r\n    postProcessingContext.addEffectPass(fxaaPass.value);\r\n  }\r\n};\r\n\r\n// \u66F4\u65B0\u5206\u8FA8\u7387\r\nconst updateResolution = () => {\r\n  if (!fxaaPass.value || !size.value || !renderer.value) {\r\n    return;\r\n  }\r\n  \r\n  const pixelRatio = renderer.value.getPixelRatio();\r\n  const uniforms = fxaaPass.value.material.uniforms;\r\n  \r\n  uniforms['resolution'].value.x = 1 / (size.value.width * pixelRatio);\r\n  uniforms['resolution'].value.y = 1 / (size.value.height * pixelRatio);\r\n};\r\n\r\n// \u66F4\u65B0FXAA\u901A\u9053\u914D\u7F6E\r\nconst updateFXAAPassConfig = () => {\r\n  if (!fxaaPass.value) {\r\n    return;\r\n  }\r\n  \r\n  fxaaPass.value.enabled = props.enabled;\r\n};\r\n\r\n// \u76D1\u542C\u5C5E\u6027\u53D8\u5316\r\nwatch(\r\n  () => ({\r\n    enabled: props.enabled\r\n  }),\r\n  () => {\r\n    updateFXAAPassConfig();\r\n  },\r\n  { deep: true }\r\n);\r\n\r\n// \u76D1\u542C\u5C3A\u5BF8\u53D8\u5316\r\nwatch(\r\n  size,\r\n  () => {\r\n    updateResolution();\r\n  }\r\n);\r\n\r\n// \u7EC4\u4EF6\u6302\u8F7D\u65F6\u521B\u5EFAFXAA\u901A\u9053\r\nonMounted(() => {\r\n  createFXAAPass();\r\n});\r\n\r\n// \u7EC4\u4EF6\u5378\u8F7D\u65F6\u79FB\u9664FXAA\u901A\u9053\r\nonBeforeUnmount(() => {\r\n  if (postProcessingContext && fxaaPass.value) {\r\n    postProcessingContext.removeEffectPass(fxaaPass.value);\r\n  }\r\n  \r\n  if (fxaaPass.value && fxaaPass.value.dispose) {\r\n    fxaaPass.value.dispose();\r\n  }\r\n  \r\n  fxaaPass.value = null;\r\n});\r\n\r\n// \u66B4\u9732API\r\ndefineExpose({\r\n  fxaaPass\r\n});\r\n</script> ", "<script setup lang=\"ts\">\r\nimport { ref, watch, onMounted, onBeforeUnmount, inject } from 'vue';\r\nimport { \r\n  EffectComposer, \r\n  RenderPass, \r\n  DepthOfFieldEffect, \r\n  EffectPass \r\n} from 'postprocessing';\r\nimport { Vector2 } from 'three';\r\nimport { useThree } from '../../composables/useThree';\r\nimport { POST_PROCESSING_INJECTION_KEY } from './ThreePostProcessing.vue';\r\n\r\nconst props = defineProps<{\r\n  enabled?: boolean;\r\n  focusDistance?: number;\r\n  focalLength?: number;\r\n  bokehScale?: number;\r\n  height?: number;\r\n  width?: number;\r\n  blur?: number;\r\n  focus?: number;\r\n  dof?: boolean;\r\n  aperture?: number;\r\n  maxBlur?: number;\r\n}>();\r\n\r\n// \u83B7\u53D6Three.js\u6838\u5FC3\u5BF9\u8C61\r\nconst { scene, camera, renderer } = useThree();\r\n\r\n// \u83B7\u53D6\u540E\u5904\u7406\u4E0A\u4E0B\u6587\r\nconst postProcessing = inject(POST_PROCESSING_INJECTION_KEY);\r\n\r\n// \u6548\u679C\r\nconst effect = ref<DepthOfFieldEffect | null>(null);\r\nconst effectPass = ref<EffectPass | null>(null);\r\n\r\n// \u521B\u5EFA\u6548\u679C\r\nconst createEffect = () => {\r\n  if (!camera.value || !renderer.value || !postProcessing?.composer) return;\r\n  \r\n  // \u521B\u5EFA\u666F\u6DF1\u6548\u679C\r\n  effect.value = new DepthOfFieldEffect(camera.value, {\r\n    focusDistance: props.focusDistance || 0.0,\r\n    focalLength: props.focalLength || 0.05,\r\n    bokehScale: props.bokehScale || 2.0,\r\n    height: props.height,\r\n    width: props.width,\r\n    blur: props.blur,\r\n    focus: props.focus,\r\n    dof: props.dof,\r\n    aperture: props.aperture,\r\n    maxBlur: props.maxBlur\r\n  });\r\n  \r\n  // \u521B\u5EFA\u6548\u679C\u901A\u9053\r\n  effectPass.value = new EffectPass(camera.value, effect.value);\r\n  effectPass.value.enabled = props.enabled !== false;\r\n  \r\n  // \u6DFB\u52A0\u5230\u5408\u6210\u5668\r\n  postProcessing.composer.addPass(effectPass.value);\r\n};\r\n\r\n// \u66F4\u65B0\u6548\u679C\u53C2\u6570\r\nconst updateEffect = () => {\r\n  if (!effect.value) return;\r\n  \r\n  if (props.focusDistance !== undefined) {\r\n    effect.value.focusDistance = props.focusDistance;\r\n  }\r\n  \r\n  if (props.focalLength !== undefined) {\r\n    effect.value.focalLength = props.focalLength;\r\n  }\r\n  \r\n  if (props.bokehScale !== undefined) {\r\n    effect.value.bokehScale = props.bokehScale;\r\n  }\r\n  \r\n  if (props.blur !== undefined) {\r\n    effect.value.blur = props.blur;\r\n  }\r\n  \r\n  if (props.focus !== undefined) {\r\n    effect.value.focus = props.focus;\r\n  }\r\n  \r\n  if (props.aperture !== undefined) {\r\n    effect.value.aperture = props.aperture;\r\n  }\r\n  \r\n  if (props.maxBlur !== undefined) {\r\n    effect.value.maxBlur = props.maxBlur;\r\n  }\r\n};\r\n\r\n// \u542F\u7528/\u7981\u7528\u6548\u679C\r\nconst setEnabled = (enabled: boolean) => {\r\n  if (effectPass.value) {\r\n    effectPass.value.enabled = enabled;\r\n  }\r\n};\r\n\r\n// \u76D1\u542C\u5C5E\u6027\u53D8\u5316\r\nwatch(() => props.enabled, (enabled) => {\r\n  setEnabled(enabled !== false);\r\n});\r\n\r\nwatch(\r\n  () => [\r\n    props.focusDistance,\r\n    props.focalLength,\r\n    props.bokehScale,\r\n    props.blur,\r\n    props.focus,\r\n    props.aperture,\r\n    props.maxBlur\r\n  ],\r\n  () => {\r\n    updateEffect();\r\n  }\r\n);\r\n\r\n// \u7EC4\u4EF6\u6302\u8F7D\u548C\u5378\u8F7D\r\nonMounted(() => {\r\n  createEffect();\r\n});\r\n\r\nonBeforeUnmount(() => {\r\n  // \u4ECE\u5408\u6210\u5668\u79FB\u9664\u6548\u679C\r\n  if (effectPass.value && postProcessing?.composer) {\r\n    postProcessing.composer.removePass(effectPass.value);\r\n  }\r\n});\r\n\r\n// \u66B4\u9732\u7EC4\u4EF6\u5185\u90E8\u72B6\u6001\u548C\u65B9\u6CD5\r\ndefineExpose({\r\n  effect,\r\n  effectPass,\r\n  setEnabled,\r\n  updateEffect\r\n});\r\n</script>\r\n\r\n<template>\r\n  <div>\r\n    <slot \r\n      :effect=\"effect\" \r\n      :effect-pass=\"effectPass\"\r\n      :set-enabled=\"setEnabled\"\r\n    ></slot>\r\n  </div>\r\n</template> ", "<script setup lang=\"ts\">\r\nimport { ref, onMounted, onBeforeUnmount, watch } from 'vue';\r\nimport { useFrame } from '../../composables/useFrame';\r\n\r\nconst props = defineProps<{\r\n  enabled?: boolean;\r\n  position?: 'top-left' | 'top-right' | 'bottom-left' | 'bottom-right';\r\n  showFps?: boolean;\r\n  showMs?: boolean;\r\n  showMem?: boolean;\r\n  showDrawCalls?: boolean;\r\n  showTriangles?: boolean;\r\n  bgColor?: string;\r\n  fgColor?: string;\r\n  width?: number;\r\n  height?: number;\r\n}>();\r\n\r\n// \u7EDF\u8BA1\u6570\u636E\r\nconst fps = ref<number>(0);\r\nconst ms = ref<number>(0);\r\nconst memory = ref<{\r\n  used: number;\r\n  total: number;\r\n  limit: number;\r\n}>({\r\n  used: 0,\r\n  total: 0,\r\n  limit: 0\r\n});\r\nconst drawCalls = ref<number>(0);\r\nconst triangles = ref<number>(0);\r\n\r\n// \u8BA1\u65F6\u5668\r\nconst frames = ref<number>(0);\r\nconst lastTime = ref<number>(performance.now());\r\nconst lastFpsUpdate = ref<number>(performance.now());\r\nconst container = ref<HTMLDivElement | null>(null);\r\nconst isEnabled = ref<boolean>(props.enabled !== false);\r\n\r\n// \u66F4\u65B0FPS\r\nconst updateFps = (time: number) => {\r\n  frames.value++;\r\n  \r\n  // \u6BCF\u79D2\u66F4\u65B0\u4E00\u6B21FPS\r\n  if (time - lastFpsUpdate.value >= 1000) {\r\n    fps.value = Math.round((frames.value * 1000) / (time - lastFpsUpdate.value));\r\n    frames.value = 0;\r\n    lastFpsUpdate.value = time;\r\n  }\r\n};\r\n\r\n// \u66F4\u65B0\u6E32\u67D3\u65F6\u95F4\r\nconst updateMs = (time: number, delta: number) => {\r\n  ms.value = delta * 1000; // \u8F6C\u6362\u4E3A\u6BEB\u79D2\r\n};\r\n\r\n// \u66F4\u65B0\u5185\u5B58\u4F7F\u7528\r\nconst updateMemory = () => {\r\n  if (window.performance && (performance as any).memory) {\r\n    const mem = (performance as any).memory;\r\n    memory.value = {\r\n      used: Math.round(mem.usedJSHeapSize / (1024 * 1024)),\r\n      total: Math.round(mem.totalJSHeapSize / (1024 * 1024)),\r\n      limit: Math.round(mem.jsHeapSizeLimit / (1024 * 1024))\r\n    };\r\n  }\r\n};\r\n\r\n// \u66F4\u65B0\u7ED8\u5236\u8C03\u7528\u548C\u4E09\u89D2\u5F62\u6570\u91CF\r\nconst updateDrawCalls = () => {\r\n  // \u8FD9\u90E8\u5206\u9700\u8981\u8BBF\u95EEThree.js\u7684\u6E32\u67D3\u5668\u4FE1\u606F\r\n  // \u5728\u5B9E\u9645\u5E94\u7528\u4E2D\uFF0C\u53EF\u4EE5\u901A\u8FC7useThree\u83B7\u53D6\u6E32\u67D3\u5668\r\n  // \u5E76\u8BBF\u95EErenderer.info.render.calls\u548Crenderer.info.render.triangles\r\n  // \u7531\u4E8E\u8FD9\u91CC\u6CA1\u6709\u76F4\u63A5\u8BBF\u95EE\u6E32\u67D3\u5668\uFF0C\u6211\u4EEC\u4F7F\u7528\u6A21\u62DF\u6570\u636E\r\n  drawCalls.value = Math.round(Math.random() * 100 + 100);\r\n  triangles.value = Math.round(Math.random() * 100000 + 50000);\r\n};\r\n\r\n// \u66F4\u65B0\u7EDF\u8BA1\u4FE1\u606F\r\nconst update = (time: number, delta: number) => {\r\n  if (!isEnabled.value) return;\r\n  \r\n  updateFps(time);\r\n  updateMs(time, delta);\r\n  \r\n  // \u6BCF\u79D2\u66F4\u65B0\u4E00\u6B21\u5185\u5B58\u548C\u7ED8\u5236\u4FE1\u606F\r\n  if (time - lastTime.value >= 1000) {\r\n    if (props.showMem) {\r\n      updateMemory();\r\n    }\r\n    \r\n    if (props.showDrawCalls || props.showTriangles) {\r\n      updateDrawCalls();\r\n    }\r\n    \r\n    lastTime.value = time;\r\n  }\r\n};\r\n\r\n// \u542F\u7528/\u7981\u7528\u7EDF\u8BA1\r\nconst setEnabled = (enabled: boolean) => {\r\n  isEnabled.value = enabled;\r\n  \r\n  if (container.value) {\r\n    container.value.style.display = enabled ? 'block' : 'none';\r\n  }\r\n};\r\n\r\n// \u76D1\u542C\u5C5E\u6027\u53D8\u5316\r\nwatch(() => props.enabled, (enabled) => {\r\n  setEnabled(enabled !== false);\r\n});\r\n\r\n// \u7EC4\u4EF6\u6302\u8F7D\u548C\u5378\u8F7D\r\nonMounted(() => {\r\n  // \u6DFB\u52A0\u5E27\u66F4\u65B0\r\n  useFrame(update);\r\n  \r\n  // \u521D\u59CB\u5316\u663E\u793A\u72B6\u6001\r\n  setEnabled(isEnabled.value);\r\n});\r\n\r\n// \u66B4\u9732\u7EC4\u4EF6\u5185\u90E8\u72B6\u6001\u548C\u65B9\u6CD5\r\ndefineExpose({\r\n  fps,\r\n  ms,\r\n  memory,\r\n  drawCalls,\r\n  triangles,\r\n  isEnabled,\r\n  setEnabled\r\n});\r\n\r\n// \u8BA1\u7B97\u4F4D\u7F6E\u6837\u5F0F\r\nconst positionStyle = () => {\r\n  switch (props.position) {\r\n    case 'top-right':\r\n      return { top: '0', right: '0' };\r\n    case 'bottom-left':\r\n      return { bottom: '0', left: '0' };\r\n    case 'bottom-right':\r\n      return { bottom: '0', right: '0' };\r\n    case 'top-left':\r\n    default:\r\n      return { top: '0', left: '0' };\r\n  }\r\n};\r\n</script>\r\n\r\n<template>\r\n  <div \r\n    ref=\"container\"\r\n    class=\"three-stats\"\r\n    :style=\"{\r\n      ...positionStyle(),\r\n      width: `${props.width || 80}px`,\r\n      backgroundColor: props.bgColor || 'rgba(0, 0, 0, 0.5)',\r\n      color: props.fgColor || '#fff'\r\n    }\"\r\n  >\r\n    <div v-if=\"props.showFps\" class=\"stat-item\">\r\n      <div class=\"stat-label\">FPS</div>\r\n      <div class=\"stat-value\">{{ fps }}</div>\r\n    </div>\r\n    <div v-if=\"props.showMs\" class=\"stat-item\">\r\n      <div class=\"stat-label\">MS</div>\r\n      <div class=\"stat-value\">{{ ms.toFixed(2) }}</div>\r\n    </div>\r\n    <div v-if=\"props.showMem\" class=\"stat-item\">\r\n      <div class=\"stat-label\">MEM</div>\r\n      <div class=\"stat-value\">{{ memory.used }}MB</div>\r\n    </div>\r\n    <div v-if=\"props.showDrawCalls\" class=\"stat-item\">\r\n      <div class=\"stat-label\">CALLS</div>\r\n      <div class=\"stat-value\">{{ drawCalls }}</div>\r\n    </div>\r\n    <div v-if=\"props.showTriangles\" class=\"stat-item\">\r\n      <div class=\"stat-label\">TRIS</div>\r\n      <div class=\"stat-value\">{{ (triangles / 1000).toFixed(1) }}k</div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n.three-stats {\r\n  position: absolute;\r\n  padding: 5px;\r\n  font-family: monospace;\r\n  font-size: 12px;\r\n  z-index: 1000;\r\n  pointer-events: none;\r\n  border-radius: 3px;\r\n}\r\n\r\n.stat-item {\r\n  margin-bottom: 2px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.stat-label {\r\n  font-weight: bold;\r\n  margin-right: 5px;\r\n}\r\n\r\n.stat-value {\r\n  text-align: right;\r\n}\r\n</style> ", "<script>\r\nimport { ref, onMounted, onBeforeUnmount, provide, watch, InjectionKey } from 'vue';\r\nimport { Raycaster, Vector2, Object3D, Intersection } from 'three';\r\nimport { useThree } from '../../composables/useThree';\r\nimport { useFrame } from '../../composables/useFrame';\r\nimport { throttle } from '../../utils';\r\nimport { RaycasterOptions, RaycasterEvent } from '../../types';\r\n\r\n// \u5C04\u7EBF\u4EA4\u4E92\u6CE8\u5165\u952E\r\nconst RAYCASTER_INJECTION_KEY = Symbol('raycaster');\r\n\r\nexport { RAYCASTER_INJECTION_KEY };\r\n\r\nexport default {\r\n  props: {\r\n    enabled: {\r\n      type: Boolean,\r\n      default: true\r\n    },\r\n    recursive: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    near: {\r\n      type: Number,\r\n      default: 0\r\n    },\r\n    far: {\r\n      type: Number,\r\n      default: Infinity\r\n    },\r\n    throttleMs: {\r\n      type: Number,\r\n      default: 0\r\n    },\r\n    layers: {\r\n      type: Number,\r\n      default: undefined\r\n    },\r\n    debug: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  emits: [\r\n    'click',\r\n    'dblclick',\r\n    'contextmenu',\r\n    'pointerdown',\r\n    'pointerup',\r\n    'pointermove',\r\n    'pointerenter',\r\n    'pointerleave',\r\n    'pointerover',\r\n    'pointerout',\r\n    'wheel',\r\n    'keydown',\r\n    'keyup',\r\n    'focus',\r\n    'blur',\r\n    'drag',\r\n    'dragstart',\r\n    'dragend',\r\n    'drop',\r\n    'intersect',\r\n    'intersectstart',\r\n    'intersectend'\r\n  ],\r\n  setup(props, { emit }) {\r\n    // \u5C04\u7EBF\u6295\u5C04\u5668\r\n    const raycaster = ref(new Raycaster(undefined, undefined, props.near, props.far));\r\n    \r\n    // \u9F20\u6807\u4F4D\u7F6E\r\n    const pointer = ref(new Vector2(-1, -1));\r\n    \r\n    // \u4EA4\u53C9\u7ED3\u679C\r\n    const intersections = ref([]);\r\n    \r\n    // \u4E0A\u4E00\u6B21\u4EA4\u53C9\u7684\u5BF9\u8C61\r\n    const previousIntersectedObjects = ref([]);\r\n    \r\n    // \u4EA4\u4E92\u5BF9\u8C61\r\n    const interactiveObjects = ref([]);\r\n    \r\n    // \u83B7\u53D6Three.js\u6838\u5FC3\u5BF9\u8C61\r\n    const { scene, camera, renderer } = useThree();\r\n    \r\n    // \u6DFB\u52A0\u4EA4\u4E92\u5BF9\u8C61\r\n    const addInteractiveObject = (object) => {\r\n      if (!interactiveObjects.value.includes(object)) {\r\n        interactiveObjects.value.push(object);\r\n        \r\n        if (props.debug) {\r\n          console.log('[Raycaster] Added interactive object:', object);\r\n        }\r\n      }\r\n    };\r\n    \r\n    // \u79FB\u9664\u4EA4\u4E92\u5BF9\u8C61\r\n    const removeInteractiveObject = (object) => {\r\n      const index = interactiveObjects.value.indexOf(object);\r\n      if (index !== -1) {\r\n        interactiveObjects.value.splice(index, 1);\r\n        \r\n        if (props.debug) {\r\n          console.log('[Raycaster] Removed interactive object:', object);\r\n        }\r\n      }\r\n    };\r\n    \r\n    // \u66F4\u65B0\u5C04\u7EBF\u6295\u5C04\u5668\r\n    const update = () => {\r\n      if (!camera.value || !props.enabled) return;\r\n      \r\n      // \u8BBE\u7F6E\u5C04\u7EBF\u6295\u5C04\u5668\u7684\u53C2\u6570\r\n      raycaster.value.near = props.near;\r\n      raycaster.value.far = props.far;\r\n      \r\n      // \u8BBE\u7F6E\u5C04\u7EBF\u6295\u5C04\u5668\u7684\u5C42\r\n      if (props.layers !== undefined) {\r\n        raycaster.value.layers.set(props.layers);\r\n      }\r\n      \r\n      // \u4ECE\u76F8\u673A\u548C\u9F20\u6807\u4F4D\u7F6E\u66F4\u65B0\u5C04\u7EBF\r\n      raycaster.value.setFromCamera(pointer.value, camera.value);\r\n      \r\n      // \u83B7\u53D6\u4EA4\u53C9\u7ED3\u679C\r\n      let objects = interactiveObjects.value.length > 0 ? interactiveObjects.value : scene.value ? [scene.value] : [];\r\n      intersections.value = raycaster.value.intersectObjects(objects, props.recursive);\r\n      \r\n      // \u5904\u7406\u4EA4\u53C9\u4E8B\u4EF6\r\n      handleIntersections();\r\n    };\r\n    \r\n    // \u8282\u6D41\u66F4\u65B0\u51FD\u6570\r\n    const throttledUpdate = props.throttleMs > 0 ? throttle(update, props.throttleMs) : update;\r\n    \r\n    // \u5904\u7406\u4EA4\u53C9\u4E8B\u4EF6\r\n    const handleIntersections = () => {\r\n      // \u83B7\u53D6\u5F53\u524D\u4EA4\u53C9\u7684\u5BF9\u8C61\r\n      const intersectedObjects = intersections.value.map(intersection => intersection.object);\r\n      \r\n      // \u67E5\u627E\u65B0\u4EA4\u53C9\u7684\u5BF9\u8C61\r\n      const newIntersectedObjects = intersectedObjects.filter(\r\n        object => !previousIntersectedObjects.value.includes(object)\r\n      );\r\n      \r\n      // \u67E5\u627E\u4E0D\u518D\u4EA4\u53C9\u7684\u5BF9\u8C61\r\n      const noLongerIntersectedObjects = previousIntersectedObjects.value.filter(\r\n        object => !intersectedObjects.includes(object)\r\n      );\r\n      \r\n      // \u89E6\u53D1\u5F00\u59CB\u4EA4\u53C9\u4E8B\u4EF6\r\n      if (newIntersectedObjects.length > 0) {\r\n        emit('intersectstart', {\r\n          objects: newIntersectedObjects,\r\n          intersections: intersections.value.filter(\r\n            intersection => newIntersectedObjects.includes(intersection.object)\r\n          )\r\n        });\r\n      }\r\n      \r\n      // \u89E6\u53D1\u7ED3\u675F\u4EA4\u53C9\u4E8B\u4EF6\r\n      if (noLongerIntersectedObjects.length > 0) {\r\n        emit('intersectend', {\r\n          objects: noLongerIntersectedObjects\r\n        });\r\n      }\r\n      \r\n      // \u89E6\u53D1\u4EA4\u53C9\u4E8B\u4EF6\r\n      if (intersections.value.length > 0) {\r\n        emit('intersect', {\r\n          intersections: intersections.value\r\n        });\r\n      }\r\n      \r\n      // \u66F4\u65B0\u4E0A\u4E00\u6B21\u4EA4\u53C9\u7684\u5BF9\u8C61\r\n      previousIntersectedObjects.value = [...intersectedObjects];\r\n    };\r\n    \r\n    // \u5904\u7406\u9F20\u6807\u4E8B\u4EF6\r\n    const handlePointerEvent = (event) => {\r\n      if (!renderer.value || !props.enabled) return;\r\n      \r\n      // \u8BA1\u7B97\u5F52\u4E00\u5316\u7684\u8BBE\u5907\u5750\u6807\r\n      const canvas = renderer.value.domElement;\r\n      const rect = canvas.getBoundingClientRect();\r\n      const x = ((event.clientX - rect.left) / canvas.clientWidth) * 2 - 1;\r\n      const y = -((event.clientY - rect.top) / canvas.clientHeight) * 2 + 1;\r\n      \r\n      // \u66F4\u65B0\u9F20\u6807\u4F4D\u7F6E\r\n      pointer.value.set(x, y);\r\n      \r\n      // \u66F4\u65B0\u5C04\u7EBF\u6295\u5C04\u5668\r\n      throttledUpdate();\r\n      \r\n      // \u5982\u679C\u6709\u4EA4\u53C9\u7ED3\u679C\uFF0C\u89E6\u53D1\u4E8B\u4EF6\r\n      if (intersections.value.length > 0) {\r\n        emit(event.type, {\r\n          event,\r\n          intersections: intersections.value\r\n        });\r\n      }\r\n    };\r\n    \r\n    // \u76D1\u542C\u5C5E\u6027\u53D8\u5316\r\n    watch(() => props.enabled, (enabled) => {\r\n      if (enabled) {\r\n        // \u6DFB\u52A0\u4E8B\u4EF6\u76D1\u542C\r\n        if (renderer.value) {\r\n          const canvas = renderer.value.domElement;\r\n          canvas.addEventListener('click', handlePointerEvent);\r\n          canvas.addEventListener('dblclick', handlePointerEvent);\r\n          canvas.addEventListener('contextmenu', handlePointerEvent);\r\n          canvas.addEventListener('pointerdown', handlePointerEvent);\r\n          canvas.addEventListener('pointerup', handlePointerEvent);\r\n          canvas.addEventListener('pointermove', handlePointerEvent);\r\n          canvas.addEventListener('pointerenter', handlePointerEvent);\r\n          canvas.addEventListener('pointerleave', handlePointerEvent);\r\n          canvas.addEventListener('wheel', handlePointerEvent);\r\n        }\r\n      } else {\r\n        // \u79FB\u9664\u4E8B\u4EF6\u76D1\u542C\r\n        if (renderer.value) {\r\n          const canvas = renderer.value.domElement;\r\n          canvas.removeEventListener('click', handlePointerEvent);\r\n          canvas.removeEventListener('dblclick', handlePointerEvent);\r\n          canvas.removeEventListener('contextmenu', handlePointerEvent);\r\n          canvas.removeEventListener('pointerdown', handlePointerEvent);\r\n          canvas.removeEventListener('pointerup', handlePointerEvent);\r\n          canvas.removeEventListener('pointermove', handlePointerEvent);\r\n          canvas.removeEventListener('pointerenter', handlePointerEvent);\r\n          canvas.removeEventListener('pointerleave', handlePointerEvent);\r\n          canvas.removeEventListener('wheel', handlePointerEvent);\r\n        }\r\n      }\r\n    });\r\n    \r\n    // \u7EC4\u4EF6\u6302\u8F7D\u548C\u5378\u8F7D\r\n    onMounted(() => {\r\n      // \u63D0\u4F9B\u5C04\u7EBF\u6295\u5C04\u5668\u4E0A\u4E0B\u6587\r\n      provide(RAYCASTER_INJECTION_KEY, {\r\n        raycaster: raycaster.value,\r\n        intersections: intersections.value,\r\n        pointer: pointer.value,\r\n        addInteractiveObject,\r\n        removeInteractiveObject\r\n      });\r\n      \r\n      // \u6DFB\u52A0\u4E8B\u4EF6\u76D1\u542C\r\n      if (props.enabled && renderer.value) {\r\n        const canvas = renderer.value.domElement;\r\n        canvas.addEventListener('click', handlePointerEvent);\r\n        canvas.addEventListener('dblclick', handlePointerEvent);\r\n        canvas.addEventListener('contextmenu', handlePointerEvent);\r\n        canvas.addEventListener('pointerdown', handlePointerEvent);\r\n        canvas.addEventListener('pointerup', handlePointerEvent);\r\n        canvas.addEventListener('pointermove', handlePointerEvent);\r\n        canvas.addEventListener('pointerenter', handlePointerEvent);\r\n        canvas.addEventListener('pointerleave', handlePointerEvent);\r\n        canvas.addEventListener('wheel', handlePointerEvent);\r\n      }\r\n      \r\n      // \u6DFB\u52A0\u5E27\u66F4\u65B0\r\n      useFrame(throttledUpdate);\r\n    });\r\n    \r\n    onBeforeUnmount(() => {\r\n      // \u79FB\u9664\u4E8B\u4EF6\u76D1\u542C\r\n      if (renderer.value) {\r\n        const canvas = renderer.value.domElement;\r\n        canvas.removeEventListener('click', handlePointerEvent);\r\n        canvas.removeEventListener('dblclick', handlePointerEvent);\r\n        canvas.removeEventListener('contextmenu', handlePointerEvent);\r\n        canvas.removeEventListener('pointerdown', handlePointerEvent);\r\n        canvas.removeEventListener('pointerup', handlePointerEvent);\r\n        canvas.removeEventListener('pointermove', handlePointerEvent);\r\n        canvas.removeEventListener('pointerenter', handlePointerEvent);\r\n        canvas.removeEventListener('pointerleave', handlePointerEvent);\r\n        canvas.removeEventListener('wheel', handlePointerEvent);\r\n      }\r\n      \r\n      // \u6E05\u7406\u5F15\u7528\r\n      interactiveObjects.value = [];\r\n      previousIntersectedObjects.value = [];\r\n      intersections.value = [];\r\n    });\r\n    \r\n    return {\r\n      raycaster,\r\n      pointer,\r\n      intersections,\r\n      interactiveObjects,\r\n      addInteractiveObject,\r\n      removeInteractiveObject,\r\n      update,\r\n      throttledUpdate\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<template>\r\n  <div class=\"three-raycaster\">\r\n    <slot \r\n      :raycaster=\"raycaster\"\r\n      :pointer=\"pointer\"\r\n      :intersections=\"intersections\"\r\n      :interactive-objects=\"interactiveObjects\"\r\n      :add-interactive-object=\"addInteractiveObject\"\r\n      :remove-interactive-object=\"removeInteractiveObject\"\r\n    ></slot>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n.three-raycaster {\r\n  display: contents;\r\n}\r\n</style> ", "<script setup lang=\"ts\">\r\nimport { ref, watch, onMounted, onBeforeUnmount, inject } from 'vue';\r\nimport { Object3D, Material, Color, Vector3 } from 'three';\r\nimport { injectThreeParent } from '../../composables';\r\nimport { RAYCASTER_INJECTION_KEY } from './ThreeRaycaster.vue';\r\nimport { InteractiveOptions } from '../../types';\r\nimport { findMaterials } from '../../utils';\r\n\r\nconst props = defineProps<{\r\n  enabled?: boolean;\r\n  cursor?: string;\r\n  hoverColor?: string;\r\n  activeColor?: string;\r\n  hoverScale?: number;\r\n  activeScale?: number;\r\n  hoverOpacity?: number;\r\n  activeOpacity?: number;\r\n}>();\r\n\r\nconst emit = defineEmits<{\r\n  click: [event: any];\r\n  hover: [event: any];\r\n  pointerdown: [event: any];\r\n  pointerup: [event: any];\r\n  pointerenter: [event: any];\r\n  pointerleave: [event: any];\r\n}>();\r\n\r\n// \u83B7\u53D6\u7236\u5BF9\u8C61\u548C\u5C04\u7EBF\u4EA4\u4E92\u7CFB\u7EDF\r\nconst parent = injectThreeParent();\r\nconst raycaster = inject(RAYCASTER_INJECTION_KEY);\r\n\r\n// \u72B6\u6001\r\nconst isHovered = ref(false);\r\nconst isActive = ref(false);\r\nconst originalCursor = ref('');\r\nconst originalColors = ref<Map<Material, Color>>(new Map());\r\nconst originalScale = ref<Vector3 | null>(null);\r\nconst originalOpacities = ref<Map<Material, number>>(new Map());\r\nconst materials = ref<Material[]>([]);\r\n\r\n// \u5904\u7406\u60AC\u505C\u4E8B\u4EF6\r\nconst handlePointerEnter = (event: any) => {\r\n  if (!props.enabled) return;\r\n  \r\n  isHovered.value = true;\r\n  \r\n  // \u66F4\u6539\u9F20\u6807\u6837\u5F0F\r\n  if (props.cursor && typeof document !== 'undefined') {\r\n    originalCursor.value = document.body.style.cursor;\r\n    document.body.style.cursor = props.cursor;\r\n  }\r\n  \r\n  // \u5E94\u7528\u60AC\u505C\u6548\u679C\r\n  applyHoverEffect();\r\n  \r\n  emit('pointerenter', event);\r\n};\r\n\r\n// \u5904\u7406\u79BB\u5F00\u4E8B\u4EF6\r\nconst handlePointerLeave = (event: any) => {\r\n  if (!props.enabled) return;\r\n  \r\n  isHovered.value = false;\r\n  \r\n  // \u6062\u590D\u9F20\u6807\u6837\u5F0F\r\n  if (props.cursor && typeof document !== 'undefined') {\r\n    document.body.style.cursor = originalCursor.value;\r\n  }\r\n  \r\n  // \u6062\u590D\u539F\u59CB\u6548\u679C\r\n  if (!isActive.value) {\r\n    resetEffects();\r\n  }\r\n  \r\n  emit('pointerleave', event);\r\n};\r\n\r\n// \u5904\u7406\u70B9\u51FB\u4E8B\u4EF6\r\nconst handleClick = (event: any) => {\r\n  if (!props.enabled) return;\r\n  \r\n  emit('click', event);\r\n};\r\n\r\n// \u5904\u7406\u6309\u4E0B\u4E8B\u4EF6\r\nconst handlePointerDown = (event: any) => {\r\n  if (!props.enabled) return;\r\n  \r\n  isActive.value = true;\r\n  \r\n  // \u5E94\u7528\u6FC0\u6D3B\u6548\u679C\r\n  applyActiveEffect();\r\n  \r\n  emit('pointerdown', event);\r\n};\r\n\r\n// \u5904\u7406\u91CA\u653E\u4E8B\u4EF6\r\nconst handlePointerUp = (event: any) => {\r\n  if (!props.enabled) return;\r\n  \r\n  isActive.value = false;\r\n  \r\n  // \u5982\u679C\u4ECD\u7136\u60AC\u505C\uFF0C\u5E94\u7528\u60AC\u505C\u6548\u679C\uFF0C\u5426\u5219\u91CD\u7F6E\r\n  if (isHovered.value) {\r\n    applyHoverEffect();\r\n  } else {\r\n    resetEffects();\r\n  }\r\n  \r\n  emit('pointerup', event);\r\n};\r\n\r\n// \u521D\u59CB\u5316\u6750\u8D28\r\nconst initMaterials = () => {\r\n  if (!parent.value) return;\r\n  \r\n  // \u67E5\u627E\u5BF9\u8C61\u7684\u6240\u6709\u6750\u8D28\r\n  materials.value = findMaterials(parent.value);\r\n  \r\n  // \u4FDD\u5B58\u539F\u59CB\u989C\u8272\u548C\u4E0D\u900F\u660E\u5EA6\r\n  materials.value.forEach(material => {\r\n    if (material.color) {\r\n      originalColors.value.set(material, material.color.clone());\r\n    }\r\n    if ('opacity' in material) {\r\n      originalOpacities.value.set(material, material.opacity);\r\n    }\r\n  });\r\n  \r\n  // \u4FDD\u5B58\u539F\u59CB\u7F29\u653E\r\n  if (parent.value.scale) {\r\n    originalScale.value = parent.value.scale.clone();\r\n  }\r\n};\r\n\r\n// \u5E94\u7528\u60AC\u505C\u6548\u679C\r\nconst applyHoverEffect = () => {\r\n  if (!parent.value) return;\r\n  \r\n  // \u5E94\u7528\u60AC\u505C\u989C\u8272\r\n  if (props.hoverColor && materials.value.length > 0) {\r\n    materials.value.forEach(material => {\r\n      if (material.color) {\r\n        material.color.set(props.hoverColor!);\r\n      }\r\n    });\r\n  }\r\n  \r\n  // \u5E94\u7528\u60AC\u505C\u7F29\u653E\r\n  if (props.hoverScale !== undefined && props.hoverScale !== 1 && originalScale.value) {\r\n    parent.value.scale.set(\r\n      originalScale.value.x * props.hoverScale,\r\n      originalScale.value.y * props.hoverScale,\r\n      originalScale.value.z * props.hoverScale\r\n    );\r\n  }\r\n  \r\n  // \u5E94\u7528\u60AC\u505C\u900F\u660E\u5EA6\r\n  if (props.hoverOpacity !== undefined && props.hoverOpacity !== 1) {\r\n    materials.value.forEach(material => {\r\n      if ('opacity' in material) {\r\n        material.opacity = props.hoverOpacity!;\r\n        if (props.hoverOpacity! < 1 && 'transparent' in material) {\r\n          material.transparent = true;\r\n        }\r\n      }\r\n    });\r\n  }\r\n};\r\n\r\n// \u5E94\u7528\u6FC0\u6D3B\u6548\u679C\r\nconst applyActiveEffect = () => {\r\n  if (!parent.value) return;\r\n  \r\n  // \u5E94\u7528\u6FC0\u6D3B\u989C\u8272\r\n  if (props.activeColor && materials.value.length > 0) {\r\n    materials.value.forEach(material => {\r\n      if (material.color) {\r\n        material.color.set(props.activeColor!);\r\n      }\r\n    });\r\n  }\r\n  \r\n  // \u5E94\u7528\u6FC0\u6D3B\u7F29\u653E\r\n  if (props.activeScale !== undefined && props.activeScale !== 1 && originalScale.value) {\r\n    parent.value.scale.set(\r\n      originalScale.value.x * props.activeScale,\r\n      originalScale.value.y * props.activeScale,\r\n      originalScale.value.z * props.activeScale\r\n    );\r\n  }\r\n  \r\n  // \u5E94\u7528\u6FC0\u6D3B\u900F\u660E\u5EA6\r\n  if (props.activeOpacity !== undefined && props.activeOpacity !== 1) {\r\n    materials.value.forEach(material => {\r\n      if ('opacity' in material) {\r\n        material.opacity = props.activeOpacity!;\r\n        if (props.activeOpacity! < 1 && 'transparent' in material) {\r\n          material.transparent = true;\r\n        }\r\n      }\r\n    });\r\n  }\r\n};\r\n\r\n// \u91CD\u7F6E\u6548\u679C\r\nconst resetEffects = () => {\r\n  if (!parent.value) return;\r\n  \r\n  // \u91CD\u7F6E\u989C\u8272\r\n  materials.value.forEach(material => {\r\n    if (material.color) {\r\n      const originalColor = originalColors.value.get(material);\r\n      if (originalColor) {\r\n        material.color.copy(originalColor);\r\n      }\r\n    }\r\n  });\r\n  \r\n  // \u91CD\u7F6E\u7F29\u653E\r\n  if (originalScale.value && parent.value.scale) {\r\n    parent.value.scale.copy(originalScale.value);\r\n  }\r\n  \r\n  // \u91CD\u7F6E\u900F\u660E\u5EA6\r\n  materials.value.forEach(material => {\r\n    if ('opacity' in material) {\r\n      const originalOpacity = originalOpacities.value.get(material);\r\n      if (originalOpacity !== undefined) {\r\n        material.opacity = originalOpacity;\r\n        if (originalOpacity >= 1 && 'transparent' in material) {\r\n          material.transparent = false;\r\n        }\r\n      }\r\n    }\r\n  });\r\n};\r\n\r\n// \u7EC4\u4EF6\u6302\u8F7D\u548C\u5378\u8F7D\r\nonMounted(() => {\r\n  if (parent.value && raycaster) {\r\n    // \u521D\u59CB\u5316\u6750\u8D28\r\n    initMaterials();\r\n    \r\n    // \u6CE8\u518C\u4E3A\u4EA4\u4E92\u5BF9\u8C61\r\n    raycaster.addInteractiveObject(parent.value);\r\n    \r\n    // \u6DFB\u52A0\u4E8B\u4EF6\u76D1\u542C\r\n    parent.value.addEventListener('click', handleClick);\r\n    parent.value.addEventListener('pointerenter', handlePointerEnter);\r\n    parent.value.addEventListener('pointerleave', handlePointerLeave);\r\n    parent.value.addEventListener('pointerdown', handlePointerDown);\r\n    parent.value.addEventListener('pointerup', handlePointerUp);\r\n  }\r\n});\r\n\r\nonBeforeUnmount(() => {\r\n  if (parent.value && raycaster) {\r\n    // \u79FB\u9664\u4EA4\u4E92\u5BF9\u8C61\r\n    raycaster.removeInteractiveObject(parent.value);\r\n    \r\n    // \u79FB\u9664\u4E8B\u4EF6\u76D1\u542C\r\n    parent.value.removeEventListener('click', handleClick);\r\n    parent.value.removeEventListener('pointerenter', handlePointerEnter);\r\n    parent.value.removeEventListener('pointerleave', handlePointerLeave);\r\n    parent.value.removeEventListener('pointerdown', handlePointerDown);\r\n    parent.value.removeEventListener('pointerup', handlePointerUp);\r\n    \r\n    // \u91CD\u7F6E\u6548\u679C\r\n    resetEffects();\r\n    \r\n    // \u91CD\u7F6E\u9F20\u6807\u6837\u5F0F\r\n    if (props.cursor && typeof document !== 'undefined') {\r\n      document.body.style.cursor = originalCursor.value;\r\n    }\r\n  }\r\n});\r\n\r\n// \u76D1\u542C\u5C5E\u6027\u53D8\u5316\r\nwatch(() => props.enabled, (enabled) => {\r\n  if (!enabled) {\r\n    // \u5982\u679C\u7981\u7528\uFF0C\u91CD\u7F6E\u6548\u679C\r\n    resetEffects();\r\n    \r\n    // \u91CD\u7F6E\u9F20\u6807\u6837\u5F0F\r\n    if (props.cursor && typeof document !== 'undefined' && isHovered.value) {\r\n      document.body.style.cursor = originalCursor.value;\r\n    }\r\n    \r\n    isHovered.value = false;\r\n    isActive.value = false;\r\n  }\r\n});\r\n\r\n// \u76D1\u542C\u7236\u5BF9\u8C61\u53D8\u5316\r\nwatch(() => parent.value, (newParent) => {\r\n  if (newParent) {\r\n    initMaterials();\r\n  }\r\n});\r\n\r\n// \u66B4\u9732\u7EC4\u4EF6\u5185\u90E8\u72B6\u6001\r\ndefineExpose({\r\n  isHovered,\r\n  isActive,\r\n  materials\r\n});\r\n</script>\r\n\r\n<template>\r\n  <div>\r\n    <slot :is-hovered=\"isHovered\" :is-active=\"isActive\"></slot>\r\n  </div>\r\n</template> ", "import {\r\n  Texture,\r\n  Material,\r\n  BufferGeometry,\r\n  Object3D,\r\n  Scene,\r\n  Vector3,\r\n  Quaternion,\r\n  Euler,\r\n  Color,\r\n  Box3,\r\n  Sphere\r\n} from 'three';\r\nimport { Vector3Tuple, ColorValue } from '../types';\r\n\r\n/**\r\n * \u68C0\u67E5\u6D4F\u89C8\u5668\u662F\u5426\u652F\u6301WebGPU\r\n * @returns Promise<boolean> \u662F\u5426\u652F\u6301WebGPU\r\n */\r\nexport const isWebGPUSupported = async (): Promise<boolean> => {\r\n  if (!navigator.gpu) {\r\n    return false;\r\n  }\r\n\r\n  try {\r\n    const adapter = await navigator.gpu.requestAdapter();\r\n    if (!adapter) {\r\n      return false;\r\n    }\r\n    return true;\r\n  } catch (error) {\r\n    console.error('WebGPU support check failed:', error);\r\n    return false;\r\n  }\r\n};\r\n\r\n/**\r\n * \u91CA\u653EThree.js\u5BF9\u8C61\u53CA\u5176\u5B50\u5BF9\u8C61\r\n * @param object Three.js\u5BF9\u8C61\r\n */\r\nexport const disposeObject = (object: Object3D): void => {\r\n  // \u904D\u5386\u5B50\u5BF9\u8C61\r\n  object.traverse((child) => {\r\n    // \u91CA\u653E\u51E0\u4F55\u4F53\r\n    if ((child as any).geometry) {\r\n      (child as any).geometry.dispose();\r\n    }\r\n\r\n    // \u91CA\u653E\u6750\u8D28\r\n    if ((child as any).material) {\r\n      disposeMaterial((child as any).material);\r\n    }\r\n  });\r\n\r\n  // \u4ECE\u7236\u5BF9\u8C61\u4E2D\u79FB\u9664\r\n  if (object.parent) {\r\n    object.parent.remove(object);\r\n  }\r\n};\r\n\r\n/**\r\n * \u91CA\u653E\u6750\u8D28\u53CA\u5176\u7EB9\u7406\r\n * @param material Three.js\u6750\u8D28\r\n */\r\nexport const disposeMaterial = (material: Material | Material[]): void => {\r\n  if (Array.isArray(material)) {\r\n    // \u5904\u7406\u6750\u8D28\u6570\u7EC4\r\n    material.forEach(disposeMaterial);\r\n    return;\r\n  }\r\n\r\n  // \u91CA\u653E\u7EB9\u7406\r\n  Object.keys(material).forEach((key) => {\r\n    const value = (material as any)[key];\r\n    if (value && value.isTexture) {\r\n      value.dispose();\r\n    }\r\n  });\r\n\r\n  // \u91CA\u653E\u6750\u8D28\r\n  material.dispose();\r\n};\r\n\r\n/**\r\n * \u9632\u6296\u51FD\u6570\r\n * @param fn \u8981\u9632\u6296\u7684\u51FD\u6570\r\n * @param delay \u5EF6\u8FDF\u65F6\u95F4\uFF08\u6BEB\u79D2\uFF09\r\n * @returns \u9632\u6296\u540E\u7684\u51FD\u6570\r\n */\r\nexport const debounce = <T extends (...args: any[]) => any>(\r\n  fn: T,\r\n  delay: number\r\n): ((...args: Parameters<T>) => void) => {\r\n  let timer: number | null = null;\r\n  return (...args: Parameters<T>) => {\r\n    if (timer !== null) {\r\n      clearTimeout(timer);\r\n    }\r\n    timer = window.setTimeout(() => {\r\n      fn(...args);\r\n    }, delay);\r\n  };\r\n};\r\n\r\n/**\r\n * \u8282\u6D41\u51FD\u6570\r\n * @param fn \u8981\u8282\u6D41\u7684\u51FD\u6570\r\n * @param limit \u9650\u5236\u65F6\u95F4\uFF08\u6BEB\u79D2\uFF09\r\n * @returns \u8282\u6D41\u540E\u7684\u51FD\u6570\r\n */\r\nexport const throttle = <T extends (...args: any[]) => any>(\r\n  fn: T,\r\n  limit: number\r\n): ((...args: Parameters<T>) => void) => {\r\n  let lastCall = 0;\r\n  return (...args: Parameters<T>) => {\r\n    const now = Date.now();\r\n    if (now - lastCall >= limit) {\r\n      lastCall = now;\r\n      fn(...args);\r\n    }\r\n  };\r\n};\r\n\r\n/**\r\n * \u7B80\u5355\u5BF9\u8C61\u6C60\r\n */\r\nexport class ObjectPool<T> {\r\n  private pool: T[] = [];\r\n  private createFn: () => T;\r\n  private resetFn: (obj: T) => void;\r\n  private maxSize: number;\r\n\r\n  /**\r\n   * \u521B\u5EFA\u5BF9\u8C61\u6C60\r\n   * @param createFn \u521B\u5EFA\u5BF9\u8C61\u7684\u51FD\u6570\r\n   * @param resetFn \u91CD\u7F6E\u5BF9\u8C61\u7684\u51FD\u6570\r\n   * @param initialSize \u521D\u59CB\u5927\u5C0F\r\n   * @param maxSize \u6700\u5927\u5927\u5C0F\r\n   */\r\n  constructor(\r\n    createFn: () => T,\r\n    resetFn: (obj: T) => void,\r\n    initialSize = 0,\r\n    maxSize = 100\r\n  ) {\r\n    this.createFn = createFn;\r\n    this.resetFn = resetFn;\r\n    this.maxSize = maxSize;\r\n\r\n    // \u9884\u521B\u5EFA\u5BF9\u8C61\r\n    for (let i = 0; i < initialSize; i++) {\r\n      this.pool.push(this.createFn());\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \u4ECE\u5BF9\u8C61\u6C60\u83B7\u53D6\u5BF9\u8C61\r\n   * @returns \u5BF9\u8C61\r\n   */\r\n  get(): T {\r\n    if (this.pool.length > 0) {\r\n      return this.pool.pop() as T;\r\n    }\r\n    return this.createFn();\r\n  }\r\n\r\n  /**\r\n   * \u5C06\u5BF9\u8C61\u5F52\u8FD8\u5230\u5BF9\u8C61\u6C60\r\n   * @param obj \u8981\u5F52\u8FD8\u7684\u5BF9\u8C61\r\n   */\r\n  release(obj: T): void {\r\n    if (this.pool.length < this.maxSize) {\r\n      this.resetFn(obj);\r\n      this.pool.push(obj);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * \u6E05\u7A7A\u5BF9\u8C61\u6C60\r\n   */\r\n  clear(): void {\r\n    this.pool = [];\r\n  }\r\n\r\n  /**\r\n   * \u83B7\u53D6\u5BF9\u8C61\u6C60\u5927\u5C0F\r\n   * @returns \u5BF9\u8C61\u6C60\u5927\u5C0F\r\n   */\r\n  size(): number {\r\n    return this.pool.length;\r\n  }\r\n}\r\n\r\n/**\r\n * \u751F\u6210UUID\r\n * @returns UUID\u5B57\u7B26\u4E32\r\n */\r\nexport const generateUUID = (): string => {\r\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\r\n    const r = (Math.random() * 16) | 0;\r\n    const v = c === 'x' ? r : (r & 0x3) | 0x8;\r\n    return v.toString(16);\r\n  });\r\n};\r\n\r\n/**\r\n * \u68C0\u6D4BWebWorker\u652F\u6301\r\n * @returns \u662F\u5426\u652F\u6301WebWorker\r\n */\r\nexport const isWebWorkerSupported = (): boolean => {\r\n  return typeof Worker !== 'undefined';\r\n};\r\n\r\n/**\r\n * \u68C0\u6D4BWebAssembly\u652F\u6301\r\n * @returns \u662F\u5426\u652F\u6301WebAssembly\r\n */\r\nexport const isWebAssemblySupported = (): boolean => {\r\n  return typeof WebAssembly === 'object' && \r\n    typeof WebAssembly.compile === 'function' &&\r\n    typeof WebAssembly.instantiate === 'function';\r\n};\r\n\r\n/**\r\n * \u68C0\u6D4BSharedArrayBuffer\u652F\u6301\r\n * @returns \u662F\u5426\u652F\u6301SharedArrayBuffer\r\n */\r\nexport const isSharedArrayBufferSupported = (): boolean => {\r\n  return typeof SharedArrayBuffer !== 'undefined';\r\n};\r\n\r\n/**\r\n * \u83B7\u53D6\u8BBE\u5907\u6027\u80FD\u7EA7\u522B\uFF08\u7B80\u5355\u4F30\u8BA1\uFF09\r\n * @returns \u6027\u80FD\u7EA7\u522B\uFF1A'low' | 'medium' | 'high'\r\n */\r\nexport const getDevicePerformanceLevel = (): 'low' | 'medium' | 'high' => {\r\n  // \u68C0\u67E5\u786C\u4EF6\u5E76\u53D1\u6570\r\n  const concurrency = navigator.hardwareConcurrency || 1;\r\n  \r\n  // \u68C0\u67E5\u8BBE\u5907\u5185\u5B58\uFF08\u5982\u679C\u53EF\u7528\uFF09\r\n  const memory = (navigator as any).deviceMemory || 4;\r\n  \r\n  if (concurrency >= 8 && memory >= 8) {\r\n    return 'high';\r\n  } else if (concurrency >= 4 && memory >= 4) {\r\n    return 'medium';\r\n  } else {\r\n    return 'low';\r\n  }\r\n};\r\n\r\n/**\r\n * \u6839\u636E\u6027\u80FD\u7EA7\u522B\u83B7\u53D6\u63A8\u8350\u7684\u6E32\u67D3\u8D28\u91CF\u8BBE\u7F6E\r\n * @param performanceLevel \u6027\u80FD\u7EA7\u522B\r\n * @returns \u6E32\u67D3\u8D28\u91CF\u8BBE\u7F6E\r\n */\r\nexport const getRenderQualitySettings = (performanceLevel: 'low' | 'medium' | 'high') => {\r\n  switch (performanceLevel) {\r\n    case 'high':\r\n      return {\r\n        shadows: true,\r\n        shadowMapSize: 2048,\r\n        antialias: true,\r\n        physicallyCorrectLights: true,\r\n        maxLights: 8,\r\n        particleCount: 10000,\r\n        textureSize: 2048,\r\n        geometryDetail: 'high',\r\n        postProcessing: true\r\n      };\r\n    case 'medium':\r\n      return {\r\n        shadows: true,\r\n        shadowMapSize: 1024,\r\n        antialias: true,\r\n        physicallyCorrectLights: false,\r\n        maxLights: 4,\r\n        particleCount: 5000,\r\n        textureSize: 1024,\r\n        geometryDetail: 'medium',\r\n        postProcessing: true\r\n      };\r\n    case 'low':\r\n    default:\r\n      return {\r\n        shadows: false,\r\n        shadowMapSize: 512,\r\n        antialias: false,\r\n        physicallyCorrectLights: false,\r\n        maxLights: 2,\r\n        particleCount: 1000,\r\n        textureSize: 512,\r\n        geometryDetail: 'low',\r\n        postProcessing: false\r\n      };\r\n  }\r\n};\r\n\r\n/**\r\n * \u5C06\u5341\u516D\u8FDB\u5236\u989C\u8272\u8F6C\u6362\u4E3ARGB\u6570\u7EC4\r\n * @param hex \u5341\u516D\u8FDB\u5236\u989C\u8272\r\n * @returns RGB\u6570\u7EC4 [r, g, b]\uFF0C\u8303\u56F40-1\r\n */\r\nexport const hexToRgb = (hex: number): [number, number, number] => {\r\n  const r = ((hex >> 16) & 255) / 255;\r\n  const g = ((hex >> 8) & 255) / 255;\r\n  const b = (hex & 255) / 255;\r\n  return [r, g, b];\r\n};\r\n\r\n/**\r\n * \u5C06RGB\u6570\u7EC4\u8F6C\u6362\u4E3A\u5341\u516D\u8FDB\u5236\u989C\u8272\r\n * @param rgb RGB\u6570\u7EC4 [r, g, b]\uFF0C\u8303\u56F40-1\r\n * @returns \u5341\u516D\u8FDB\u5236\u989C\u8272\r\n */\r\nexport const rgbToHex = (rgb: [number, number, number]): number => {\r\n  const r = Math.round(rgb[0] * 255);\r\n  const g = Math.round(rgb[1] * 255);\r\n  const b = Math.round(rgb[2] * 255);\r\n  return (r << 16) + (g << 8) + b;\r\n};\r\n\r\n/**\r\n * \u7EBF\u6027\u63D2\u503C\r\n * @param a \u8D77\u59CB\u503C\r\n * @param b \u7ED3\u675F\u503C\r\n * @param t \u63D2\u503C\u56E0\u5B50\uFF080-1\uFF09\r\n * @returns \u63D2\u503C\u7ED3\u679C\r\n */\r\nexport const lerp = (a: number, b: number, t: number): number => {\r\n  return a + (b - a) * t;\r\n};\r\n\r\n/**\r\n * \u5939\u7D27\u503C\u5230\u6307\u5B9A\u8303\u56F4\r\n * @param value \u8981\u5939\u7D27\u7684\u503C\r\n * @param min \u6700\u5C0F\u503C\r\n * @param max \u6700\u5927\u503C\r\n * @returns \u5939\u7D27\u540E\u7684\u503C\r\n */\r\nexport const clamp = (value: number, min: number, max: number): number => {\r\n  return Math.max(min, Math.min(max, value));\r\n};\r\n\r\n/**\r\n * \u5C06\u89D2\u5EA6\u4ECE\u5F27\u5EA6\u8F6C\u6362\u4E3A\u5EA6\r\n * @param radians \u5F27\u5EA6\r\n * @returns \u5EA6\r\n */\r\nexport const radiansToDegrees = (radians: number): number => {\r\n  return radians * (180 / Math.PI);\r\n};\r\n\r\n/**\r\n * \u5C06\u89D2\u5EA6\u4ECE\u5EA6\u8F6C\u6362\u4E3A\u5F27\u5EA6\r\n * @param degrees \u5EA6\r\n * @returns \u5F27\u5EA6\r\n */\r\nexport const degreesToRadians = (degrees: number): number => {\r\n  return degrees * (Math.PI / 180);\r\n};\r\n\r\n/**\r\n * \u5C06\u6570\u7EC4\u8F6C\u6362\u4E3AVector3\r\n * @param arr \u6570\u7EC4[x, y, z]\r\n * @returns Vector3\r\n */\r\nexport function arrayToVector3(arr?: Vector3Tuple | number[]): Vector3 {\r\n  if (!arr) return new Vector3();\r\n  return new Vector3(arr[0], arr[1], arr[2]);\r\n}\r\n\r\n/**\r\n * \u5C06\u6570\u7EC4\u8F6C\u6362\u4E3AQuaternion\r\n * @param arr \u6570\u7EC4[x, y, z, w]\r\n * @returns Quaternion\r\n */\r\nexport function arrayToQuaternion(arr?: [number, number, number, number]): Quaternion {\r\n  if (!arr) return new Quaternion();\r\n  return new Quaternion(arr[0], arr[1], arr[2], arr[3]);\r\n}\r\n\r\n/**\r\n * \u5C06\u6570\u7EC4\u8F6C\u6362\u4E3AEuler\r\n * @param arr \u6570\u7EC4[x, y, z]\r\n * @returns Euler\r\n */\r\nexport function arrayToEuler(arr?: Vector3Tuple): Euler {\r\n  if (!arr) return new Euler();\r\n  return new Euler(arr[0], arr[1], arr[2]);\r\n}\r\n\r\n/**\r\n * \u5C06\u989C\u8272\u503C\u8F6C\u6362\u4E3AColor\r\n * @param color \u989C\u8272\u503C\r\n * @returns Color\r\n */\r\nexport function toColor(color?: ColorValue): Color {\r\n  return new Color(color);\r\n}\r\n\r\n/**\r\n * \u8BA1\u7B97\u5BF9\u8C61\u7684\u5305\u56F4\u76D2\r\n * @param object \u5BF9\u8C61\r\n * @returns \u5305\u56F4\u76D2\r\n */\r\nexport function computeBoundingBox(object: Object3D): Box3 {\r\n  const box = new Box3().setFromObject(object);\r\n  return box;\r\n}\r\n\r\n/**\r\n * \u8BA1\u7B97\u5BF9\u8C61\u7684\u5305\u56F4\u7403\r\n * @param object \u5BF9\u8C61\r\n * @returns \u5305\u56F4\u7403\r\n */\r\nexport function computeBoundingSphere(object: Object3D): Sphere {\r\n  const box = computeBoundingBox(object);\r\n  const sphere = new Sphere();\r\n  box.getBoundingSphere(sphere);\r\n  return sphere;\r\n} ", "import { ref, inject, computed, readonly, onMounted, onBeforeUnmount, provide } from 'vue';\r\nimport * as THREE from 'three';\r\nimport { CANVAS_CONTEXT_KEY } from '../constants';\r\n\r\n/**\r\n * \u7236\u7EC4\u4EF6\u5411\u5B50\u7EC4\u4EF6\u63D0\u4F9BAPI\u7684\u94A9\u5B50\r\n * @param keys - \u7B26\u53F7\u952E\u5BF9\u8C61\r\n * @param api - \u63D0\u4F9B\u7ED9\u5B50\u7EC4\u4EF6\u7684API\u5BF9\u8C61\r\n */\r\nexport function useProvideThreeAPI(keys: { symbol: Symbol; context: Symbol }, api: any) {\r\n  // \u63D0\u4F9BAPI\u7ED9\u5B50\u7EC4\u4EF6\r\n  provide(keys.symbol, api);\r\n  return api;\r\n}\r\n\r\n/**\r\n * \u5B50\u7EC4\u4EF6\u6CE8\u5165\u7236\u7EC4\u4EF6\u63D0\u4F9B\u7684API\u7684\u94A9\u5B50\r\n * @param symbol - \u7B26\u53F7\r\n * @returns \u7236\u7EC4\u4EF6\u63D0\u4F9B\u7684API\r\n */\r\nexport function injectThreeParent(symbol: Symbol) {\r\n  return inject(symbol, null);\r\n}\r\n\r\n/**\r\n * \u4F7F\u7528\u7236\u7EC4\u4EF6\u7684\u94A9\u5B50\uFF0C\u4E3B\u8981\u7528\u4E8E\u51E0\u4F55\u4F53\u3001\u6750\u8D28\u7B49\u7EC4\u4EF6\r\n * @param keys - \u7B26\u53F7\u952E\u5BF9\u8C61\r\n * @returns \u7236\u7EC4\u4EF6API\u548C\u72B6\u6001\r\n */\r\nexport function useParent(keys: { symbol: Symbol; context: Symbol }) {\r\n  // \u6CE8\u5165\u7236\u7EC4\u4EF6API\r\n  const parentApi = inject(keys.symbol, null);\r\n  \r\n  return {\r\n    parentApi\r\n  };\r\n}\r\n\r\n/**\r\n * useThree \u7EC4\u5408\u5F0F\u51FD\u6570\r\n * \u63D0\u4F9B\u5BF9 three-core \u5F15\u64CE\u548C\u6E32\u67D3\u5668\u7684\u8BBF\u95EE\r\n */\r\nexport function useThree() {\r\n  // \u83B7\u53D6\u753B\u5E03\u4E0A\u4E0B\u6587\r\n  const context = inject(CANVAS_CONTEXT_KEY);\r\n\r\n  if (!context) {\r\n    console.error('useThree() \u5FC5\u987B\u5728 ThreeCanvas \u7EC4\u4EF6\u5185\u90E8\u4F7F\u7528');\r\n    \r\n    // \u8FD4\u56DE\u7A7A\u503C\uFF0C\u9632\u6B62\u8FD0\u884C\u65F6\u9519\u8BEF\r\n    return {\r\n      engine: ref(null),\r\n      renderer: ref(null),\r\n      scene: ref(null),\r\n      camera: ref(null),\r\n      gl: ref(null),\r\n      size: readonly(ref({ width: 0, height: 0 })),\r\n      viewport: readonly(ref({ width: 0, height: 0, factor: 1 })),\r\n      clock: readonly(ref(new THREE.Clock())),\r\n      pointer: readonly(ref({ x: 0, y: 0 })),\r\n      raycaster: readonly(ref(new THREE.Raycaster())),\r\n      ready: ref(false)\r\n    };\r\n  }\r\n\r\n  // \u5F15\u64CE\u5F15\u7528\r\n  const engine = context.engine;\r\n  \r\n  // \u6E32\u67D3\u5668\u5F15\u7528\r\n  const renderer = ref<any>(null);\r\n  \r\n  // \u573A\u666F\u5F15\u7528\r\n  const scene = ref<any>(null);\r\n  \r\n  // \u76F8\u673A\u5F15\u7528\r\n  const camera = ref<any>(null);\r\n  \r\n  // WebGL \u4E0A\u4E0B\u6587\r\n  const gl = ref<any>(null);\r\n  \r\n  // \u753B\u5E03\u5C3A\u5BF8\r\n  const size = ref({\r\n    width: 0,\r\n    height: 0,\r\n  });\r\n  \r\n  // \u89C6\u53E3\u5C3A\u5BF8\uFF08\u8003\u8651\u8BBE\u5907\u50CF\u7D20\u6BD4\uFF09\r\n  const viewport = computed(() => {\r\n    const factor = (renderer.value?.getPixelRatio?.() || 1);\r\n    return {\r\n      width: size.value.width,\r\n      height: size.value.height,\r\n      factor\r\n    };\r\n  });\r\n  \r\n  // \u65F6\u949F\u5BF9\u8C61\r\n  const clock = ref(new THREE.Clock());\r\n  \r\n  // \u9F20\u6807/\u89E6\u6478\u4F4D\u7F6E\uFF08\u5F52\u4E00\u5316\uFF09\r\n  const pointer = ref({\r\n    x: 0,\r\n    y: 0\r\n  });\r\n  \r\n  // \u5C04\u7EBF\u6295\u5C04\u5668\r\n  const raycaster = ref(new THREE.Raycaster());\r\n  \r\n  // \u662F\u5426\u5DF2\u51C6\u5907\u597D\r\n  const ready = ref(false);\r\n  \r\n  // \u66F4\u65B0\u6307\u9488\u4F4D\u7F6E\r\n  const updatePointer = (event: MouseEvent | TouchEvent) => {\r\n    if (!context.containerRef.value) return;\r\n    \r\n    const rect = context.containerRef.value.getBoundingClientRect();\r\n    let clientX, clientY;\r\n    \r\n    // \u5904\u7406\u89E6\u6478\u548C\u9F20\u6807\u4E8B\u4EF6\r\n    if ('touches' in event) {\r\n      clientX = event.touches[0].clientX;\r\n      clientY = event.touches[0].clientY;\r\n    } else {\r\n      clientX = event.clientX;\r\n      clientY = event.clientY;\r\n    }\r\n    \r\n    // \u5F52\u4E00\u5316\u5750\u6807 (-1 \u5230 +1)\r\n    pointer.value.x = ((clientX - rect.left) / rect.width) * 2 - 1;\r\n    pointer.value.y = -((clientY - rect.top) / rect.height) * 2 + 1;\r\n  };\r\n  \r\n  // \u521D\u59CB\u5316\u51FD\u6570\r\n  const initialize = async () => {\r\n    if (!engine.value) return;\r\n    \r\n    try {\r\n      // \u83B7\u53D6\u6E32\u67D3\u5668\r\n      renderer.value = await engine.value.getRenderer?.();\r\n      \r\n      // \u83B7\u53D6\u573A\u666F\r\n      scene.value = await engine.value.getScene?.();\r\n      \r\n      // \u83B7\u53D6\u76F8\u673A\r\n      camera.value = await engine.value.getCamera?.();\r\n      \r\n      // \u83B7\u53D6 WebGL \u4E0A\u4E0B\u6587\r\n      gl.value = renderer.value?.getContext?.();\r\n      \r\n      // \u83B7\u53D6\u5C3A\u5BF8\r\n      if (context.containerRef.value) {\r\n        const rect = context.containerRef.value.getBoundingClientRect();\r\n        size.value = {\r\n          width: rect.width,\r\n          height: rect.height\r\n        };\r\n      }\r\n      \r\n      // \u521D\u59CB\u5316\u65F6\u949F\r\n      clock.value.start();\r\n      \r\n      // \u6807\u8BB0\u4E3A\u5DF2\u51C6\u5907\u597D\r\n      ready.value = true;\r\n      \r\n      // \u6DFB\u52A0\u6307\u9488\u4E8B\u4EF6\u76D1\u542C\r\n      if (context.containerRef.value) {\r\n        context.containerRef.value.addEventListener('mousemove', updatePointer);\r\n        context.containerRef.value.addEventListener('touchmove', updatePointer);\r\n      }\r\n    } catch (error) {\r\n      console.error('\u521D\u59CB\u5316 three \u5BF9\u8C61\u5931\u8D25:', error);\r\n    }\r\n  };\r\n  \r\n  // \u6267\u884C\u5C04\u7EBF\u6295\u5C04\r\n  const raycast = (objects: THREE.Object3D[] = []) => {\r\n    if (!camera.value || !scene.value || !raycaster.value) return [];\r\n    \r\n    // \u66F4\u65B0\u5C04\u7EBF\u6295\u5C04\u5668\r\n    raycaster.value.setFromCamera(pointer.value, camera.value);\r\n    \r\n    // \u5982\u679C\u6CA1\u6709\u6307\u5B9A\u5BF9\u8C61\uFF0C\u4F7F\u7528\u573A\u666F\u4E2D\u7684\u6240\u6709\u53EF\u89C1\u5BF9\u8C61\r\n    const targetObjects = objects.length > 0 ? \r\n      objects : \r\n      scene.value.children.filter((obj: any) => obj.visible);\r\n    \r\n    // \u6267\u884C\u5C04\u7EBF\u6295\u5C04\r\n    return raycaster.value.intersectObjects(targetObjects, true);\r\n  };\r\n  \r\n  // \u751F\u547D\u5468\u671F\u94A9\u5B50\r\n  onMounted(() => {\r\n    if (engine.value) {\r\n      initialize();\r\n      \r\n      // \u76D1\u542C\u7A97\u53E3\u5927\u5C0F\u53D8\u5316\r\n      engine.value.on?.('resize', (newSize: { width: number, height: number }) => {\r\n        size.value = newSize;\r\n      });\r\n    }\r\n  });\r\n  \r\n  onBeforeUnmount(() => {\r\n    // \u79FB\u9664\u4E8B\u4EF6\u76D1\u542C\r\n    if (context.containerRef.value) {\r\n      context.containerRef.value.removeEventListener('mousemove', updatePointer);\r\n      context.containerRef.value.removeEventListener('touchmove', updatePointer);\r\n    }\r\n    \r\n    // \u505C\u6B62\u65F6\u949F\r\n    clock.value.stop();\r\n  });\r\n  \r\n  // \u8FD4\u56DE\u5BF9\u8C61\r\n  return {\r\n    // \u6838\u5FC3\u5BF9\u8C61\r\n    engine,\r\n    renderer: readonly(renderer),\r\n    scene: readonly(scene),\r\n    camera: readonly(camera),\r\n    gl: readonly(gl),\r\n    \r\n    // \u5C3A\u5BF8\u548C\u89C6\u53E3\r\n    size: readonly(size),\r\n    viewport: readonly(viewport),\r\n    \r\n    // \u5B9E\u7528\u5DE5\u5177\r\n    clock: readonly(clock),\r\n    pointer: readonly(pointer),\r\n    raycaster: readonly(raycaster),\r\n    \r\n    // \u72B6\u6001\r\n    ready: readonly(ready),\r\n    \r\n    // \u65B9\u6CD5\r\n    raycast\r\n  };\r\n} ", "import { InjectionKey, Ref } from 'vue';\nimport * as THREE from 'three';\n\n// \u6E32\u67D3\u4E0A\u4E0B\u6587\nexport const RENDER_CONTEXT_KEY = Symbol('three-render-context') as InjectionKey<{\n  renderer: Ref<THREE.WebGLRenderer | null>;\n  scene: Ref<THREE.Scene | null>;\n  camera: Ref<THREE.Camera | null>;\n  canvas: Ref<HTMLCanvasElement | null>;\n  size: Ref<{ width: number; height: number }>;\n  updateComplete: Ref<boolean>;\n}>;\n\n// \u76F8\u673A\u4E0A\u4E0B\u6587\nexport const CAMERA_CONTEXT_KEY = Symbol('three-camera-context') as InjectionKey<{\n  camera: Ref<THREE.Camera | null>;\n}>;\n\n// \u573A\u666F\u4E0A\u4E0B\u6587\nexport const SCENE_CONTEXT_KEY = Symbol('three-scene-context') as InjectionKey<{\n  scene: Ref<THREE.Scene | null>;\n}>;\n\n// \u573A\u666F\u7B26\u53F7\nexport const SCENE_SYMBOL = Symbol('three-scene-symbol');\n\n// \u573A\u666F\u4E0A\u4E0B\u6587\u952E\nexport const sceneKeys = {\n  context: SCENE_CONTEXT_KEY,\n  symbol: SCENE_SYMBOL,\n};\n\n// \u51E0\u4F55\u4F53\u4E0A\u4E0B\u6587\nexport const GEOMETRY_CONTEXT_KEY = Symbol('three-geometry-context') as InjectionKey<{\n  geometry: Ref<THREE.BufferGeometry | null>;\n}>;\n\n// \u51E0\u4F55\u4F53\u7B26\u53F7\nexport const GEOMETRY_SYMBOL = Symbol('three-geometry-symbol');\n\n// \u51E0\u4F55\u4F53\u4E0A\u4E0B\u6587\u952E\nexport const geometryKeys = {\n  context: GEOMETRY_CONTEXT_KEY,\n  symbol: GEOMETRY_SYMBOL,\n};\n\n// \u6750\u8D28\u4E0A\u4E0B\u6587\nexport const MATERIAL_CONTEXT_KEY = Symbol('three-material-context') as InjectionKey<{\n  material: Ref<THREE.Material | null>;\n}>;\n\n// \u6750\u8D28\u7B26\u53F7\nexport const MATERIAL_SYMBOL = Symbol('three-material-symbol');\n\n// \u6750\u8D28\u4E0A\u4E0B\u6587\u952E\nexport const materialKeys = {\n  context: MATERIAL_CONTEXT_KEY,\n  symbol: MATERIAL_SYMBOL,\n};\n\n// \u7F51\u683C\u4E0A\u4E0B\u6587\nexport const MESH_CONTEXT_KEY = Symbol('three-mesh-context') as InjectionKey<{\n  mesh: Ref<THREE.Mesh | null>;\n}>;\n\n// \u7F51\u683C\u7B26\u53F7\nexport const MESH_SYMBOL = Symbol('three-mesh-symbol');\n\n// \u7F51\u683C\u4E0A\u4E0B\u6587\u952E\nexport const meshKeys = {\n  context: MESH_CONTEXT_KEY,\n  symbol: MESH_SYMBOL,\n};\n\n// \u540E\u5904\u7406\u4E0A\u4E0B\u6587\nexport const POST_PROCESSING_CONTEXT_KEY = Symbol('three-post-processing-context') as InjectionKey<{\n  composer: Ref<any | null>;\n}>;\n\n// \u753B\u5E03\u4E0A\u4E0B\u6587\nexport const CANVAS_CONTEXT_KEY = Symbol('three-canvas-context') as InjectionKey<{\n  engine: Ref<any>;\n  containerRef: Ref<HTMLElement | null>;\n}>;\n\n// \u540E\u5904\u7406\u6548\u679C\u7C7B\u578B\nexport enum PostProcessingEffectType {\n  BLOOM = 'bloom',\n  DEPTH_OF_FIELD = 'depth-of-field',\n  FILM = 'film',\n  GLITCH = 'glitch',\n  ANTI_ALIAS = 'anti-alias',\n  OUTLINE = 'outline',\n  PIXELATION = 'pixelation',\n  NOISE = 'noise',\n  GOD_RAYS = 'god-rays',\n  COLOR_CORRECTION = 'color-correction',\n  CUSTOM = 'custom'\n}\n\n// \u51E0\u4F55\u4F53\u7C7B\u578B\nexport enum GeometryType {\n  BOX = 'box',\n  SPHERE = 'sphere',\n  CYLINDER = 'cylinder',\n  CONE = 'cone',\n  PLANE = 'plane',\n  CIRCLE = 'circle',\n  RING = 'ring',\n  TORUS = 'torus',\n  TORUS_KNOT = 'torus-knot',\n  TETRAHEDRON = 'tetrahedron',\n  OCTAHEDRON = 'octahedron',\n  DODECAHEDRON = 'dodecahedron',\n  ICOSAHEDRON = 'icosahedron',\n  TEXT = 'text',\n  EXTRUDE = 'extrude',\n  LATHE = 'lathe',\n  SHAPE = 'shape',\n  TUBE = 'tube',\n  CUSTOM = 'custom'\n}\n\n// \u6750\u8D28\u7C7B\u578B\nexport enum MaterialType {\n  BASIC = 'basic',\n  STANDARD = 'standard',\n  PHYSICAL = 'physical',\n  LAMBERT = 'lambert',\n  PHONG = 'phong',\n  TOON = 'toon',\n  NORMAL = 'normal',\n  DEPTH = 'depth',\n  LINE_BASIC = 'line-basic',\n  LINE_DASHED = 'line-dashed',\n  POINTS = 'points',\n  SHADER = 'shader',\n  SPRITE = 'sprite',\n  CUSTOM = 'custom'\n}\n\n/**\n * \u4E8B\u4EF6\u540D\u79F0\n */\nexport const OBJECT_EVENTS = {\n  CLICK: 'click',\n  DBL_CLICK: 'dblclick',\n  CONTEXT_MENU: 'contextmenu',\n  POINTER_DOWN: 'pointerdown',\n  POINTER_UP: 'pointerup',\n  POINTER_MOVE: 'pointermove',\n  POINTER_ENTER: 'pointerenter',\n  POINTER_LEAVE: 'pointerleave',\n  POINTER_OVER: 'pointerover',\n  POINTER_OUT: 'pointerout',\n  DRAG_START: 'dragstart',\n  DRAG: 'drag',\n  DRAG_END: 'dragend',\n  WHEEL: 'wheel'\n};\n\n/**\n * \u9ED8\u8BA4\u914D\u7F6E\n */\nexport const DEFAULT_CONFIG = {\n  ANTIALIAS: true,\n  AUTO_RESIZE: true,\n  AUTO_RENDER: true,\n  SHADOWS: true,\n  STATS: false,\n  BACKGROUND_COLOR: 0x000000,\n  ALPHA: false,\n  PHYSICALLY_CORRECT_LIGHTS: false,\n  OUTPUT_ENCODING: 'sRGB',\n  TONE_MAPPING: 'ACESFilmic',\n  TONE_MAPPING_EXPOSURE: 1,\n  SAMPLES: 0\n};\n\n/**\n * \u9ED8\u8BA4\u76F8\u673A\u914D\u7F6E\n */\nexport const DEFAULT_CAMERA = {\n  FOV: 75,\n  NEAR: 0.1,\n  FAR: 1000,\n  POSITION: [0, 0, 5],\n  LOOK_AT: [0, 0, 0]\n};\n\n/**\n * \u9ED8\u8BA4\u5149\u6E90\u914D\u7F6E\n */\nexport const DEFAULT_LIGHT = {\n  COLOR: 0xffffff,\n  INTENSITY: 1,\n  POSITION: [0, 1, 0],\n  CAST_SHADOW: false\n};\n\n/**\n * \u9ED8\u8BA4\u6750\u8D28\u914D\u7F6E\n */\nexport const DEFAULT_MATERIAL = {\n  COLOR: 0xcccccc,\n  ROUGHNESS: 0.5,\n  METALNESS: 0.5,\n  SIDE: 'front'\n};\n\n/**\n * \u9ED8\u8BA4\u51E0\u4F55\u4F53\u914D\u7F6E\n */\nexport const DEFAULT_GEOMETRY = {\n  BOX: {\n    WIDTH: 1,\n    HEIGHT: 1,\n    DEPTH: 1,\n    SEGMENTS: 1\n  },\n  SPHERE: {\n    RADIUS: 1,\n    WIDTH_SEGMENTS: 32,\n    HEIGHT_SEGMENTS: 16\n  },\n  PLANE: {\n    WIDTH: 1,\n    HEIGHT: 1,\n    WIDTH_SEGMENTS: 1,\n    HEIGHT_SEGMENTS: 1\n  }\n};\n\n/**\n * \u9ED8\u8BA4\u63A7\u5236\u5668\u914D\u7F6E\n */\nexport const DEFAULT_CONTROLS = {\n  ENABLE_ROTATE: true,\n  ENABLE_PAN: true,\n  ENABLE_ZOOM: true,\n  ENABLE_DAMPING: true,\n  DAMPING_FACTOR: 0.05,\n  MIN_DISTANCE: 0,\n  MAX_DISTANCE: Infinity\n};\n\n/**\n * \u9ED8\u8BA4\u540E\u5904\u7406\u914D\u7F6E\n */\nexport const DEFAULT_POST_PROCESSING = {\n  RENDER_SCALE: 1,\n  USE_PHYSICAL_EXPOSURE: false,\n  EXPOSURE: 1,\n  AUTO_CLEAR: true,\n  AUTO_CLEAR_DEPTH: true,\n  AUTO_UPDATE: true,\n  PRECISION: 'highp'\n};\n\n/**\n * \u540E\u5904\u7406\u6548\u679C\u7C7B\u578B\n */\nexport const EFFECT_TYPES = {\n  BLOOM: 'bloom',\n  DEPTH_OF_FIELD: 'depthOfField',\n  SSAO: 'ssao',\n  MOTION_BLUR: 'motionBlur',\n  OUTLINE: 'outline',\n  GLITCH: 'glitch',\n  NOISE: 'noise',\n  VIGNETTE: 'vignette',\n  TONE_MAPPING: 'toneMapping',\n  COLOR_CORRECTION: 'colorCorrection',\n  SSAA: 'ssaa',\n  FXAA: 'fxaa',\n  SMAA: 'smaa',\n  GOD_RAYS: 'godRays',\n  BOKEH: 'bokeh',\n  FILM: 'film',\n  HDR: 'hdr',\n  LUT: 'lut',\n  PIXELATE: 'pixelate',\n  CHROMATIC_ABERRATION: 'chromaticAberration',\n  SELECTIVE_BLOOM: 'selectiveBloom',\n  LENS_DISTORTION: 'lensDistortion'\n};\n\n/**\n * \u9ED8\u8BA4\u6548\u679C\u987A\u5E8F\uFF08\u4ECE\u5148\u5230\u540E\uFF09\n */\nexport const DEFAULT_EFFECTS_ORDER = [\n  EFFECT_TYPES.SSAO,\n  EFFECT_TYPES.MOTION_BLUR,\n  EFFECT_TYPES.DEPTH_OF_FIELD,\n  EFFECT_TYPES.BLOOM,\n  EFFECT_TYPES.GOD_RAYS,\n  EFFECT_TYPES.HDR,\n  EFFECT_TYPES.LUT,\n  EFFECT_TYPES.COLOR_CORRECTION,\n  EFFECT_TYPES.CHROMATIC_ABERRATION,\n  EFFECT_TYPES.LENS_DISTORTION,\n  EFFECT_TYPES.NOISE,\n  EFFECT_TYPES.FILM,\n  EFFECT_TYPES.GLITCH,\n  EFFECT_TYPES.PIXELATE,\n  EFFECT_TYPES.VIGNETTE,\n  EFFECT_TYPES.OUTLINE,\n  EFFECT_TYPES.TONE_MAPPING,\n  EFFECT_TYPES.FXAA,\n  EFFECT_TYPES.SMAA,\n  EFFECT_TYPES.SSAA\n]; ", "import { inject, onMounted, onBeforeUnmount, shallowRef } from 'vue';\r\nimport { CANVAS_CONTEXT_KEY } from '../constants';\r\nimport { useThree } from './useThree';\r\n\r\n/**\r\n * useFrame \u7EC4\u5408\u5F0F\u51FD\u6570\r\n * \u5141\u8BB8\u5728\u6BCF\u4E00\u5E27\u6E32\u67D3\u65F6\u6267\u884C\u56DE\u8C03\u51FD\u6570\r\n * \r\n * @param callback \u6BCF\u5E27\u6267\u884C\u7684\u56DE\u8C03\u51FD\u6570\r\n * @param renderPriority \u6E32\u67D3\u4F18\u5148\u7EA7\uFF08\u6570\u5B57\u8D8A\u5C0F\u4F18\u5148\u7EA7\u8D8A\u9AD8\uFF09\r\n */\r\nexport function useFrame(callback: (state: any, delta: number) => void, renderPriority = 0) {\r\n  // \u83B7\u53D6\u753B\u5E03\u4E0A\u4E0B\u6587\r\n  const context = inject(CANVAS_CONTEXT_KEY);\r\n  \r\n  if (!context) {\r\n    console.error('useFrame() \u5FC5\u987B\u5728 ThreeCanvas \u7EC4\u4EF6\u5185\u90E8\u4F7F\u7528');\r\n    return;\r\n  }\r\n  \r\n  // \u83B7\u53D6 three \u76F8\u5173\u5BF9\u8C61\r\n  const { clock, scene, camera } = useThree();\r\n  \r\n  // \u521B\u5EFA\u4E00\u4E2A\u6D45\u5F15\u7528\uFF0C\u907F\u514D\u4E0D\u5FC5\u8981\u7684\u66F4\u65B0\r\n  const fn = shallowRef(callback);\r\n  \r\n  // \u56DE\u8C03\u51FD\u6570 ID\r\n  let callbackId: number | null = null;\r\n  \r\n  // \u6CE8\u518C\u5E27\u56DE\u8C03\r\n  onMounted(() => {\r\n    if (!context.engine?.value) return;\r\n    \r\n    const engine = context.engine.value;\r\n    \r\n    // \u521B\u5EFA\u56DE\u8C03\u51FD\u6570\r\n    const frameCallback = (time: number) => {\r\n      if (!clock.value) return;\r\n      \r\n      // \u83B7\u53D6\u65F6\u95F4\u5DEE\r\n      const delta = clock.value.getDelta();\r\n      \r\n      // \u8C03\u7528\u7528\u6237\u56DE\u8C03\uFF0C\u4F20\u9012\u72B6\u6001\u5BF9\u8C61\u548C\u65F6\u95F4\u5DEE\r\n      fn.value({\r\n        clock: clock.value,\r\n        scene: scene.value,\r\n        camera: camera.value,\r\n        time\r\n      }, delta);\r\n    };\r\n    \r\n    // \u6CE8\u518C\u56DE\u8C03\r\n    if (engine.beforeRender) {\r\n      callbackId = engine.beforeRender.subscribe(frameCallback, renderPriority);\r\n    } else {\r\n      console.warn('\u5F15\u64CE\u4E0D\u652F\u6301 beforeRender \u4E8B\u4EF6\u8BA2\u9605');\r\n    }\r\n  });\r\n  \r\n  // \u53D6\u6D88\u6CE8\u518C\u5E27\u56DE\u8C03\r\n  onBeforeUnmount(() => {\r\n    if (!context.engine?.value || callbackId === null) return;\r\n    \r\n    const engine = context.engine.value;\r\n    \r\n    // \u53D6\u6D88\u6CE8\u518C\u56DE\u8C03\r\n    if (engine.beforeRender) {\r\n      engine.beforeRender.unsubscribe(callbackId);\r\n    }\r\n    \r\n    // \u6E05\u9664\u56DE\u8C03 ID\r\n    callbackId = null;\r\n  });\r\n  \r\n  // \u66F4\u65B0\u56DE\u8C03\u51FD\u6570\r\n  const setCallback = (newCallback: (state: any, delta: number) => void) => {\r\n    fn.value = newCallback;\r\n  };\r\n  \r\n  return setCallback;\r\n} ", "import { App } from 'vue';\r\n\r\n// \u6838\u5FC3\u7EC4\u4EF6\r\nimport ThreeCanvas from './components/core/ThreeCanvas.vue';\r\nimport ThreeScene from './components/core/ThreeScene.vue';\r\nimport ThreeCamera from './components/core/ThreeCamera.vue';\r\nimport ThreeMesh from './components/core/ThreeMesh.vue';\r\nimport ThreeObject from './components/core/ThreeObject.vue';\r\nimport ThreeResourceManager from './components/core/ThreeResourceManager.vue';\r\nimport ThreeWebGPURenderer from './components/core/ThreeWebGPURenderer.vue';\r\n\r\n// \u7269\u7406\u7EC4\u4EF6\r\nimport ThreePhysicsWorld from './components/physics/ThreePhysicsWorld.vue';\r\nimport ThreeRigidBody from './components/physics/ThreeRigidBody.vue';\r\nimport ThreeBoxCollider from './components/physics/ThreeBoxCollider.vue';\r\nimport ThreeSphereCollider from './components/physics/ThreeSphereCollider.vue';\r\nimport ThreeConstraint from './components/physics/ThreeConstraint.vue';\r\n\r\n// \u540E\u5904\u7406\u7EC4\u4EF6\r\nimport ThreePostProcessing from './components/postprocessing/ThreePostProcessing.vue';\r\nimport ThreeBloomEffect from './components/postprocessing/ThreeBloomEffect.vue';\r\nimport ThreeFXAAEffect from './components/postprocessing/ThreeFXAAEffect.vue';\r\nimport ThreeDepthOfFieldEffect from './components/postprocessing/ThreeDepthOfFieldEffect.vue';\r\n\r\n// \u8C03\u8BD5\u7EC4\u4EF6\r\nimport ThreeStats from './components/debug/ThreeStats.vue';\r\n\r\n// \u4EA4\u4E92\u7EC4\u4EF6\r\nimport ThreeRaycaster from './components/interaction/ThreeRaycaster.vue';\r\nimport ThreeInteractive from './components/interaction/ThreeInteractive.vue';\r\n\r\nexport default {\r\n  install(app: App) {\r\n    // \u6CE8\u518C\u6838\u5FC3\u7EC4\u4EF6\r\n    app.component('ThreeCanvas', ThreeCanvas);\r\n    app.component('ThreeScene', ThreeScene);\r\n    app.component('ThreeCamera', ThreeCamera);\r\n    app.component('ThreeMesh', ThreeMesh);\r\n    app.component('ThreeObject', ThreeObject);\r\n    app.component('ThreeResourceManager', ThreeResourceManager);\r\n    app.component('ThreeWebGPURenderer', ThreeWebGPURenderer);\r\n    \r\n    // \u6CE8\u518C\u7269\u7406\u7EC4\u4EF6\r\n    app.component('ThreePhysicsWorld', ThreePhysicsWorld);\r\n    app.component('ThreeRigidBody', ThreeRigidBody);\r\n    app.component('ThreeBoxCollider', ThreeBoxCollider);\r\n    app.component('ThreeSphereCollider', ThreeSphereCollider);\r\n    app.component('ThreeConstraint', ThreeConstraint);\r\n    \r\n    // \u6CE8\u518C\u540E\u5904\u7406\u7EC4\u4EF6\r\n    app.component('ThreePostProcessing', ThreePostProcessing);\r\n    app.component('ThreeBloomEffect', ThreeBloomEffect);\r\n    app.component('ThreeFXAAEffect', ThreeFXAAEffect);\r\n    app.component('ThreeDepthOfFieldEffect', ThreeDepthOfFieldEffect);\r\n    \r\n    // \u6CE8\u518C\u8C03\u8BD5\u7EC4\u4EF6\r\n    app.component('ThreeStats', ThreeStats);\r\n    \r\n    // \u6CE8\u518C\u4EA4\u4E92\u7EC4\u4EF6\r\n    app.component('ThreeRaycaster', ThreeRaycaster);\r\n    app.component('ThreeInteractive', ThreeInteractive);\r\n  }\r\n}; "],
  "mappings": "ikBAAA,IAAAA,GAAA,GAAAC,GAAAD,GAAA,gBAAAE,EAAA,sBAAAC,EAAA,iBAAAC,GAAA,sBAAAC,GAAA,mBAAAC,GAAA,UAAAC,GAAA,uBAAAC,EAAA,0BAAAC,GAAA,aAAAC,GAAA,qBAAAC,GAAA,oBAAAC,EAAA,kBAAAC,GAAA,iBAAAC,GAAA,8BAAAC,GAAA,6BAAAC,GAAA,aAAAC,GAAA,sBAAAC,GAAA,iCAAAC,GAAA,2BAAAC,GAAA,sBAAAC,GAAA,yBAAAC,GAAA,SAAAC,GAAA,qBAAAC,GAAA,aAAAC,GAAA,aAAAC,GAAA,YAAAC,GAAA,aAAAC,GAAA,cAAAC,GAAA,uBAAAC,GAAA,aAAAC,IAAA,eAAAC,GAAAhC,ICAA,IAAAiC,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;WCAA,IAAAC,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;YCAA,IAAAC,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;YCAA,IAAAC,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;YCAA,IAAAC,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;YCAA,IAAAC,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;WCAA,IAAAC,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;WCAA,IAAAC,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;WCAA,IAAAC,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;cCAA,IAAAC,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;cCAA,IAAAC,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;cCAA,IAAAC,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;cCAA,IAAAC,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;WCAA,IAAAC,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;YCAA,IAAAC,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;YCAA,IAAAC,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;cCAA,IAAAC,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;WCAA,IAAAC,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;WCAA,IAAAC,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;cCAA,IAAAC,EAYO,iBAOMC,GAAoB,SAA8B,CAC7D,GAAI,CAAC,UAAU,IACb,MAAO,GAGT,GAAI,CAEF,MADgB,QAAM,UAAU,IAAI,eAAe,CAKrD,OAASC,EAAO,CACd,eAAQ,MAAM,+BAAgCA,CAAK,EAC5C,EACT,CACF,EAMaC,GAAiBC,GAA2B,CAEvDA,EAAO,SAAUC,GAAU,CAEpBA,EAAc,UAChBA,EAAc,SAAS,QAAQ,EAI7BA,EAAc,UACjBC,EAAiBD,EAAc,QAAQ,CAE3C,CAAC,EAGGD,EAAO,QACTA,EAAO,OAAO,OAAOA,CAAM,CAE/B,EAMaE,EAAmBC,GAA0C,CACxE,GAAI,MAAM,QAAQA,CAAQ,EAAG,CAE3BA,EAAS,QAAQD,CAAe,EAChC,MACF,CAGA,OAAO,KAAKC,CAAQ,EAAE,QAASC,GAAQ,CACrC,IAAMC,EAASF,EAAiBC,CAAG,EAC/BC,GAASA,EAAM,WACjBA,EAAM,QAAQ,CAElB,CAAC,EAGDF,EAAS,QAAQ,CACnB,EAQaG,GAAW,CACtBC,EACAC,IACuC,CACvC,IAAIC,EAAuB,KAC3B,MAAO,IAAIC,IAAwB,CAC7BD,IAAU,MACZ,aAAaA,CAAK,EAEpBA,EAAQ,OAAO,WAAW,IAAM,CAC9BF,EAAG,GAAGG,CAAI,CACZ,EAAGF,CAAK,CACV,CACF,EAQaG,GAAW,CACtBJ,EACAK,IACuC,CACvC,IAAIC,EAAW,EACf,MAAO,IAAIH,IAAwB,CACjC,IAAMI,EAAM,KAAK,IAAI,EACjBA,EAAMD,GAAYD,IACpBC,EAAWC,EACXP,EAAG,GAAGG,CAAI,EAEd,CACF,EAKaK,EAAN,KAAoB,CACjB,KAAY,CAAC,EACb,SACA,QACA,QASR,YACEC,EACAC,EACAC,EAAc,EACdC,EAAU,IACV,CACA,KAAK,SAAWH,EAChB,KAAK,QAAUC,EACf,KAAK,QAAUE,EAGf,QAASC,EAAI,EAAGA,EAAIF,EAAaE,IAC/B,KAAK,KAAK,KAAK,KAAK,SAAS,CAAC,CAElC,CAMA,KAAS,CACP,OAAI,KAAK,KAAK,OAAS,EACd,KAAK,KAAK,IAAI,EAEhB,KAAK,SAAS,CACvB,CAMA,QAAQC,EAAc,CAChB,KAAK,KAAK,OAAS,KAAK,UAC1B,KAAK,QAAQA,CAAG,EAChB,KAAK,KAAK,KAAKA,CAAG,EAEtB,CAKA,OAAc,CACZ,KAAK,KAAO,CAAC,CACf,CAMA,MAAe,CACb,OAAO,KAAK,KAAK,MACnB,CACF,EAMaC,GAAe,IACnB,uCAAuC,QAAQ,QAAUC,GAAM,CACpE,IAAMC,EAAK,KAAK,OAAO,EAAI,GAAM,EAEjC,OADUD,IAAM,IAAMC,EAAKA,EAAI,EAAO,GAC7B,SAAS,EAAE,CACtB,CAAC,EAOUC,GAAuB,IAC3B,OAAO,OAAW,IAOdC,GAAyB,IAC7B,OAAO,aAAgB,UAC5B,OAAO,YAAY,SAAY,YAC/B,OAAO,YAAY,aAAgB,WAO1BC,GAA+B,IACnC,OAAO,kBAAsB,IAOzBC,GAA4B,IAAiC,CAExE,IAAMC,EAAc,UAAU,qBAAuB,EAG/CC,EAAU,UAAkB,cAAgB,EAElD,OAAID,GAAe,GAAKC,GAAU,EACzB,OACED,GAAe,GAAKC,GAAU,EAChC,SAEA,KAEX,EAOaC,GAA4BC,GAAgD,CACvF,OAAQA,EAAkB,CACxB,IAAK,OACH,MAAO,CACL,QAAS,GACT,cAAe,KACf,UAAW,GACX,wBAAyB,GACzB,UAAW,EACX,cAAe,IACf,YAAa,KACb,eAAgB,OAChB,eAAgB,EAClB,EACF,IAAK,SACH,MAAO,CACL,QAAS,GACT,cAAe,KACf,UAAW,GACX,wBAAyB,GACzB,UAAW,EACX,cAAe,IACf,YAAa,KACb,eAAgB,SAChB,eAAgB,EAClB,EACF,IAAK,MACL,QACE,MAAO,CACL,QAAS,GACT,cAAe,IACf,UAAW,GACX,wBAAyB,GACzB,UAAW,EACX,cAAe,IACf,YAAa,IACb,eAAgB,MAChB,eAAgB,EAClB,CACJ,CACF,EAOaC,GAAYC,GAA0C,CACjE,IAAMV,GAAMU,GAAO,GAAM,KAAO,IAC1BC,GAAMD,GAAO,EAAK,KAAO,IACzBE,GAAKF,EAAM,KAAO,IACxB,MAAO,CAACV,EAAGW,EAAGC,CAAC,CACjB,EAOaC,GAAYC,GAA0C,CACjE,IAAMd,EAAI,KAAK,MAAMc,EAAI,CAAC,EAAI,GAAG,EAC3BH,EAAI,KAAK,MAAMG,EAAI,CAAC,EAAI,GAAG,EAC3BF,EAAI,KAAK,MAAME,EAAI,CAAC,EAAI,GAAG,EACjC,OAAQd,GAAK,KAAOW,GAAK,GAAKC,CAChC,EASaG,GAAO,CAACC,EAAWJ,EAAWK,IAClCD,GAAKJ,EAAII,GAAKC,EAUVC,GAAQ,CAACrC,EAAesC,EAAaC,IACzC,KAAK,IAAID,EAAK,KAAK,IAAIC,EAAKvC,CAAK,CAAC,EAQ9BwC,GAAoBC,GACxBA,GAAW,IAAM,KAAK,IAQlBC,GAAoBC,GACxBA,GAAW,KAAK,GAAK,KAQvB,SAASC,GAAeC,EAAwC,CACrE,OAAKA,EACE,IAAI,UAAQA,EAAI,CAAC,EAAGA,EAAI,CAAC,EAAGA,EAAI,CAAC,CAAC,EADxB,IAAI,SAEvB,CAOO,SAASC,GAAkBD,EAAoD,CACpF,OAAKA,EACE,IAAI,aAAWA,EAAI,CAAC,EAAGA,EAAI,CAAC,EAAGA,EAAI,CAAC,EAAGA,EAAI,CAAC,CAAC,EADnC,IAAI,YAEvB,CAOO,SAASE,GAAaF,EAA2B,CACtD,OAAKA,EACE,IAAI,QAAMA,EAAI,CAAC,EAAGA,EAAI,CAAC,EAAGA,EAAI,CAAC,CAAC,EADtB,IAAI,OAEvB,CAOO,SAASG,GAAQC,EAA2B,CACjD,OAAO,IAAI,QAAMA,CAAK,CACxB,CAOO,SAASC,EAAmBvD,EAAwB,CAEzD,OADY,IAAI,OAAK,EAAE,cAAcA,CAAM,CAE7C,CAOO,SAASwD,GAAsBxD,EAA0B,CAC9D,IAAMyD,EAAMF,EAAmBvD,CAAM,EAC/B0D,EAAS,IAAI,SACnB,OAAAD,EAAI,kBAAkBC,CAAM,EACrBA,CACT,CCtaA,IAAAC,EAAqF,eACrFC,EAAuB,uBCGhB,IAAMC,GAAqB,OAAO,sBAAsB,EAUlDC,GAAqB,OAAO,sBAAsB,EAKlDC,GAAoB,OAAO,qBAAqB,EAKhDC,GAAe,OAAO,oBAAoB,EAShD,IAAMC,GAAuB,OAAO,wBAAwB,EAKtDC,GAAkB,OAAO,uBAAuB,EAStD,IAAMC,GAAuB,OAAO,wBAAwB,EAKtDC,GAAkB,OAAO,uBAAuB,EAStD,IAAMC,GAAmB,OAAO,oBAAoB,EAK9CC,GAAc,OAAO,mBAAmB,EAS9C,IAAMC,GAA8B,OAAO,+BAA+B,EAKpEC,EAAqB,OAAO,sBAAsB,EAsLxD,IAAMC,EAAe,CAC1B,MAAO,QACP,eAAgB,eAChB,KAAM,OACN,YAAa,aACb,QAAS,UACT,OAAQ,SACR,MAAO,QACP,SAAU,WACV,aAAc,cACd,iBAAkB,kBAClB,KAAM,OACN,KAAM,OACN,KAAM,OACN,SAAU,UACV,MAAO,QACP,KAAM,OACN,IAAK,MACL,IAAK,MACL,SAAU,WACV,qBAAsB,sBACtB,gBAAiB,iBACjB,gBAAiB,gBACnB,EAKaC,GAAwB,CACnCD,EAAa,KACbA,EAAa,YACbA,EAAa,eACbA,EAAa,MACbA,EAAa,SACbA,EAAa,IACbA,EAAa,IACbA,EAAa,iBACbA,EAAa,qBACbA,EAAa,gBACbA,EAAa,MACbA,EAAa,KACbA,EAAa,OACbA,EAAa,SACbA,EAAa,SACbA,EAAa,QACbA,EAAa,aACbA,EAAa,KACbA,EAAa,KACbA,EAAa,IACf,ED9SO,SAASE,GAAmBC,EAA2CC,EAAU,CAEtF,oBAAQD,EAAK,OAAQC,CAAG,EACjBA,CACT,CAOO,SAASC,GAAkBC,EAAgB,CAChD,SAAO,UAAOA,EAAQ,IAAI,CAC5B,CAOO,SAASC,GAAUJ,EAA2C,CAInE,MAAO,CACL,aAHgB,UAAOA,EAAK,OAAQ,IAAI,CAI1C,CACF,CAMO,SAASK,GAAW,CAEzB,IAAMC,KAAU,UAAOC,CAAkB,EAEzC,GAAI,CAACD,EACH,eAAQ,MAAM,gFAAmC,EAG1C,CACL,UAAQ,OAAI,IAAI,EAChB,YAAU,OAAI,IAAI,EAClB,SAAO,OAAI,IAAI,EACf,UAAQ,OAAI,IAAI,EAChB,MAAI,OAAI,IAAI,EACZ,QAAM,eAAS,OAAI,CAAE,MAAO,EAAG,OAAQ,CAAE,CAAC,CAAC,EAC3C,YAAU,eAAS,OAAI,CAAE,MAAO,EAAG,OAAQ,EAAG,OAAQ,CAAE,CAAC,CAAC,EAC1D,SAAO,eAAS,OAAI,IAAU,OAAO,CAAC,EACtC,WAAS,eAAS,OAAI,CAAE,EAAG,EAAG,EAAG,CAAE,CAAC,CAAC,EACrC,aAAW,eAAS,OAAI,IAAU,WAAW,CAAC,EAC9C,SAAO,OAAI,EAAK,CAClB,EAIF,IAAME,EAASF,EAAQ,OAGjBG,KAAW,OAAS,IAAI,EAGxBC,KAAQ,OAAS,IAAI,EAGrBC,KAAS,OAAS,IAAI,EAGtBC,KAAK,OAAS,IAAI,EAGlBC,KAAO,OAAI,CACf,MAAO,EACP,OAAQ,CACV,CAAC,EAGKC,KAAW,YAAS,IAAM,CAC9B,IAAMC,EAAUN,EAAS,OAAO,gBAAgB,GAAK,EACrD,MAAO,CACL,MAAOI,EAAK,MAAM,MAClB,OAAQA,EAAK,MAAM,OACnB,OAAAE,CACF,CACF,CAAC,EAGKC,KAAQ,OAAI,IAAU,OAAO,EAG7BC,KAAU,OAAI,CAClB,EAAG,EACH,EAAG,CACL,CAAC,EAGKC,KAAY,OAAI,IAAU,WAAW,EAGrCC,KAAQ,OAAI,EAAK,EAGjBC,EAAiBC,GAAmC,CACxD,GAAI,CAACf,EAAQ,aAAa,MAAO,OAEjC,IAAMgB,EAAOhB,EAAQ,aAAa,MAAM,sBAAsB,EAC1DiB,EAASC,EAGT,YAAaH,GACfE,EAAUF,EAAM,QAAQ,CAAC,EAAE,QAC3BG,EAAUH,EAAM,QAAQ,CAAC,EAAE,UAE3BE,EAAUF,EAAM,QAChBG,EAAUH,EAAM,SAIlBJ,EAAQ,MAAM,GAAMM,EAAUD,EAAK,MAAQA,EAAK,MAAS,EAAI,EAC7DL,EAAQ,MAAM,EAAI,GAAGO,EAAUF,EAAK,KAAOA,EAAK,QAAU,EAAI,CAChE,EAGMG,EAAa,SAAY,CAC7B,GAAKjB,EAAO,MAEZ,GAAI,CAcF,GAZAC,EAAS,MAAQ,MAAMD,EAAO,MAAM,cAAc,EAGlDE,EAAM,MAAQ,MAAMF,EAAO,MAAM,WAAW,EAG5CG,EAAO,MAAQ,MAAMH,EAAO,MAAM,YAAY,EAG9CI,EAAG,MAAQH,EAAS,OAAO,aAAa,EAGpCH,EAAQ,aAAa,MAAO,CAC9B,IAAMgB,EAAOhB,EAAQ,aAAa,MAAM,sBAAsB,EAC9DO,EAAK,MAAQ,CACX,MAAOS,EAAK,MACZ,OAAQA,EAAK,MACf,CACF,CAGAN,EAAM,MAAM,MAAM,EAGlBG,EAAM,MAAQ,GAGVb,EAAQ,aAAa,QACvBA,EAAQ,aAAa,MAAM,iBAAiB,YAAac,CAAa,EACtEd,EAAQ,aAAa,MAAM,iBAAiB,YAAac,CAAa,EAE1E,OAASM,EAAO,CACd,QAAQ,MAAM,qDAAmBA,CAAK,CACxC,CACF,EAGMC,EAAU,CAACC,EAA4B,CAAC,IAAM,CAClD,GAAI,CAACjB,EAAO,OAAS,CAACD,EAAM,OAAS,CAACQ,EAAU,MAAO,MAAO,CAAC,EAG/DA,EAAU,MAAM,cAAcD,EAAQ,MAAON,EAAO,KAAK,EAGzD,IAAMkB,EAAgBD,EAAQ,OAAS,EACrCA,EACAlB,EAAM,MAAM,SAAS,OAAQoB,GAAaA,EAAI,OAAO,EAGvD,OAAOZ,EAAU,MAAM,iBAAiBW,EAAe,EAAI,CAC7D,EAGA,sBAAU,IAAM,CACVrB,EAAO,QACTiB,EAAW,EAGXjB,EAAO,MAAM,KAAK,SAAWuB,GAA+C,CAC1ElB,EAAK,MAAQkB,CACf,CAAC,EAEL,CAAC,KAED,mBAAgB,IAAM,CAEhBzB,EAAQ,aAAa,QACvBA,EAAQ,aAAa,MAAM,oBAAoB,YAAac,CAAa,EACzEd,EAAQ,aAAa,MAAM,oBAAoB,YAAac,CAAa,GAI3EJ,EAAM,MAAM,KAAK,CACnB,CAAC,EAGM,CAEL,OAAAR,EACA,YAAU,YAASC,CAAQ,EAC3B,SAAO,YAASC,CAAK,EACrB,UAAQ,YAASC,CAAM,EACvB,MAAI,YAASC,CAAE,EAGf,QAAM,YAASC,CAAI,EACnB,YAAU,YAASC,CAAQ,EAG3B,SAAO,YAASE,CAAK,EACrB,WAAS,YAASC,CAAO,EACzB,aAAW,YAASC,CAAS,EAG7B,SAAO,YAASC,CAAK,EAGrB,QAAAQ,CACF,CACF,CE7OA,IAAAK,EAA+D,eAWxD,SAASC,GAASC,EAA+CC,EAAiB,EAAG,CAE1F,IAAMC,KAAU,UAAOC,CAAkB,EAEzC,GAAI,CAACD,EAAS,CACZ,QAAQ,MAAM,gFAAmC,EACjD,MACF,CAGA,GAAM,CAAE,MAAAE,EAAO,MAAAC,EAAO,OAAAC,CAAO,EAAIC,EAAS,EAGpCC,KAAK,cAAWR,CAAQ,EAG1BS,EAA4B,KAGhC,sBAAU,IAAM,CACd,GAAI,CAACP,EAAQ,QAAQ,MAAO,OAE5B,IAAMQ,EAASR,EAAQ,OAAO,MAGxBS,EAAiBC,GAAiB,CACtC,GAAI,CAACR,EAAM,MAAO,OAGlB,IAAMS,EAAQT,EAAM,MAAM,SAAS,EAGnCI,EAAG,MAAM,CACP,MAAOJ,EAAM,MACb,MAAOC,EAAM,MACb,OAAQC,EAAO,MACf,KAAAM,CACF,EAAGC,CAAK,CACV,EAGIH,EAAO,aACTD,EAAaC,EAAO,aAAa,UAAUC,EAAeV,CAAc,EAExE,QAAQ,KAAK,sEAAyB,CAE1C,CAAC,KAGD,mBAAgB,IAAM,CACpB,GAAI,CAACC,EAAQ,QAAQ,OAASO,IAAe,KAAM,OAEnD,IAAMC,EAASR,EAAQ,OAAO,MAG1BQ,EAAO,cACTA,EAAO,aAAa,YAAYD,CAAU,EAI5CA,EAAa,IACf,CAAC,EAGoBK,GAAqD,CACxEN,EAAG,MAAQM,CACb,CAGF,CCjDA,IAAOC,EAAQ,CACb,QAAQC,EAAU,CAEhBA,EAAI,UAAU,cAAeC,CAAW,EACxCD,EAAI,UAAU,aAAcE,CAAU,EACtCF,EAAI,UAAU,cAAeG,CAAW,EACxCH,EAAI,UAAU,YAAaI,CAAS,EACpCJ,EAAI,UAAU,cAAeK,CAAW,EACxCL,EAAI,UAAU,uBAAwBM,CAAoB,EAC1DN,EAAI,UAAU,sBAAuBO,CAAmB,EAGxDP,EAAI,UAAU,oBAAqBQ,CAAiB,EACpDR,EAAI,UAAU,iBAAkBS,CAAc,EAC9CT,EAAI,UAAU,mBAAoBU,CAAgB,EAClDV,EAAI,UAAU,sBAAuBW,CAAmB,EACxDX,EAAI,UAAU,kBAAmBY,CAAe,EAGhDZ,EAAI,UAAU,sBAAuBa,CAAmB,EACxDb,EAAI,UAAU,mBAAoBc,CAAgB,EAClDd,EAAI,UAAU,kBAAmBe,CAAe,EAChDf,EAAI,UAAU,0BAA2BgB,CAAuB,EAGhEhB,EAAI,UAAU,aAAciB,CAAU,EAGtCjB,EAAI,UAAU,iBAAkBkB,CAAc,EAC9ClB,EAAI,UAAU,mBAAoBmB,CAAgB,CACpD,CACF",
  "names": ["index_exports", "__export", "ObjectPool", "plugin_default", "arrayToEuler", "arrayToQuaternion", "arrayToVector3", "clamp", "computeBoundingBox", "computeBoundingSphere", "debounce", "degreesToRadians", "disposeMaterial", "disposeObject", "generateUUID", "getDevicePerformanceLevel", "getRenderQualitySettings", "hexToRgb", "injectThreeParent", "isSharedArrayBufferSupported", "isWebAssemblySupported", "isWebGPUSupported", "isWebWorkerSupported", "lerp", "radiansToDegrees", "rgbToHex", "throttle", "toColor", "useFrame", "useParent", "useProvideThreeAPI", "useThree", "__toCommonJS", "ThreeCanvas_default", "ThreeScene_default", "ThreeCamera_default", "ThreeMesh_default", "ThreeObject_default", "ThreeResourceManager_default", "ThreeWebGPURenderer_default", "ThreePhysicsWorld_default", "ThreeRigidBody_default", "ThreeBoxCollider_default", "ThreeSphereCollider_default", "ThreeConstraint_default", "ThreePostProcessing_default", "ThreeBloomEffect_default", "ThreeFXAAEffect_default", "ThreeDepthOfFieldEffect_default", "ThreeStats_default", "ThreeRaycaster_default", "ThreeInteractive_default", "import_three", "isWebGPUSupported", "error", "disposeObject", "object", "child", "disposeMaterial", "material", "key", "value", "debounce", "fn", "delay", "timer", "args", "throttle", "limit", "lastCall", "now", "ObjectPool", "createFn", "resetFn", "initialSize", "maxSize", "i", "obj", "generateUUID", "c", "r", "isWebWorkerSupported", "isWebAssemblySupported", "isSharedArrayBufferSupported", "getDevicePerformanceLevel", "concurrency", "memory", "getRenderQualitySettings", "performanceLevel", "hexToRgb", "hex", "g", "b", "rgbToHex", "rgb", "lerp", "a", "t", "clamp", "min", "max", "radiansToDegrees", "radians", "degreesToRadians", "degrees", "arrayToVector3", "arr", "arrayToQuaternion", "arrayToEuler", "toColor", "color", "computeBoundingBox", "computeBoundingSphere", "box", "sphere", "import_vue", "THREE", "RENDER_CONTEXT_KEY", "CAMERA_CONTEXT_KEY", "SCENE_CONTEXT_KEY", "SCENE_SYMBOL", "GEOMETRY_CONTEXT_KEY", "GEOMETRY_SYMBOL", "MATERIAL_CONTEXT_KEY", "MATERIAL_SYMBOL", "MESH_CONTEXT_KEY", "MESH_SYMBOL", "POST_PROCESSING_CONTEXT_KEY", "CANVAS_CONTEXT_KEY", "EFFECT_TYPES", "DEFAULT_EFFECTS_ORDER", "useProvideThreeAPI", "keys", "api", "injectThreeParent", "symbol", "useParent", "useThree", "context", "CANVAS_CONTEXT_KEY", "engine", "renderer", "scene", "camera", "gl", "size", "viewport", "factor", "clock", "pointer", "raycaster", "ready", "updatePointer", "event", "rect", "clientX", "clientY", "initialize", "error", "raycast", "objects", "targetObjects", "obj", "newSize", "import_vue", "useFrame", "callback", "renderPriority", "context", "CANVAS_CONTEXT_KEY", "clock", "scene", "camera", "useThree", "fn", "callbackId", "engine", "frameCallback", "time", "delta", "newCallback", "plugin_default", "app", "ThreeCanvas_default", "ThreeScene_default", "ThreeCamera_default", "ThreeMesh_default", "ThreeObject_default", "ThreeResourceManager_default", "ThreeWebGPURenderer_default", "ThreePhysicsWorld_default", "ThreeRigidBody_default", "ThreeBoxCollider_default", "ThreeSphereCollider_default", "ThreeConstraint_default", "ThreePostProcessing_default", "ThreeBloomEffect_default", "ThreeFXAAEffect_default", "ThreeDepthOfFieldEffect_default", "ThreeStats_default", "ThreeRaycaster_default", "ThreeInteractive_default"]
}
